---
title: Ladealgorithmus für verwaltete Assemblys – .NET Core
description: Beschreibung von Details des Ladealgorithmus für verwaltete Assemblys in .NET Core
ms.date: 08/09/2019
author: sdmaclea
ms.author: stmaclea
ms.openlocfilehash: bf95cbd0eebed064f0198ae9b0f7a4288a938f8a
ms.sourcegitcommit: 6f28b709592503d27077b16fff2e2eacca569992
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 08/28/2019
ms.locfileid: "72303629"
---
# <a name="managed-assembly-loading-algorithm"></a><span data-ttu-id="6d16b-103">Ladealgorithmus für verwaltete Assemblys</span><span class="sxs-lookup"><span data-stu-id="6d16b-103">Managed assembly loading algorithm</span></span>

<span data-ttu-id="6d16b-104">Verwaltete Assemblys werden in mehreren Schritten über einen Algorithmus gesucht und geladen.</span><span class="sxs-lookup"><span data-stu-id="6d16b-104">Managed assemblies are located and loaded with an algorithm involving various stages.</span></span>

<span data-ttu-id="6d16b-105">Für alle verwalteten Assemblys – mit Ausnahme von Satellitenassemblys und `WinRT`-Assemblys – wird derselbe Algorithmus verwendet.</span><span class="sxs-lookup"><span data-stu-id="6d16b-105">All managed assemblies except satellite assemblies and `WinRT` assemblies use the same algorithm.</span></span>

## <a name="when-are-managed-assemblies-loaded"></a><span data-ttu-id="6d16b-106">Wann werden verwaltete Assemblys geladen?</span><span class="sxs-lookup"><span data-stu-id="6d16b-106">When are managed assemblies loaded?</span></span>

<span data-ttu-id="6d16b-107">Das am häufigsten angewandte Verfahren, um das Laden einer verwalteten Assembly auszulösen, ist ein statischer Assemblyverweis.</span><span class="sxs-lookup"><span data-stu-id="6d16b-107">The most common mechanism to trigger a managed assembly load is a static assembly reference.</span></span> <span data-ttu-id="6d16b-108">Diese Verweise werden vom Compiler immer dann eingefügt, wenn der Code einen in einer anderen Assembly definierten Typ verwendet.</span><span class="sxs-lookup"><span data-stu-id="6d16b-108">These references are inserted by the compiler whenever code uses a type defined in another assembly.</span></span> <span data-ttu-id="6d16b-109">Diese Assemblys werden nach Bedarf von der Runtime geladen (`load-by-name`).</span><span class="sxs-lookup"><span data-stu-id="6d16b-109">These assemblies are loaded (`load-by-name`) as needed by the runtime.</span></span>

<span data-ttu-id="6d16b-110">Die direkte Verwendung spezifischer APIs löst das Laden ebenfalls aus:</span><span class="sxs-lookup"><span data-stu-id="6d16b-110">The direct use of specific APIs will also trigger loads:</span></span>

|<span data-ttu-id="6d16b-111">API</span><span class="sxs-lookup"><span data-stu-id="6d16b-111">API</span></span>  |<span data-ttu-id="6d16b-112">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="6d16b-112">Description</span></span>  |<span data-ttu-id="6d16b-113">`Active` <xref:System.Runtime.Loader.AssemblyLoadContext></span><span class="sxs-lookup"><span data-stu-id="6d16b-113">`Active` <xref:System.Runtime.Loader.AssemblyLoadContext></span></span> |
|---------|---------|---------|
|<xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromAssemblyName%2A?displayProperty=nameWithType>|`Load-by-name`|<span data-ttu-id="6d16b-114">Die [this](../../csharp/language-reference/keywords/this.md)-Instanz.</span><span class="sxs-lookup"><span data-stu-id="6d16b-114">The [this](../../csharp/language-reference/keywords/this.md) instance.</span></span>|
|<xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromAssemblyPath%2A?displayProperty=nameWithType><p><xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromNativeImagePath%2A?displayProperty=nameWithType>|<span data-ttu-id="6d16b-115">Aus dem Pfad laden</span><span class="sxs-lookup"><span data-stu-id="6d16b-115">Load from path.</span></span>|<span data-ttu-id="6d16b-116">Die [this](../../csharp/language-reference/keywords/this.md)-Instanz.</span><span class="sxs-lookup"><span data-stu-id="6d16b-116">The [this](../../csharp/language-reference/keywords/this.md) instance.</span></span>|
<xref:System.Runtime.Loader.AssemblyLoadContext.LoadFromStream%2A?displayProperty=nameWithType>|<span data-ttu-id="6d16b-117">Aus einem Objekt laden</span><span class="sxs-lookup"><span data-stu-id="6d16b-117">Load from object.</span></span>|<span data-ttu-id="6d16b-118">Die [this](../../csharp/language-reference/keywords/this.md)-Instanz.</span><span class="sxs-lookup"><span data-stu-id="6d16b-118">The [this](../../csharp/language-reference/keywords/this.md) instance.</span></span>|
|<xref:System.Reflection.Assembly.LoadFile%2A?displayProperty=nameWithType>|<span data-ttu-id="6d16b-119">Aus dem Pfad in eine neue <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanz laden</span><span class="sxs-lookup"><span data-stu-id="6d16b-119">Load from path in a new <xref:System.Runtime.Loader.AssemblyLoadContext> instance</span></span>|<span data-ttu-id="6d16b-120">Die neue <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanz.</span><span class="sxs-lookup"><span data-stu-id="6d16b-120">The new <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>|
<xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType>|<span data-ttu-id="6d16b-121">Aus dem Pfad in die <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>-Instanz laden</span><span class="sxs-lookup"><span data-stu-id="6d16b-121">Load from path in the <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> instance.</span></span><p><span data-ttu-id="6d16b-122">Fügt <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> einen <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving>-Handler hinzu.</span><span class="sxs-lookup"><span data-stu-id="6d16b-122">Adds a <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving> handler to <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="6d16b-123">Der Handler lädt die Abhängigkeiten der Assembly aus dem zugehörigen Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="6d16b-123">The handler will load the assembly's dependencies from its directory.</span></span>|<span data-ttu-id="6d16b-124">Die <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>-Instanz.</span><span class="sxs-lookup"><span data-stu-id="6d16b-124">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> instance.</span></span>|
|<xref:System.Reflection.Assembly.Load(System.Reflection.AssemblyName)?displayProperty=nameWithType><p><xref:System.Reflection.Assembly.Load(System.String)?displayProperty=nameWithType><p><xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=nameWithType>|<span data-ttu-id="6d16b-125">`Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="6d16b-125">`Load-by-name`.</span></span>|<span data-ttu-id="6d16b-126">Vom Aufrufer abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="6d16b-126">Inferred from caller.</span></span><p><span data-ttu-id="6d16b-127">Verwenden Sie bevorzugt <xref:System.Runtime.Loader.AssemblyLoadContext>-Methoden.</span><span class="sxs-lookup"><span data-stu-id="6d16b-127">Prefer <xref:System.Runtime.Loader.AssemblyLoadContext> methods.</span></span>|
|<xref:System.Reflection.Assembly.Load(System.Byte[])?displayProperty=nameWithType><p><xref:System.Reflection.Assembly.Load(System.Byte[],System.Byte[])?displayProperty=nameWithType>|<span data-ttu-id="6d16b-128">Aus einem Objekt laden</span><span class="sxs-lookup"><span data-stu-id="6d16b-128">Load from object.</span></span>|<span data-ttu-id="6d16b-129">Vom Aufrufer abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="6d16b-129">Inferred from caller.</span></span><p><span data-ttu-id="6d16b-130">Verwenden Sie bevorzugt <xref:System.Runtime.Loader.AssemblyLoadContext>-Methoden.</span><span class="sxs-lookup"><span data-stu-id="6d16b-130">Prefer <xref:System.Runtime.Loader.AssemblyLoadContext> methods.</span></span>|
<xref:System.Type.GetType(System.String)?displayProperty=nameWithType><p><xref:System.Type.GetType(System.String,System.Boolean)?displayProperty=nameWithType><p><xref:System.Type.GetType(System.String,System.Boolean,System.Boolean)?displayProperty=nameWithType>|<span data-ttu-id="6d16b-131">`Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="6d16b-131">`Load-by-name`.</span></span>|<span data-ttu-id="6d16b-132">Vom Aufrufer abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="6d16b-132">Inferred from caller.</span></span><p><span data-ttu-id="6d16b-133">Verwenden Sie bevorzugt <xref:System.Type.GetType%2A?displayProperty=nameWithType>-Methoden mit einem `assemblyResolver`-Argument.</span><span class="sxs-lookup"><span data-stu-id="6d16b-133">Prefer <xref:System.Type.GetType%2A?displayProperty=nameWithType> methods with an `assemblyResolver` argument.</span></span>|
<xref:System.Reflection.Assembly.GetType%2A?displayProperty=nameWithType>|<span data-ttu-id="6d16b-134">Wenn der Typ-`name` einen von der Assembly qualifizierten generischen Typ beschreibt, wird `Load-by-name` auslöst.</span><span class="sxs-lookup"><span data-stu-id="6d16b-134">If type `name` describes an assembly qualified generic type, trigger a `Load-by-name`.</span></span>|<span data-ttu-id="6d16b-135">Vom Aufrufer abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="6d16b-135">Inferred from caller.</span></span><p><span data-ttu-id="6d16b-136">Bevorzugen Sie <xref:System.Type.GetType%2A?displayProperty=nameWithType>, wenn Sie von der Assembly qualifizierte Typnamen verwenden.</span><span class="sxs-lookup"><span data-stu-id="6d16b-136">Prefer <xref:System.Type.GetType%2A?displayProperty=nameWithType> when using assembly qualified type names.</span></span>|
<xref:System.Activator.CreateInstance(System.String,System.String)?displayProperty=nameWithType><p><xref:System.Activator.CreateInstance(System.String,System.String,System.Object[])?displayProperty=nameWithType><p><xref:System.Activator.CreateInstance(System.String,System.String,System.Boolean,System.Reflection.BindingFlags,System.Reflection.Binder,System.Object[],System.Globalization.CultureInfo,System.Object[])?displayProperty=nameWithType>|<span data-ttu-id="6d16b-137">`Load-by-name`.</span><span class="sxs-lookup"><span data-stu-id="6d16b-137">`Load-by-name`.</span></span>|<span data-ttu-id="6d16b-138">Vom Aufrufer abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="6d16b-138">Inferred from caller.</span></span><p><span data-ttu-id="6d16b-139">Verwenden Sie bevorzugt <xref:System.Activator.CreateInstance%2A?displayProperty=nameWithType>-Methoden, die ein <xref:System.Type>-Argument übernehmen.</span><span class="sxs-lookup"><span data-stu-id="6d16b-139">Prefer <xref:System.Activator.CreateInstance%2A?displayProperty=nameWithType> methods taking a <xref:System.Type> argument.</span></span>|

## <a name="algorithm"></a><span data-ttu-id="6d16b-140">Algorithmus</span><span class="sxs-lookup"><span data-stu-id="6d16b-140">Algorithm</span></span>

<span data-ttu-id="6d16b-141">Der folgende Algorithmus beschreibt, wie die Runtime eine verwaltete Assembly lädt.</span><span class="sxs-lookup"><span data-stu-id="6d16b-141">The following algorithm describes how the runtime loads a managed assembly.</span></span>

1. <span data-ttu-id="6d16b-142">Ermitteln Sie den `active` <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="6d16b-142">Determine the `active` <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>

    - <span data-ttu-id="6d16b-143">Bei einem statischen Assemblyverweis ist der `active` <xref:System.Runtime.Loader.AssemblyLoadContext> die Instanz, die die verweisende Assembly geladen hat.</span><span class="sxs-lookup"><span data-stu-id="6d16b-143">For a static assembly reference, the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> is the instance that loaded the referring assembly.</span></span>
    - <span data-ttu-id="6d16b-144">Bei bevorzugten APIs wird der `active` <xref:System.Runtime.Loader.AssemblyLoadContext> explizit angegeben.</span><span class="sxs-lookup"><span data-stu-id="6d16b-144">Preferred APIs make the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> explicit.</span></span>
    - <span data-ttu-id="6d16b-145">Andere APIs leiten den `active` <xref:System.Runtime.Loader.AssemblyLoadContext> ab.</span><span class="sxs-lookup"><span data-stu-id="6d16b-145">Other APIs infer the `active` <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span> <span data-ttu-id="6d16b-146">Für diese APIs wird die <xref:System.Runtime.Loader.AssemblyLoadContext.CurrentContextualReflectionContext?displayProperty=nameWithType>-Eigenschaft verwendet.</span><span class="sxs-lookup"><span data-stu-id="6d16b-146">For these APIs, the <xref:System.Runtime.Loader.AssemblyLoadContext.CurrentContextualReflectionContext?displayProperty=nameWithType> property is used.</span></span> <span data-ttu-id="6d16b-147">Wenn der Wert `null` ist, wird die abgeleitete <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanz verwendet.</span><span class="sxs-lookup"><span data-stu-id="6d16b-147">If its value is `null`, then the inferred <xref:System.Runtime.Loader.AssemblyLoadContext> instance is used.</span></span>
    - <span data-ttu-id="6d16b-148">Siehe Tabelle oben.</span><span class="sxs-lookup"><span data-stu-id="6d16b-148">See table above.</span></span>

2. <span data-ttu-id="6d16b-149">Bei den `Load-by-name`-Methoden lädt der aktive <xref:System.Runtime.Loader.AssemblyLoadContext> die Assembly.</span><span class="sxs-lookup"><span data-stu-id="6d16b-149">For the `Load-by-name` methods, the active <xref:System.Runtime.Loader.AssemblyLoadContext> loads the assembly.</span></span> <span data-ttu-id="6d16b-150">Reihenfolge nach Priorität:</span><span class="sxs-lookup"><span data-stu-id="6d16b-150">In priority order by:</span></span>
    - <span data-ttu-id="6d16b-151">Überprüfen des `cache-by-name`</span><span class="sxs-lookup"><span data-stu-id="6d16b-151">Checking its `cache-by-name`.</span></span>

    - <span data-ttu-id="6d16b-152">Aufrufen der <xref:System.Runtime.Loader.AssemblyLoadContext.Load%2A?displayProperty=nameWithType>-Funktion</span><span class="sxs-lookup"><span data-stu-id="6d16b-152">Calling the <xref:System.Runtime.Loader.AssemblyLoadContext.Load%2A?displayProperty=nameWithType> function.</span></span>

    - <span data-ttu-id="6d16b-153">Überprüfen des Caches der <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType>-Instanzen und Ausführen der Logik für die [Standardüberprüfung verwalteter Assemblys](default-probing.md#managed-assembly-default-probing)</span><span class="sxs-lookup"><span data-stu-id="6d16b-153">Checking the <xref:System.Runtime.Loader.AssemblyLoadContext.Default%2A?displayProperty=nameWithType> instances' cache and running [managed assembly default probing](default-probing.md#managed-assembly-default-probing) logic.</span></span>

    - <span data-ttu-id="6d16b-154">Auslösen des <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving?displayProperty=nameWithType>-Ereignisses für den aktiven AssemblyLoadContext</span><span class="sxs-lookup"><span data-stu-id="6d16b-154">Raising the <xref:System.Runtime.Loader.AssemblyLoadContext.Resolving?displayProperty=nameWithType> event for the active AssemblyLoadContext.</span></span>

    - <span data-ttu-id="6d16b-155">Auslösen des <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType>-Ereignisses</span><span class="sxs-lookup"><span data-stu-id="6d16b-155">Raising the <xref:System.AppDomain.AssemblyResolve?displayProperty=nameWithType> event.</span></span>

3. <span data-ttu-id="6d16b-156">Bei den anderen Ladetypen lädt der `active` <xref:System.Runtime.Loader.AssemblyLoadContext> die Assembly.</span><span class="sxs-lookup"><span data-stu-id="6d16b-156">For the other types of loads, the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> loads the assembly.</span></span> <span data-ttu-id="6d16b-157">Reihenfolge nach Priorität:</span><span class="sxs-lookup"><span data-stu-id="6d16b-157">In priority order by:</span></span>
    - <span data-ttu-id="6d16b-158">Überprüfen des `cache-by-name`</span><span class="sxs-lookup"><span data-stu-id="6d16b-158">Checking its `cache-by-name`.</span></span>

    - <span data-ttu-id="6d16b-159">Laden aus dem angegebenen Pfad oder dem unformatierten Assemblyobjekt</span><span class="sxs-lookup"><span data-stu-id="6d16b-159">Loading from the specified path or raw assembly object.</span></span>

4. <span data-ttu-id="6d16b-160">In beiden Fällen gilt beim Laden einer Assembly Folgendes:</span><span class="sxs-lookup"><span data-stu-id="6d16b-160">In either case, if an assembly is newly loaded, then:</span></span>
   - <span data-ttu-id="6d16b-161">Das <xref:System.AppDomain.AssemblyLoad?displayProperty=nameWithType>-Ereignis wird ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="6d16b-161">The <xref:System.AppDomain.AssemblyLoad?displayProperty=nameWithType> event is raised.</span></span>
   - <span data-ttu-id="6d16b-162">Dem `cache-by-name` der <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanz der Assembly wird ein Verweis hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="6d16b-162">A reference is added to the assembly's <xref:System.Runtime.Loader.AssemblyLoadContext> instance's `cache-by-name`.</span></span>

5. <span data-ttu-id="6d16b-163">Wenn die Assembly gefunden wurde, wird dem `cache-by-name` der `active` <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanz bei Bedarf ein Verweis hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="6d16b-163">If the assembly is found, a reference is added as needed to the `active` <xref:System.Runtime.Loader.AssemblyLoadContext> instance's `cache-by-name`.</span></span>
