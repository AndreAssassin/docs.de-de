---
title: Problembehandlung bei Nachrichtenwarteschlangen
ms.date: 03/30/2017
ms.assetid: a5f2836f-018d-42f5-a571-1e97e64ea5b0
ms.openlocfilehash: 760ef4801c0881829dbc57b4022dcea4ed8c64bb
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "64645217"
---
# <a name="troubleshooting-queued-messaging"></a><span data-ttu-id="e8686-102">Problembehandlung bei Nachrichtenwarteschlangen</span><span class="sxs-lookup"><span data-stu-id="e8686-102">Troubleshooting Queued Messaging</span></span>
<span data-ttu-id="e8686-103">Dieser Abschnitt enthält häufig gestellte Fragen und Hilfe zur Problembehandlung für die Verwendung von Warteschlangen in Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="e8686-103">This section contains common questions and troubleshooting help for using queues in Windows Communication Foundation (WCF).</span></span>  
  
## <a name="common-questions"></a><span data-ttu-id="e8686-104">Allgemeine Fragen</span><span class="sxs-lookup"><span data-stu-id="e8686-104">Common Questions</span></span>  
 <span data-ttu-id="e8686-105">**Q:** Den MSMQ-Hotfix installiert, und ich habe die WCF-Beta 1 verwendet.</span><span class="sxs-lookup"><span data-stu-id="e8686-105">**Q:** I used WCF Beta 1 and I installed the MSMQ hotfix.</span></span> <span data-ttu-id="e8686-106">Muss ich den Hotfix entfernen?</span><span class="sxs-lookup"><span data-stu-id="e8686-106">Do I need to remove the hotfix?</span></span>  
  
 <span data-ttu-id="e8686-107">**Antwort:** Ja.</span><span class="sxs-lookup"><span data-stu-id="e8686-107">**A:** Yes.</span></span> <span data-ttu-id="e8686-108">Dieser Hotfix wird nicht mehr unterstützt.</span><span class="sxs-lookup"><span data-stu-id="e8686-108">This hotfix is no longer supported.</span></span> <span data-ttu-id="e8686-109">WCF funktioniert nun ohne Hotfix MSMQ.</span><span class="sxs-lookup"><span data-stu-id="e8686-109">WCF now works on MSMQ without a hotfix requirement.</span></span>  
  
 <span data-ttu-id="e8686-110">**Q:** Es gibt zwei Bindungen für MSMQ: <xref:System.ServiceModel.NetMsmqBinding> und <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>.</span><span class="sxs-lookup"><span data-stu-id="e8686-110">**Q:** There are two bindings for MSMQ: <xref:System.ServiceModel.NetMsmqBinding> and <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>.</span></span> <span data-ttu-id="e8686-111">Welche sollte ich wann verwenden?</span><span class="sxs-lookup"><span data-stu-id="e8686-111">What should I use and when?</span></span>  
  
 <span data-ttu-id="e8686-112">**Antwort:** Verwenden Sie die <xref:System.ServiceModel.NetMsmqBinding> Wenn Sie MSMQ als Transport für eine warteschlangenkommunikation zwischen zwei WCF-Anwendungen verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="e8686-112">**A:** Use the <xref:System.ServiceModel.NetMsmqBinding> when you want to use MSMQ as a transport for queued communication between two WCF applications.</span></span> <span data-ttu-id="e8686-113">Verwenden Sie die <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> Wenn Sie vorhandene MSMQ-Anwendungen, die zur Kommunikation mit der neuen WCF-Anwendungen verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="e8686-113">Use the <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> when you want to use existing MSMQ applications to communicate with new WCF applications.</span></span>  
  
 <span data-ttu-id="e8686-114">**Q:** Muss ich MSMQ verwendet ein upgrade der <xref:System.ServiceModel.NetMsmqBinding> und `MsmqIntegration` Bindungen?</span><span class="sxs-lookup"><span data-stu-id="e8686-114">**Q:** Do I have to upgrade MSMQ to use the <xref:System.ServiceModel.NetMsmqBinding> and `MsmqIntegration` bindings?</span></span>  
  
 <span data-ttu-id="e8686-115">**Antwort:** Nein.</span><span class="sxs-lookup"><span data-stu-id="e8686-115">**A:** No.</span></span> <span data-ttu-id="e8686-116">Beide Bindungen funktionieren mit MSMQ 3.0 unter [!INCLUDE[wxp](../../../../includes/wxp-md.md)] und [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e8686-116">Both bindings work with MSMQ 3.0 on [!INCLUDE[wxp](../../../../includes/wxp-md.md)] and [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)].</span></span> <span data-ttu-id="e8686-117">Bestimmte Funktionen der Bindungen werden verfügbar, wenn Sie in [!INCLUDE[wv](../../../../includes/wv-md.md)] ein Upgrade auf MSMQ 4.0 ausführen.</span><span class="sxs-lookup"><span data-stu-id="e8686-117">Certain features of the bindings become available when you upgrade to MSMQ 4.0 in [!INCLUDE[wv](../../../../includes/wv-md.md)].</span></span>  
  
 <span data-ttu-id="e8686-118">**Q:** Welche Features von der <xref:System.ServiceModel.NetMsmqBinding> und <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> Bindungen sind nur in MSMQ 4.0 und nicht in MSMQ 3.0 verfügbar?</span><span class="sxs-lookup"><span data-stu-id="e8686-118">**Q:** What features of the <xref:System.ServiceModel.NetMsmqBinding> and <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> bindings are available in MSMQ 4.0 but not in MSMQ 3.0?</span></span>  
  
 <span data-ttu-id="e8686-119">**Antwort:** Die folgenden Features sind in MSMQ 4.0 jedoch nicht in MSMQ 3.0 verfügbar:</span><span class="sxs-lookup"><span data-stu-id="e8686-119">**A:** The following features are available in MSMQ 4.0 but not in MSMQ 3.0:</span></span>  
  
- <span data-ttu-id="e8686-120">Benutzerdefinierte Warteschlange für unzustellbare Nachrichten wird nur in MSMQ 4.0 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="e8686-120">Custom dead-letter queue is supported only on MSMQ 4.0.</span></span>  
  
- <span data-ttu-id="e8686-121">In MSMQ 3.0 und 4.0 werden nicht verarbeitbare Nachrichten unterschiedlich behandelt.</span><span class="sxs-lookup"><span data-stu-id="e8686-121">MSMQ 3.0 and 4.0 handle poison messages differently.</span></span>  
  
- <span data-ttu-id="e8686-122">Nur MSMQ 4.0 unterstützt remote durchgeführte Lesevorgänge.</span><span class="sxs-lookup"><span data-stu-id="e8686-122">Only MSMQ 4.0 supports remote transacted read.</span></span>  
  
 <span data-ttu-id="e8686-123">Weitere Informationen finden Sie unter [Unterschiede in Queuing-Funktionen in Windows Vista, Windows Server 2003 und Windows XP](../../../../docs/framework/wcf/feature-details/diff-in-queue-in-vista-server-2003-windows-xp.md).</span><span class="sxs-lookup"><span data-stu-id="e8686-123">For more information, see [Differences in Queuing Features in Windows Vista, Windows Server 2003, and Windows XP](../../../../docs/framework/wcf/feature-details/diff-in-queue-in-vista-server-2003-windows-xp.md).</span></span>  
  
 <span data-ttu-id="e8686-124">**Q:** Kann ich MSMQ 3.0 auf einer Seite einer warteschlangenkommunikation und MSMQ 4.0 auf der anderen Seite verwenden?</span><span class="sxs-lookup"><span data-stu-id="e8686-124">**Q:** Can I use MSMQ 3.0 on one side of a queued communication and MSMQ 4.0 on the other side?</span></span>  
  
 <span data-ttu-id="e8686-125">**Antwort:** Ja.</span><span class="sxs-lookup"><span data-stu-id="e8686-125">**A:** Yes.</span></span>  
  
 <span data-ttu-id="e8686-126">**Q:** Ich möchte vorhandene MSMQ-Anwendungen in der neuen WCF-Clients oder Server zu integrieren.</span><span class="sxs-lookup"><span data-stu-id="e8686-126">**Q:** I want to integrate existing MSMQ applications with new WCF clients or servers.</span></span> <span data-ttu-id="e8686-127">Muss ich beide Seiten der MSMQ-Infrastruktur aktualisieren?</span><span class="sxs-lookup"><span data-stu-id="e8686-127">Do I need to upgrade both sides of my MSMQ infrastructure?</span></span>  
  
 <span data-ttu-id="e8686-128">**Antwort:** Nein.</span><span class="sxs-lookup"><span data-stu-id="e8686-128">**A:** No.</span></span> <span data-ttu-id="e8686-129">Sie müssen keine Seite auf MSMQ 4.0 aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="e8686-129">You do not have to upgrade to MSMQ 4.0 on either side.</span></span>  
  
## <a name="troubleshooting"></a><span data-ttu-id="e8686-130">Problembehandlung</span><span class="sxs-lookup"><span data-stu-id="e8686-130">Troubleshooting</span></span>  
 <span data-ttu-id="e8686-131">Dieser Abschnitt enthält Informationen zur Behandlung der häufigsten Probleme.</span><span class="sxs-lookup"><span data-stu-id="e8686-131">This section contains answers to most common troubleshooting issues.</span></span> <span data-ttu-id="e8686-132">Bei einigen Fragen handelt es sich um bekannte Einschränkungen, die auch in den Releasehinweisen erläutert werden.</span><span class="sxs-lookup"><span data-stu-id="e8686-132">Some issues that are known limitations are also described in the release notes.</span></span>  
  
 <span data-ttu-id="e8686-133">**Q:** Ich versuche, eine private Warteschlange verwenden, und ich erhalte die folgende Ausnahme: `System.InvalidOperationException`: Die URL ist ungültig.</span><span class="sxs-lookup"><span data-stu-id="e8686-133">**Q:** I am trying to use a private queue and I get the following exception: `System.InvalidOperationException`: The URL is invalid.</span></span> <span data-ttu-id="e8686-134">Die URL für die Warteschlange darf das Zeichen '$' nicht enthalten.</span><span class="sxs-lookup"><span data-stu-id="e8686-134">The URL for the queue cannot contain the '$' character.</span></span> <span data-ttu-id="e8686-135">Verwenden Sie die Syntax in net.msmq://machine/private/queueName, um eine private Warteschlange anzugeben.</span><span class="sxs-lookup"><span data-stu-id="e8686-135">Use the syntax in net.msmq://machine/private/queueName to address a private queue.</span></span>  
  
 <span data-ttu-id="e8686-136">**Antwort:** Überprüfen Sie die Warteschlange Uniform Resource Identifier (URI) in der Konfiguration und den Code ein.</span><span class="sxs-lookup"><span data-stu-id="e8686-136">**A:** Please check the queue Uniform Resource Identifier (URI) in your configuration and code.</span></span> <span data-ttu-id="e8686-137">Verwenden Sie kein "$"-Zeichen im URI.</span><span class="sxs-lookup"><span data-stu-id="e8686-137">Do not use the "$" character in the URI.</span></span> <span data-ttu-id="e8686-138">Geben Sie z. B. zur Adressierung einer privaten Warteschlange mit dem Namen OrdersQueue den URI als net.msmq://localhost/private/ordersQueue an.</span><span class="sxs-lookup"><span data-stu-id="e8686-138">For example, to address a private queue named OrdersQueue, specify the URI as net.msmq://localhost/private/ordersQueue.</span></span>  
  
 <span data-ttu-id="e8686-139">**Q:** Aufrufen von `ServiceHost.Open()` für meine Anwendung mit Queuing löst den folgenden Fehler: `System.ArgumentException`: Eine Basisadresse darf keine URI-Abfragezeichenfolge enthalten.</span><span class="sxs-lookup"><span data-stu-id="e8686-139">**Q:** Calling `ServiceHost.Open()` on my queued application throws the following exception: `System.ArgumentException`: A base address cannot contain a URI query string.</span></span> <span data-ttu-id="e8686-140">Warum?</span><span class="sxs-lookup"><span data-stu-id="e8686-140">Why?</span></span>  
  
 <span data-ttu-id="e8686-141">**Antwort:** Überprüfen Sie den Warteschlangen-URI in der Konfigurationsdatei und in Ihrem Code.</span><span class="sxs-lookup"><span data-stu-id="e8686-141">**A:** Check the queue URI in your configuration file and in your code.</span></span> <span data-ttu-id="e8686-142">Zwar wird in MSMQ-Warteschlangen die Verwendung von Fragezeichen ("?") unterstützt, diese werden von URIs jedoch als Beginn einer Zeichenfolgenabfrage interpretiert.</span><span class="sxs-lookup"><span data-stu-id="e8686-142">While MSMQ queues support the use of the '?' character, URIs interpret this character as the beginning of a string query.</span></span> <span data-ttu-id="e8686-143">Verwenden Sie deshalb Warteschlangennamen ohne Fragezeichen, um dieses Problem zu umgehen.</span><span class="sxs-lookup"><span data-stu-id="e8686-143">To avoid this issue, use queue names that do not contain '?' characters.</span></span>  
  
 <span data-ttu-id="e8686-144">**Q:** Sendevorgang war erfolgreich, aber beim Empfänger kein Dienstvorgang aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="e8686-144">**Q:** My send succeeded but no service operation is invoked on the receiver.</span></span> <span data-ttu-id="e8686-145">Warum?</span><span class="sxs-lookup"><span data-stu-id="e8686-145">Why?</span></span>  
  
 <span data-ttu-id="e8686-146">**Antwort:** Um die Antwort zu bestimmen, arbeiten Sie über die folgende Liste:</span><span class="sxs-lookup"><span data-stu-id="e8686-146">**A:** To determine the answer, work through the following check list:</span></span>  
  
- <span data-ttu-id="e8686-147">Überprüfen Sie, ob die Anforderungen der Transaktionswarteschlange mit den angegebenen Zusicherungen kompatibel sind.</span><span class="sxs-lookup"><span data-stu-id="e8686-147">Check that the transactional queue requirements are compatible with the assurances specified.</span></span> <span data-ttu-id="e8686-148">Beachten Sie die folgenden Prinzipien:</span><span class="sxs-lookup"><span data-stu-id="e8686-148">Note the following principles:</span></span>  
  
    - <span data-ttu-id="e8686-149">Sie können senden permanente Nachrichten (Datagramme und Sitzungen) mit "genau einmal"-zusicherungen (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `true`) nur an eine Transaktionswarteschlange.</span><span class="sxs-lookup"><span data-stu-id="e8686-149">You can send durable messages (datagrams and sessions) with "exactly once" assurances (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `true`) only to a transactional queue.</span></span>  
  
    - <span data-ttu-id="e8686-150">Sitzungen können nur mit "genau einmal"-Zusicherungen gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="e8686-150">You can send sessions only with "exactly once" assurances.</span></span>  
  
    - <span data-ttu-id="e8686-151">Eine Transaktion ist erforderlich, um Nachrichten in einer Sitzung von einer Transaktionswarteschlange zu empfangen.</span><span class="sxs-lookup"><span data-stu-id="e8686-151">A transaction is required to receive messages in a session from a transactional queue.</span></span>  
  
    - <span data-ttu-id="e8686-152">Sie können Nachrichten senden oder empfangen beispielsweise flüchtiger oder permanente (nur Datagramme) ohne zusicherungen (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `false`) nur für eine nicht transaktionale Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="e8686-152">You can send or receive volatile or durable messages (datagrams only) with no assurances (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `false`) only to a non-transactional queue.</span></span>  
  
- <span data-ttu-id="e8686-153">Überprüfen Sie die Warteschlange für unzustellbare Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="e8686-153">Check the dead-letter queue.</span></span> <span data-ttu-id="e8686-154">Wenn Sie die Nachrichten dort finden, stellen Sie fest, warum sie nicht zugestellt wurden.</span><span class="sxs-lookup"><span data-stu-id="e8686-154">If you find the messages there, determine why they were not delivered.</span></span>  
  
- <span data-ttu-id="e8686-155">Überprüfen Sie die ausgehenden Warteschlangen auf Konnektivitäts- oder Adressierungsprobleme.</span><span class="sxs-lookup"><span data-stu-id="e8686-155">Check the outgoing queues for connectivity or addressing problems.</span></span>  
  
 <span data-ttu-id="e8686-156">**Q:** Eine benutzerdefinierte Warteschlange für unzustellbare angegeben ist, aber wenn ich die senderanwendung zu starten, erhalte ich eine Ausnahme, die entweder über die Warteschlange für unzustellbare Nachrichten nicht gefunden wird oder die sendende Anwendung hat keine Berechtigung für die Warteschlange für unzustellbare Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="e8686-156">**Q:** I have specified a custom dead-letter queue, but when I start the sender application, I get an exception that either the dead-letter queue is not found, or the sending application has no permission to the dead-letter queue.</span></span> <span data-ttu-id="e8686-157">Warum geschieht das?</span><span class="sxs-lookup"><span data-stu-id="e8686-157">Why is this happening?</span></span>  
  
 <span data-ttu-id="e8686-158">**Antwort:** Die benutzerdefinierte Warteschlange für unzustellbare URI muss ein "Localhost" oder den Computernamen in das erste Segment, z. B. MSMQ://localhost/private/meineunzustwarteschlange enthalten.</span><span class="sxs-lookup"><span data-stu-id="e8686-158">**A:** The custom dead-letter queue URI must include a "localhost" or the computer name in the first segment, for example, net.msmq://localhost/private/myAppdead-letter queue.</span></span>  
  
 <span data-ttu-id="e8686-159">**Q:** Ist es immer erforderlich ist, definieren eine benutzerdefinierte Warteschlange für unzustellbare Nachrichten als unzustellbar zu kennzeichnen, oder gibt es eine Standard-Warteschlange für unzustellbare Nachrichten?</span><span class="sxs-lookup"><span data-stu-id="e8686-159">**Q:** Is it always necessary to define a custom dead-letter queue, or is there a default dead-letter queue?</span></span>  
  
 <span data-ttu-id="e8686-160">**Antwort:** Wenn "genau einmal"-zusicherungen werden (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `true`), und wenn Sie eine benutzerdefinierte Warteschlange für unzustellbare nicht angeben, wird der Standardwert ist eine systemweite transaktionale Dead Letter-Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="e8686-160">**A:** If assurances are "exactly once" (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `true`), and if you do not specify a custom dead-letter queue, the default is a system-wide transactional dead-letter queue.</span></span>  
  
 <span data-ttu-id="e8686-161">Wenn zusicherungen (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `false`), dann die Standardeinstellung keine Funktionalität Dead Letter-Warteschlange ist.</span><span class="sxs-lookup"><span data-stu-id="e8686-161">If assurances are none (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `false`), then the default is no dead-letter queue functionality.</span></span>  
  
 <span data-ttu-id="e8686-162">**Q:** Mein Dienst löst auf SvcHost.Open mit einer Nachricht "EndpointListener-Anforderungen können nicht erfüllt werden durch die ListenerFactory" aus.</span><span class="sxs-lookup"><span data-stu-id="e8686-162">**Q:** My service throws on SvcHost.Open with a message "EndpointListener requirements cannot be met by the ListenerFactory".</span></span> <span data-ttu-id="e8686-163">Warum?</span><span class="sxs-lookup"><span data-stu-id="e8686-163">Why?</span></span>  
  
 <span data-ttu-id="e8686-164">A.</span><span class="sxs-lookup"><span data-stu-id="e8686-164">A.</span></span> <span data-ttu-id="e8686-165">Überprüfen Sie den Dienstvertrag.</span><span class="sxs-lookup"><span data-stu-id="e8686-165">Check your service contract.</span></span> <span data-ttu-id="e8686-166">Sie möglicherweise haben Sie vergessen "IsOneWay =`true`" auf alle Dienstvorgänge.</span><span class="sxs-lookup"><span data-stu-id="e8686-166">You may have forgotten to put "IsOneWay=`true`" on all the service operations.</span></span> <span data-ttu-id="e8686-167">Warteschlangen unterstützen nur unidirektionale Dienstvorgänge.</span><span class="sxs-lookup"><span data-stu-id="e8686-167">Queues support only one-way service operations.</span></span>  
  
 <span data-ttu-id="e8686-168">**Q:** Nachrichten in die Warteschlange vorhanden sind, aber kein Dienstvorgang aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="e8686-168">**Q:** There are messages in the queue but no service operation is invoked.</span></span> <span data-ttu-id="e8686-169">Wo liegt das Problem?</span><span class="sxs-lookup"><span data-stu-id="e8686-169">What is the problem?</span></span>  
  
 <span data-ttu-id="e8686-170">**Antwort:** Bestimmt, ob der Diensthost fehlerhaft ist.</span><span class="sxs-lookup"><span data-stu-id="e8686-170">**A:** Determine if your service host is faulted.</span></span> <span data-ttu-id="e8686-171">Sie können das feststellen, indem Sie die Ablaufverfolgung überprüfen oder `IErrorHandler` implementieren.</span><span class="sxs-lookup"><span data-stu-id="e8686-171">You can check by looking at the trace or implementing `IErrorHandler`.</span></span> <span data-ttu-id="e8686-172">Der Diensthost schlägt standardmäßig fehl, wenn eine nicht verarbeitbare Nachrichten erkannt wird.</span><span class="sxs-lookup"><span data-stu-id="e8686-172">Service host faults, by default, if a poison message is detected.</span></span>  
  
 <span data-ttu-id="e8686-173">**Q:** Nachrichten in die Warteschlange vorhanden sind, aber meine im Internet gehosteten in der Warteschlange befindlichen Dienst ist nicht aktiviert.</span><span class="sxs-lookup"><span data-stu-id="e8686-173">**Q:** There are messages in the queue but my Web-hosted queued service is not getting activated.</span></span> <span data-ttu-id="e8686-174">Warum?</span><span class="sxs-lookup"><span data-stu-id="e8686-174">Why?</span></span>  
  
 <span data-ttu-id="e8686-175">**Antwort:** Der häufigste Grund sind die Berechtigungen.</span><span class="sxs-lookup"><span data-stu-id="e8686-175">**A:** The most common reason is permissions.</span></span>  
  
1. <span data-ttu-id="e8686-176">Stellen Sie sicher, dass der `NetMsmqActivator`-Prozess ausgeführt wird und die Identität des `NetMsmqActivator`-Prozesses Lese- und Suchberechtigungen für die Warteschlange besitzt.</span><span class="sxs-lookup"><span data-stu-id="e8686-176">Ensure that the `NetMsmqActivator` process is running and the identity of the `NetMsmqActivator` process is given read and seek permission on the queue.</span></span>  
  
2. <span data-ttu-id="e8686-177">Wenn `NetMsmqActivator` Warteschlangen auf einem Remotecomputer überwacht, stellen Sie sicher, dass `NetMsmqActivator` unter keinem eingeschränkten Token ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="e8686-177">If the `NetMsmqActivator` is monitoring queues on a remote machine, ensure that `NetMsmqActivator` does not run under a restricted token.</span></span> <span data-ttu-id="e8686-178">So führen Sie `NetMsmqActivator` mit einem uneingeschränkten Token aus:</span><span class="sxs-lookup"><span data-stu-id="e8686-178">To run the `NetMsmqActivator` with an unrestricted token:</span></span>  
  
    ```  
    sc sidtype NetMsmqActivator unrestricted  
    ```  
  
 <span data-ttu-id="e8686-179">Web-Host der sicherheitsrelevanter Probleme finden Sie unter: [Webhosting einer Anwendung mit Queuing](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md).</span><span class="sxs-lookup"><span data-stu-id="e8686-179">For non-security related Web host issues refer to: [Web Hosting a Queued Application](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md).</span></span>  
  
 <span data-ttu-id="e8686-180">**Q:** Was ist am einfachsten auf Sitzungen zugegriffen?</span><span class="sxs-lookup"><span data-stu-id="e8686-180">**Q:** What is the easiest way to access sessions?</span></span>  
  
 <span data-ttu-id="e8686-181">**Antwort:** Festlegen von AutoVervollständigen =`true` für den Vorgang, der die dem letzten Nachricht in der Sitzung, und legen Sie die automatische Vervollständigung =`false` auf alle verbleibenden Dienstvorgänge.</span><span class="sxs-lookup"><span data-stu-id="e8686-181">**A:** Set AutoComplete=`true` on the operation that corresponds to the last message in the session, and set AutoComplete=`false` on all remaining service operations.</span></span>  
  
 <span data-ttu-id="e8686-182">**Q:** Wo finde ich Antworten auf häufig gestellte Fragen zu MSMQ?</span><span class="sxs-lookup"><span data-stu-id="e8686-182">**Q:** Where can I find answers to common questions on MSMQ?</span></span>  
  
 <span data-ttu-id="e8686-183">**Antwort:** Weitere Informationen zu MSMQ finden Sie unter [Microsoft Message Queuing](https://go.microsoft.com/fwlink/?LinkId=87810).</span><span class="sxs-lookup"><span data-stu-id="e8686-183">**A:** For more information about MSMQ, see [Microsoft Message Queuing](https://go.microsoft.com/fwlink/?LinkId=87810).</span></span>  
  
 <span data-ttu-id="e8686-184">**Q:** Warum löst der Dienst eine `ProtocolException` beim Lesen aus einer Warteschlange, die beide enthält sitzungsnachrichten und datagrammnachrichten in Warteschlangen?</span><span class="sxs-lookup"><span data-stu-id="e8686-184">**Q:** Why does my service throw a `ProtocolException` when reading from a queue that contains both queued session messages and queued datagram messages?</span></span>  
  
 <span data-ttu-id="e8686-185">**Antwort:** Es ist ein wesentlicher Unterschied in der sitzungsnachrichten und in der Warteschlange datagrammnachrichten.</span><span class="sxs-lookup"><span data-stu-id="e8686-185">**A:** There is a fundamental difference in the way queued session messages and queued datagram messages are composed.</span></span> <span data-ttu-id="e8686-186">Deshalb kann ein Dienst, der eine Sitzungsnachricht in einer Warteschlange lesen soll, keine Datagrammnachricht empfangen, und kann ein Dienst, der eine Datagrammnachricht in einer Warteschlange lesen soll, keine Sitzungsnachricht empfangen.</span><span class="sxs-lookup"><span data-stu-id="e8686-186">Because of this, a service that is expecting to read a queued session message cannot receive a queued datagram message and a service expecting to read a queued datagram message cannot receive a session message.</span></span> <span data-ttu-id="e8686-187">Bei dem Versuch, beide Nachrichtentypen in derselben Warteschlange zu lesen, wird die folgende Ausnahme ausgelöst:</span><span class="sxs-lookup"><span data-stu-id="e8686-187">Attempting to read both types of messages from the same queue throws the following exception:</span></span>  
  
```  
System.ServiceModel.MsmqPoisonMessageException: The transport channel detected a poison message. This occurred because the message exceeded the maximum number of delivery attempts or because the channel detected a fundamental problem with the message. The inner exception may contain additional information.   
---> System.ServiceModel.ProtocolException: An incoming MSMQ message contained invalid or unexpected .NET Message Framing information in its body. The message cannot be received. Ensure that the sender is using a compatible service contract with a matching SessionMode.  
```  
  
 <span data-ttu-id="e8686-188">Bei der systemweiten Warteschlange für unzustellbare Nachrichten und auch bei benutzerdefinierten Warteschlangen für unzustellbare Nachrichten tritt dieses Problem schnell auf, wenn eine Anwendung Sitzungsnachrichten und Datagrammnachrichten in Warteschlangen vom selben Computer aus sendet.</span><span class="sxs-lookup"><span data-stu-id="e8686-188">The system dead-letter queue, as well as any custom dead-letter queue, is particularly susceptible to this issue if an application sends both queued session messages and queued datagram messages from the same computer.</span></span> <span data-ttu-id="e8686-189">Wenn eine Nachricht nicht erfolgreich gesendet werden kann, wird sie in die Warteschlange für unzustellbare Nachrichten verschoben.</span><span class="sxs-lookup"><span data-stu-id="e8686-189">If a message cannot be sent successfully, it is moved to the dead-letter queue.</span></span> <span data-ttu-id="e8686-190">Aus diesem Grund kann es vorkommen, dass sich sowohl Sitzung- als auch Datagrammnachrichten in der Warteschlange für unzustellbare Nachrichten befinden.</span><span class="sxs-lookup"><span data-stu-id="e8686-190">Under these circumstances, it is possible to have both session and datagram messages in the dead-letter queue.</span></span> <span data-ttu-id="e8686-191">Es gibt keine Möglichkeit, die beiden Nachrichtentypen beim Lesen einer Warteschlange zur Laufzeit zu trennen. Deshalb sollten Anwendungen Sitzungsnachrichten und Datagrammnachrichten in Warteschlangen nicht vom selben Computer aus senden.</span><span class="sxs-lookup"><span data-stu-id="e8686-191">There is no way to separate both types of messages at runtime when reading from a queue, therefore, applications should not send both queued session messages and queued datagram messages from the same computer.</span></span>  
  
### <a name="msmq-integration-specific-troubleshooting"></a><span data-ttu-id="e8686-192">MSMQ-Integration: Informationen zur Fehlerbehebung</span><span class="sxs-lookup"><span data-stu-id="e8686-192">MSMQ Integration: Specific Troubleshooting</span></span>  
 <span data-ttu-id="e8686-193">**Q:** Wenn ich eine Nachricht senden, oder wenn ich den Diensthost öffne, erhalte ich eine Fehlermeldung, die angibt, dass das Schema falsch ist.</span><span class="sxs-lookup"><span data-stu-id="e8686-193">**Q:** When I send a message, or when I open the service host, I get an error that indicates the scheme is wrong.</span></span> <span data-ttu-id="e8686-194">Warum?</span><span class="sxs-lookup"><span data-stu-id="e8686-194">Why?</span></span>  
  
 <span data-ttu-id="e8686-195">**Antwort:** Wenn Sie die MSMQ-Integration-Bindung verwenden, müssen Sie das msmq.formatname-Schema verwenden.</span><span class="sxs-lookup"><span data-stu-id="e8686-195">**A:** When you use the MSMQ integration binding, you must use the msmq.formatname scheme.</span></span> <span data-ttu-id="e8686-196">Beispiel: msmq.formatname:DIRECT=OS:.\private$\OrdersQueue.</span><span class="sxs-lookup"><span data-stu-id="e8686-196">For example, msmq.formatname:DIRECT=OS:.\private$\OrdersQueue.</span></span> <span data-ttu-id="e8686-197">Wenn Sie jedoch die benutzerdefinierte Warteschlange für unzustellbare Nachrichten angeben, müssen Sie das net.msmq-Schema verwenden.</span><span class="sxs-lookup"><span data-stu-id="e8686-197">But when you specify the custom dead-letter queue, you must use the net.msmq scheme.</span></span>  
  
 <span data-ttu-id="e8686-198">**Q:** Wenn ich einen öffentlichen oder privaten Formatnamen verwenden, und Öffnen des Diensthosts auf [!INCLUDE[wv](../../../../includes/wv-md.md)], ich erhalte einen Fehler.</span><span class="sxs-lookup"><span data-stu-id="e8686-198">**Q:** When I use a public or private format name and open the service host on [!INCLUDE[wv](../../../../includes/wv-md.md)], I get an error.</span></span> <span data-ttu-id="e8686-199">Warum?</span><span class="sxs-lookup"><span data-stu-id="e8686-199">Why?</span></span>  
  
 <span data-ttu-id="e8686-200">**Antwort:** Der WCF-Integration-Kanal auf [!INCLUDE[wv](../../../../includes/wv-md.md)] überprüft, ob eine untergeordnete Warteschlange für die hauptanwendung Warteschlange für die Behandlung nicht verarbeitbarer Nachrichten geöffnet werden kann.</span><span class="sxs-lookup"><span data-stu-id="e8686-200">**A:** The WCF integration channel on [!INCLUDE[wv](../../../../includes/wv-md.md)] checks to see if a sub-queue can be opened for the main application queue for handling poison messages.</span></span> <span data-ttu-id="e8686-201">Der Name der untergeordneten Warteschlange wird von einem an den Listener übergebenen msmq.formatname-URI abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="e8686-201">The sub-queue name is derived from an msmq.formatname URI passed to the listener.</span></span> <span data-ttu-id="e8686-202">Der Name der untergeordneten Warteschlange kann in MSMQ nur ein direkter Formatname sein.</span><span class="sxs-lookup"><span data-stu-id="e8686-202">The sub-queue name in MSMQ can only be a direct format name.</span></span> <span data-ttu-id="e8686-203">Deshalb tritt der Fehler auf.</span><span class="sxs-lookup"><span data-stu-id="e8686-203">So you see the error.</span></span> <span data-ttu-id="e8686-204">Ändern Sie den Warteschlangen-URI in einen direkten Formatnamen.</span><span class="sxs-lookup"><span data-stu-id="e8686-204">Change the queue URI to a direct format name.</span></span>  
  
 <span data-ttu-id="e8686-205">**Q:** Beim Empfang einer Nachricht von einer MSMQ-Anwendung wird die Nachricht in der Warteschlange befindet und nicht von der empfangenden WCF-Anwendung gelesen wird.</span><span class="sxs-lookup"><span data-stu-id="e8686-205">**Q:** When receiving a message from an MSMQ application, the message sits in the queue and is not read by the receiving WCF application.</span></span> <span data-ttu-id="e8686-206">Warum?</span><span class="sxs-lookup"><span data-stu-id="e8686-206">Why?</span></span>  
  
 <span data-ttu-id="e8686-207">**Antwort:** Überprüfen Sie, ob die Nachricht einen Text enthält.</span><span class="sxs-lookup"><span data-stu-id="e8686-207">**A:** Check to see whether the message has a body.</span></span> <span data-ttu-id="e8686-208">Ohne Nachrichtentext ignoriert der MSMQ-Integrationskanal die Nachricht.</span><span class="sxs-lookup"><span data-stu-id="e8686-208">If the message has no body, the MSMQ integration channel ignores the message.</span></span> <span data-ttu-id="e8686-209">Implementieren Sie `IErrorHandler`, um bei Ausnahmen benachrichtigt zu werden, und überprüfen Sie die Ablaufverfolgungen.</span><span class="sxs-lookup"><span data-stu-id="e8686-209">Implement `IErrorHandler` to be notified of exceptions and check the traces.</span></span>  
  
### <a name="security-related-troubleshooting"></a><span data-ttu-id="e8686-210">Sicherheitsrelevante Problembehandlung</span><span class="sxs-lookup"><span data-stu-id="e8686-210">Security-Related Troubleshooting</span></span>  
 <span data-ttu-id="e8686-211">**Q:** Beim Ausführen des Beispiels, die eine standardbindung im Arbeitsgruppenmodus verwendet, werden Nachrichten scheinbar gesendet wird, erhalten jedoch nie vom Empfänger empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="e8686-211">**Q:** When I run the sample that uses a default binding in workgroup mode, messages seem to get sent but are never received by the receiver.</span></span>  
  
 <span data-ttu-id="e8686-212">**Antwort:** Standardmäßig werden Nachrichten mit einem internen MSMQ-Zertifikat, das von den Active Directory-Verzeichnisdienst erfordert signiert.</span><span class="sxs-lookup"><span data-stu-id="e8686-212">**A:** By default, messages are signed using an MSMQ internal certificate that requires the Active Directory directory service.</span></span> <span data-ttu-id="e8686-213">Da Active Directory im Arbeitsgruppenmodus nicht verfügbar ist, verursacht das Signieren der Nachricht einen Fehler.</span><span class="sxs-lookup"><span data-stu-id="e8686-213">In workgroup mode, because Active Directory is not available, signing the message fails.</span></span> <span data-ttu-id="e8686-214">Daher kommt die Nachricht in die Warteschlange für unzustellbare Nachrichten und Fehlerursache, wie z. B. "Ungültige Signatur" wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="e8686-214">So the message lands in the dead-letter queue and failure cause, such as "Bad signature", is indicated.</span></span>  
  
 <span data-ttu-id="e8686-215">Sie können das Problem beheben, indem Sie die Sicherheit deaktivien.</span><span class="sxs-lookup"><span data-stu-id="e8686-215">The workaround is to turn off security.</span></span> <span data-ttu-id="e8686-216">Dies erfolgt durch Festlegen von <xref:System.ServiceModel.NetMsmqSecurity.Mode%2A>  =  <xref:System.ServiceModel.NetMsmqSecurityMode.None> , damit im Arbeitsgruppenmodus funktioniert.</span><span class="sxs-lookup"><span data-stu-id="e8686-216">This is done by setting <xref:System.ServiceModel.NetMsmqSecurity.Mode%2A> = <xref:System.ServiceModel.NetMsmqSecurityMode.None> to make it work in workgroup mode.</span></span>  
  
 <span data-ttu-id="e8686-217">Eine weitere Möglichkeit besteht darin, <xref:System.ServiceModel.MsmqTransportSecurity> aus der <xref:System.ServiceModel.NetMsmqSecurity.Transport%2A>-Eigenschaft abzurufen und auf <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> festzulegen und dann das Clientzertifikat festzulegen.</span><span class="sxs-lookup"><span data-stu-id="e8686-217">Another workaround is to get the <xref:System.ServiceModel.MsmqTransportSecurity> from the <xref:System.ServiceModel.NetMsmqSecurity.Transport%2A> property and set it to <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate>, and set the client certificate.</span></span>  
  
 <span data-ttu-id="e8686-218">Sie können das Problem auch beheben, indem Sie MSMQ mit Active Directory-Integration installieren.</span><span class="sxs-lookup"><span data-stu-id="e8686-218">Yet another workaround is to install MSMQ with Active Directory integration.</span></span>  
  
 <span data-ttu-id="e8686-219">**Q:** Beim Senden einer Nachricht mit standardbindung (bei aktivierter transportsicherheit) in Active Directory an eine Warteschlange, die Meldung "Internes Zertifikat wurde nicht gefunden".</span><span class="sxs-lookup"><span data-stu-id="e8686-219">**Q:** When I send a message with default binding (transport security turned on) in Active Directory to a queue, I get an "internal certificate not found" message.</span></span> <span data-ttu-id="e8686-220">Wie kann ich das Problem beheben?</span><span class="sxs-lookup"><span data-stu-id="e8686-220">How do I fix this?</span></span>  
  
 <span data-ttu-id="e8686-221">**Antwort:** Dies bedeutet, dass das Zertifikat in Active Directory für den Absender erneuert werden muss.</span><span class="sxs-lookup"><span data-stu-id="e8686-221">**A:** This means that the certificate in Active Directory for the sender must be renewed.</span></span> <span data-ttu-id="e8686-222">Öffnen Sie zu diesem Zweck **Systemsteuerung**, **Verwaltung**, **Computerverwaltung**, mit der rechten Maustaste **MSMQ**, und wählen Sie **Eigenschaften**.</span><span class="sxs-lookup"><span data-stu-id="e8686-222">To do so, open **Control Panel**, **Administrative Tools**, **Computer Management**, right-click **MSMQ**, and select **Properties**.</span></span> <span data-ttu-id="e8686-223">Wählen Sie die **Benutzerzertifikat** Registerkarte, und klicken Sie auf die **erneuern** Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="e8686-223">Select the **User Certificate** tab and click the **Renew** button.</span></span>  
  
 <span data-ttu-id="e8686-224">**Q:** Beim Senden einer Nachricht mit <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> und das zu verwendende Zertifikat angeben, wird die Meldung "Ungültiges Zertifikat".</span><span class="sxs-lookup"><span data-stu-id="e8686-224">**Q:** When I send a message using <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> and specify the certificate to use, I get an "Invalid certificate" message.</span></span> <span data-ttu-id="e8686-225">Wie kann ich das Problem beheben?</span><span class="sxs-lookup"><span data-stu-id="e8686-225">How do I fix this?</span></span>  
  
 <span data-ttu-id="e8686-226">**Antwort:** Sie können keinen Zertifikatspeicher des lokalen Computers mit dem zertifikatmodus verwenden.</span><span class="sxs-lookup"><span data-stu-id="e8686-226">**A:** You cannot use a local machine certificate store with certificate mode.</span></span> <span data-ttu-id="e8686-227">Sie müssen das Zertifikat mit dem Zertifikat-Snap-In aus dem Zertifikatspeicher des Computers in den Speicher des aktuellen Benutzers kopieren.</span><span class="sxs-lookup"><span data-stu-id="e8686-227">You have to copy the certificate from the machine certificate store to the current user store using the Certificate snap-in.</span></span> <span data-ttu-id="e8686-228">So rufen Sie das Zertifikat-Snap-In auf:</span><span class="sxs-lookup"><span data-stu-id="e8686-228">To get the Certificate snap-in:</span></span>  
  
1. <span data-ttu-id="e8686-229">Klicken Sie auf **starten**Option **ausführen**, Typ `mmc`, und klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="e8686-229">Click **Start**, select **Run**, type `mmc`, and click **OK**.</span></span>  
  
2. <span data-ttu-id="e8686-230">In der **Microsoft Management Console**öffnen die **Datei** Menü **Snap-In hinzufügen/entfernen**.</span><span class="sxs-lookup"><span data-stu-id="e8686-230">In the **Microsoft Management Console**, open the **File** menu and select **Add/Remove Snap-in**.</span></span>  
  
3. <span data-ttu-id="e8686-231">In der **Snap-In hinzufügen/entfernen** Dialogfeld klicken Sie auf die **hinzufügen** Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="e8686-231">In the **Add/Remove Snap-in** dialog box, click the **Add** button.</span></span>  
  
4. <span data-ttu-id="e8686-232">In der **Standalone-Snap-in hinzufügen** (Dialogfeld), auf Zertifikate aus, und klicken Sie auf **hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="e8686-232">In the **Add Standalone Snap-in** dialog box, select Certificates and click **Add**.</span></span>  
  
5. <span data-ttu-id="e8686-233">In der **Zertifikate** wählen Sie im Snap-in-Dialogfeld **mein Benutzerkonto** , und klicken Sie auf **Fertig stellen**.</span><span class="sxs-lookup"><span data-stu-id="e8686-233">In the **Certificates** snap-in dialog box, select **My user account,** and click **Finish**.</span></span>  
  
6. <span data-ttu-id="e8686-234">Fügen Sie ein zweites Zertifkat-Snap-in der obigen Schritte, aber diesmal wählen **Computerkonto** , und klicken Sie auf **Weiter**.</span><span class="sxs-lookup"><span data-stu-id="e8686-234">Next, add a second Certificates snap-in using the previous steps, but this time select **Computer account** and click **Next**.</span></span>  
  
7. <span data-ttu-id="e8686-235">Wählen Sie **lokalen Computer** , und klicken Sie auf **Fertig stellen**.</span><span class="sxs-lookup"><span data-stu-id="e8686-235">Select **Local Computer** and click **Finish**.</span></span> <span data-ttu-id="e8686-236">Sie können jetzt Zertifikate per Drag &amp; Drop aus dem Computerzertifikatspeicher in den Speicher des aktuellen Benutzers verschieben.</span><span class="sxs-lookup"><span data-stu-id="e8686-236">You can now drag and drop certificates from the machine certificate store to the current user store.</span></span>  
  
 <span data-ttu-id="e8686-237">**Q:** Wenn mein Dienst aus einer Warteschlange auf einem anderen Computer im Arbeitsgruppenmodus liest, erhalte ich ein "Zugriff verweigert"-Ausnahme aus.</span><span class="sxs-lookup"><span data-stu-id="e8686-237">**Q:** When my service reads from a queue on another computer in workgroup mode, I get an "access denied" exception.</span></span>  
  
 <span data-ttu-id="e8686-238">**Antwort:** Im Arbeitsgruppenmodus ausgeführt, damit eine Remoteanwendung für den Zugriff auf die Warteschlange, muss die Anwendung die Berechtigung Zugriff auf die Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="e8686-238">**A:** In workgroup mode, for a remote application to gain access to the queue, the application must have permission to access the queue.</span></span> <span data-ttu-id="e8686-239">Zugriffssteuerungsliste (ACL) für die Warteschlange "Anonyme Anmeldung" hinzugefügt, und geben sie die read-Berechtigung.</span><span class="sxs-lookup"><span data-stu-id="e8686-239">Add "Anonymous login" to the queue's access control list (ACL) and give it read permission.</span></span>  
  
 <span data-ttu-id="e8686-240">**Q:** Wenn ein netzwerkdienstclient (oder jeder Client, der nicht über ein Domänenkonto verfügt), eine Nachricht in der Warteschlange sendet, schlägt der Sendevorgang wegen eines ungültigen Zertifikats fehl.</span><span class="sxs-lookup"><span data-stu-id="e8686-240">**Q:** When a network service client (or any client that does not have a domain account) sends a queued message, the send fails with an invalid certificate.</span></span> <span data-ttu-id="e8686-241">Wie kann ich das Problem beheben?</span><span class="sxs-lookup"><span data-stu-id="e8686-241">How do I fix this?</span></span>  
  
 <span data-ttu-id="e8686-242">**Antwort:** Überprüfen Sie die Bindungskonfiguration.</span><span class="sxs-lookup"><span data-stu-id="e8686-242">**A:** Check the binding configuration.</span></span> <span data-ttu-id="e8686-243">Für die Standardbindung ist die MSMQ-Transportsicherheit zum Signieren der Nachricht aktiviert.</span><span class="sxs-lookup"><span data-stu-id="e8686-243">The default binding has MSMQ transport security turned on to sign the message.</span></span> <span data-ttu-id="e8686-244">Deaktivieren Sie sie.</span><span class="sxs-lookup"><span data-stu-id="e8686-244">Turn it off.</span></span>  
  
### <a name="remote-transacted-receives"></a><span data-ttu-id="e8686-245">Remote durchgeführte Empfangsvorgänge</span><span class="sxs-lookup"><span data-stu-id="e8686-245">Remote Transacted Receives</span></span>  
 <span data-ttu-id="e8686-246">**Q:** Bei einer Warteschlange auf Computer ein, und ein WCF-Dienst, der liest Nachrichten aus einer Warteschlange auf Computer B (für die Remote durchgeführte Empfangsvorgänge Szenario), Nachrichten nicht aus der Warteschlange gelesen.</span><span class="sxs-lookup"><span data-stu-id="e8686-246">**Q:** When I have a queue on machine A, and a WCF service that reads messages from a queue on machine B (the remote transacted receive scenario), messages are not read from the queue.</span></span> <span data-ttu-id="e8686-247">Ablaufverfolgungsinformationen gibt an, die bei der der Empfang der Nachricht "Transaktion kann nicht importiert werden."</span><span class="sxs-lookup"><span data-stu-id="e8686-247">Tracing information indicates the receive failed with the message "Transaction cannot be imported."</span></span> <span data-ttu-id="e8686-248">Was kann ich tun, um dieses Problem zu beheben?</span><span class="sxs-lookup"><span data-stu-id="e8686-248">What can I do to fix this?</span></span>  
  
 <span data-ttu-id="e8686-249">**Antwort:** Für dieses Problem gibt es drei mögliche Ursachen:</span><span class="sxs-lookup"><span data-stu-id="e8686-249">**A:** There are three possible reasons for this:</span></span>  
  
- <span data-ttu-id="e8686-250">Im Domänenmodus ist für remote durchgeführte Empfangsvorgänge ein MSDTC-Netzwerkzugriff (Microsoft Distributed Transaction Coordinator) erforderlich.</span><span class="sxs-lookup"><span data-stu-id="e8686-250">If you are in domain mode, remote transacted receive requires Microsoft Distributed Transaction Coordinator (MSDTC) network access.</span></span> <span data-ttu-id="e8686-251">Sie können dies mit **Komponenten hinzufügen/entfernen**.</span><span class="sxs-lookup"><span data-stu-id="e8686-251">You can enable this using **Add/Remove Components**.</span></span>  
  
     ![Screenshot mit Aktivieren der Netzwerk-DTC Zugriff.](./media/troubleshooting-queued-messaging/enable-distributed-transaction-coordinator-access.jpg)  
  
- <span data-ttu-id="e8686-253">Überprüfen Sie den Authentifizierungsmodus für die Kommunikation mit dem Transaktions-Manager.</span><span class="sxs-lookup"><span data-stu-id="e8686-253">Check the authentication mode for communicating with the transaction manager.</span></span> <span data-ttu-id="e8686-254">Wenn Sie im Arbeitsgruppenmodus ausgeführt sind, muss "Keine Authentifizierung erforderlich" ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="e8686-254">If you are in workgroup mode, "No Authentication Required" must be selected.</span></span> <span data-ttu-id="e8686-255">Wenn Sie im Domänenmodus sind, muss "Gegenseitige Authentifizierung erforderlich" ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="e8686-255">If you are in domain mode, then "Mutual Authentication Required" must be selected.</span></span>  
  
     <span data-ttu-id="e8686-256">![Aktivieren von XA-Transaktionen](../../../../docs/framework/wcf/feature-details/media/4f3695e0-fb0b-4c5b-afac-75f8860d2bb0.jpg "4f3695e0-fb0b-4c5b-afac-75f8860d2bb0")</span><span class="sxs-lookup"><span data-stu-id="e8686-256">![Enabling XA transactions](../../../../docs/framework/wcf/feature-details/media/4f3695e0-fb0b-4c5b-afac-75f8860d2bb0.jpg "4f3695e0-fb0b-4c5b-afac-75f8860d2bb0")</span></span>  
  
- <span data-ttu-id="e8686-257">Stellen Sie sicher, dass MSDTC in der Liste der Ausnahmen in der **Internetverbindungsfirewall** Einstellungen.</span><span class="sxs-lookup"><span data-stu-id="e8686-257">Make sure that MSDTC is in the list of exceptions in the **Internet Connection Firewall** settings.</span></span>  
  
- <span data-ttu-id="e8686-258">Stellen Sie sicher, dass Sie [!INCLUDE[wv](../../../../includes/wv-md.md)] verwenden.</span><span class="sxs-lookup"><span data-stu-id="e8686-258">Ensure that you are using [!INCLUDE[wv](../../../../includes/wv-md.md)].</span></span> <span data-ttu-id="e8686-259">MSMQ in [!INCLUDE[wv](../../../../includes/wv-md.md)] unterstützt remote durchgeführte Lesevorgänge.</span><span class="sxs-lookup"><span data-stu-id="e8686-259">MSMQ on [!INCLUDE[wv](../../../../includes/wv-md.md)] supports remote transacted read.</span></span> <span data-ttu-id="e8686-260">MSMQ in früheren Windows-Releases unterstützt keine remote durchgeführten Lesevorgänge.</span><span class="sxs-lookup"><span data-stu-id="e8686-260">MSMQ on earlier Windows releases does not support remote transacted read.</span></span>  
  
 <span data-ttu-id="e8686-261">**Q:** Wenn der Dienst, der aus der Warteschlange liest einen Netzwerkdienst ist, wird z. B. in einer Web-Host, warum ich eine zugriffsverweigerung-Ausnahme erhalte ausgelöst, wenn aus der Warteschlange zu lesen?</span><span class="sxs-lookup"><span data-stu-id="e8686-261">**Q:** When the service reading from the queue is a network service, for example, in a Web host, why do I get an access-denied exception is raised when reading from the queue?</span></span>  
  
 <span data-ttu-id="e8686-262">**Antwort:** Lesezugriff des Netzwerkdiensts muss hinzugefügt werden, zu der Warteschlangen-ACL, um sicherzustellen, dass ein Dienst aus der Warteschlange lesen kann.</span><span class="sxs-lookup"><span data-stu-id="e8686-262">**A:** Network service read access must be added to the queue ACL to ensure that a network service can read from the queue.</span></span>  
  
 <span data-ttu-id="e8686-263">**Q:** Kann ich den MSMQ-Aktivierungsdienst verwenden, um Anwendungen, die basierend auf Nachrichten in einer Warteschlange auf einem Remotecomputer zu aktivieren?</span><span class="sxs-lookup"><span data-stu-id="e8686-263">**Q:** Can I use the MSMQ activation service to activate applications based on messages in a queue on a remote machine?</span></span>  
  
 <span data-ttu-id="e8686-264">**Antwort:** Ja.</span><span class="sxs-lookup"><span data-stu-id="e8686-264">**A:** Yes.</span></span> <span data-ttu-id="e8686-265">Sie müssen dazu den MSMQ-Aktivierungsdienst als Netzwerkdienst konfigurieren und der Warteschlange auf dem Remotecomputer den Netzwerkdienstzugriff hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="e8686-265">To do this, you must configure the MSMQ activation service to run as a network service, and add network service access to the queue on the remote machine.</span></span>  
  
## <a name="using-custom-msmq-bindings-with-receivecontext-enabled"></a><span data-ttu-id="e8686-266">Verwenden von benutzerdefinierten MSMQ-Bindungen mit aktiviertem ReceiveContext</span><span class="sxs-lookup"><span data-stu-id="e8686-266">Using Custom MSMQ Bindings with ReceiveContext Enabled</span></span>  
 <span data-ttu-id="e8686-267">Bei Verwendung einer benutzerdefinierten MSMQ-Bindung mit aktiviertem <xref:System.ServiceModel.Channels.ReceiveContext> wird eine eingehende Nachricht mit einem Thread aus einem Threadpool verarbeitet, da das systemeigene MSMQ keine E/A-Vervollständigung für den asynchronen <xref:System.ServiceModel.Channels.ReceiveContext>-Empfang unterstützt.</span><span class="sxs-lookup"><span data-stu-id="e8686-267">When using a custom MSMQ binding with <xref:System.ServiceModel.Channels.ReceiveContext> enabled processing an incoming message will use a thread pool thread because native MSMQ does not support I/O completion for asynchronous <xref:System.ServiceModel.Channels.ReceiveContext> receives.</span></span> <span data-ttu-id="e8686-268">Dies liegt daran, dass bei der Verarbeitung einer solchen Nachricht interne Transaktionen für <xref:System.ServiceModel.Channels.ReceiveContext> verwendet werden und MSMQ keine asynchrone Verarbeitung unterstützt.</span><span class="sxs-lookup"><span data-stu-id="e8686-268">This is because processing such a message uses internal transactions for <xref:System.ServiceModel.Channels.ReceiveContext> and MSMQ does not support asynchronous processing.</span></span> <span data-ttu-id="e8686-269">Um dieses Problem zu umgehen, können Sie dem Endpunkt ein <xref:System.ServiceModel.Description.SynchronousReceiveBehavior> hinzufügen, um die asynchrone Verarbeitung zu erzwingen, oder Sie können <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.MaxPendingReceives%2A> auf 1 festlegen.</span><span class="sxs-lookup"><span data-stu-id="e8686-269">To work around this issue you can add a <xref:System.ServiceModel.Description.SynchronousReceiveBehavior> to the endpoint to force synchronous processing or set <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.MaxPendingReceives%2A> to 1.</span></span>
