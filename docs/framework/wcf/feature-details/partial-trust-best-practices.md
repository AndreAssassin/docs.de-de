---
title: Empfehlungen für eine teilweise vertrauenswürdige Umgebung
ms.date: 03/30/2017
ms.assetid: 0d052bc0-5b98-4c50-8bb5-270cc8a8b145
ms.openlocfilehash: 6c01824ef3d86600fd946e7f510b854b5138ec00
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "64603884"
---
# <a name="partial-trust-best-practices"></a><span data-ttu-id="b203a-102">Empfehlungen für eine teilweise vertrauenswürdige Umgebung</span><span class="sxs-lookup"><span data-stu-id="b203a-102">Partial Trust Best Practices</span></span>
<span data-ttu-id="b203a-103">Dieses Thema beschreibt bewährte Methoden bei der Ausführung von Windows Communication Foundation (WCF) in einer teilweise vertrauenswürdigen Umgebung.</span><span class="sxs-lookup"><span data-stu-id="b203a-103">This topic describes best practices when running Windows Communication Foundation (WCF) in a partial trust environment.</span></span>  
  
## <a name="serialization"></a><span data-ttu-id="b203a-104">Serialisierung</span><span class="sxs-lookup"><span data-stu-id="b203a-104">Serialization</span></span>  
 <span data-ttu-id="b203a-105">Gehen Sie wie nachfolgend beschrieben vor, wenn Sie den <xref:System.Runtime.Serialization.DataContractSerializer> in einer teilweise vertrauenswürdigen Anwendung verwenden.</span><span class="sxs-lookup"><span data-stu-id="b203a-105">Apply the following practices when using the <xref:System.Runtime.Serialization.DataContractSerializer> in a partially-trusted application.</span></span>  
  
- <span data-ttu-id="b203a-106">Alle serialisierbaren Typen müssen explizit mit dem `[DataContract]`-Attribut gekennzeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="b203a-106">All serializable types must be explicitly marked with the `[DataContract]` attribute.</span></span> <span data-ttu-id="b203a-107">Die folgenden Techniken werden in einer teilweise vertrauenswürdigen Umgebung nicht unterstützt:</span><span class="sxs-lookup"><span data-stu-id="b203a-107">The following techniques are not supported in a partial trust environment:</span></span>  
  
- <span data-ttu-id="b203a-108">Das Markieren von Klassen, die serialisiert werden sollen, mit <xref:System.SerializableAttribute></span><span class="sxs-lookup"><span data-stu-id="b203a-108">Marking classes to be serialized with the <xref:System.SerializableAttribute>.</span></span>  
  
- <span data-ttu-id="b203a-109">Das Implementieren der <xref:System.Runtime.Serialization.ISerializable>-Schnittstelle, damit eine Klasse ihren Serialisierungsprozess steuern kann</span><span class="sxs-lookup"><span data-stu-id="b203a-109">Implementing the <xref:System.Runtime.Serialization.ISerializable> interface to allow a class to control its serialization process.</span></span>  
  
### <a name="using-datacontractserializer"></a><span data-ttu-id="b203a-110">Verwenden von DataContractSerializer</span><span class="sxs-lookup"><span data-stu-id="b203a-110">Using DataContractSerializer</span></span>  
  
- <span data-ttu-id="b203a-111">Alle mit dem `[DataContract]`-Attribut gekennzeichneten Typen müssen öffentlich sein.</span><span class="sxs-lookup"><span data-stu-id="b203a-111">All types marked with the `[DataContract]` attribute must be public.</span></span> <span data-ttu-id="b203a-112">Nicht öffentliche Typen können in einer teilweise vertrauenswürdigen Umgebung nicht serialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="b203a-112">Non-public types cannot be serialized in a partial trust environment.</span></span>  
  
- <span data-ttu-id="b203a-113">Alle `[DataContract]`-Member in einem serialisierbaren `[DataContract]`-Typ müssen öffentlich sein.</span><span class="sxs-lookup"><span data-stu-id="b203a-113">All `[DataContract]` members in a serializable `[DataContract]` type must be public.</span></span> <span data-ttu-id="b203a-114">Ein Typ mit einem nicht öffentlichen `[DataMember]` kann in einer teilweise vertrauenswürdigen Umgebung nicht serialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="b203a-114">A type with a non-public `[DataMember]` cannot be serialized in a partial trust environment.</span></span>  
  
- <span data-ttu-id="b203a-115">Methoden, die Serialisierungsereignisse verarbeiten (z.&amp;#160;B. `OnSerializing`, `OnSerialized`, `OnDeserializing` und `OnDeserialized`), müssen als öffentlich deklariert werden.</span><span class="sxs-lookup"><span data-stu-id="b203a-115">Methods that handle serialization events (such as `OnSerializing`, `OnSerialized`, `OnDeserializing`, and `OnDeserialized`) must be declared as public.</span></span> <span data-ttu-id="b203a-116">Jedoch werden sowohl explizite als auch implizite Implementierungen von <xref:System.Runtime.Serialization.IDeserializationCallback.OnDeserialization%28System.Object%29> unterstützt.</span><span class="sxs-lookup"><span data-stu-id="b203a-116">However, both explicit and implicit implementations of <xref:System.Runtime.Serialization.IDeserializationCallback.OnDeserialization%28System.Object%29> are supported.</span></span>  
  
- <span data-ttu-id="b203a-117">`[DataContract]`-Typen, die in Assemblys implementiert und mit <xref:System.Security.AllowPartiallyTrustedCallersAttribute> gekennzeichnet sind, dürfen keine sicherheitsbezogenen Aktionen im Typenkonstruktor ausführen, da der <xref:System.Runtime.Serialization.DataContractSerializer> den Konstruktor des neu instanziierten Objekts während der Deserialisierung aufruft.</span><span class="sxs-lookup"><span data-stu-id="b203a-117">`[DataContract]` types implemented in assemblies marked with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> must not perform security-related actions in the type constructor, as the <xref:System.Runtime.Serialization.DataContractSerializer> does not call the constructor of the newly-instantiated object during deserialization.</span></span> <span data-ttu-id="b203a-118">Die folgenden allgemeinen Sicherheitstechniken müssen für `[DataContract]`-Typen vermieden werden:</span><span class="sxs-lookup"><span data-stu-id="b203a-118">Specifically, the following common security techniques must be avoided for `[DataContract]` types:</span></span>  
  
- <span data-ttu-id="b203a-119">Der Versuch, den teilweise vertrauenswürdigen Zugriff durch Definieren des Konstruktors für den Typ als intern oder privat zu beschränken</span><span class="sxs-lookup"><span data-stu-id="b203a-119">Attempting to restrict partial trust access by making the type's constructor internal or private.</span></span>  
  
- <span data-ttu-id="b203a-120">Einschränken des Zugriffs auf den Typ durch Hinzufügen von `[LinkDemand]` zum Konstruktor des Typs</span><span class="sxs-lookup"><span data-stu-id="b203a-120">Restricting access to the type by adding a `[LinkDemand]` to the type's constructor.</span></span>  
  
- <span data-ttu-id="b203a-121">Da das Objekt erfolgreich instanziiert wurde, wird davon ausgegangen, dass eventuelle vom Konstruktor erzwungene Validierungsprüfungen erfolgreich bestanden wurden.</span><span class="sxs-lookup"><span data-stu-id="b203a-121">Assuming that because the object has been successfully instantiated, any validation checks enforced by the constructor have passed successfully.</span></span>  
  
### <a name="using-ixmlserializable"></a><span data-ttu-id="b203a-122">Verwenden von IXmlSerializable</span><span class="sxs-lookup"><span data-stu-id="b203a-122">Using IXmlSerializable</span></span>  
 <span data-ttu-id="b203a-123">Die folgenden empfohlenen Vorgehensweisen gelten für Typen, die <xref:System.Xml.Serialization.IXmlSerializable> implementieren und mit <xref:System.Runtime.Serialization.DataContractSerializer> serialisiert werden:</span><span class="sxs-lookup"><span data-stu-id="b203a-123">The following best practices apply for types that implement <xref:System.Xml.Serialization.IXmlSerializable> and are serialized using the <xref:System.Runtime.Serialization.DataContractSerializer>:</span></span>  
  
- <span data-ttu-id="b203a-124">Die statischen <xref:System.Xml.Serialization.IXmlSerializable.GetSchema%2A>-Methodenimplementierungen müssen `public` sein.</span><span class="sxs-lookup"><span data-stu-id="b203a-124">The <xref:System.Xml.Serialization.IXmlSerializable.GetSchema%2A> static method implementations must be `public`.</span></span>  
  
- <span data-ttu-id="b203a-125">Die Instanzmethoden, die die <xref:System.Xml.Serialization.IXmlSerializable>-Schnittstelle implementieren, müssen `public` sein.</span><span class="sxs-lookup"><span data-stu-id="b203a-125">The instance methods that implement the <xref:System.Xml.Serialization.IXmlSerializable> interface must be `public`.</span></span>  
  
## <a name="using-wcf-from-fully-trusted-platform-code-that-allows-calls-from-partially-trusted-callers"></a><span data-ttu-id="b203a-126">Verwenden von WCF aus vollständig vertrauenswürdigem Plattformcode, der Aufrufe teilweise vertrauenswürdiger Aufrufer zulässt</span><span class="sxs-lookup"><span data-stu-id="b203a-126">Using WCF from Fully-Trusted Platform Code that Allows Calls from Partially Trusted Callers</span></span>  
 <span data-ttu-id="b203a-127">Das Sicherheitsmodell der WCF-teilweiser Vertrauenswürdigkeit wird davon ausgegangen, dass jeder Aufrufer einer öffentlichen WCF-Methode oder Eigenschaft im Kontext Code Access Security (CAS) der hostanwendung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="b203a-127">The WCF partial trust security model assumes that any caller of a WCF public method or property is running in the code access security (CAS) context of the hosting application.</span></span> <span data-ttu-id="b203a-128">WCF auch geht davon aus, nur ein anwendungssicherheitskontext für jede vorhanden <xref:System.AppDomain>, und die diesem Kontext wird an <xref:System.AppDomain> Zeitpunkt der Erstellung von einem vertrauenswürdigen Host (z. B. durch einen Aufruf von <xref:System.AppDomain.CreateDomain%2A> oder durch des ASP.NET-Anwendungs-Managers).).</span><span class="sxs-lookup"><span data-stu-id="b203a-128">WCF also assumes that only one application security context exists for each <xref:System.AppDomain>, and that this context is established at <xref:System.AppDomain> creation time by a trusted host (for example, by a call to <xref:System.AppDomain.CreateDomain%2A> or by the ASP.NET Application Manager).</span></span>  
  
 <span data-ttu-id="b203a-129">Dieses Sicherheitsmodell gilt für Anwendungen, die vom Benutzer verfasst wurden und keine zusätzlichen CAS-Berechtigungen gewähren können, wie z.&amp;#160;B. Benutzercode, der in einer ASP.NET-Anwendung mittlerer Vertrauenswürdigkeit ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="b203a-129">This security model applies to user-written applications that cannot assert additional CAS permissions, such as user code running in a Medium Trust ASP.NET application.</span></span> <span data-ttu-id="b203a-130">Vollständig vertrauenswürdigem Plattformcode (beispielsweise eine Drittanbieter-Assembly, die im globalen Assemblycache installiert ist und akzeptiert Aufrufe von teilweise vertrauenswürdigem Code) muss jedoch explizit Sorgfalt walten lassen beim Aufrufen von in WCF im Auftrag einer teilweise vertrauenswürdigen Anwendung Vermeiden Sie das Einführen von Sicherheitsrisiken auf Anwendungsebene.</span><span class="sxs-lookup"><span data-stu-id="b203a-130">However, fully-trusted platform code (for example, a third-party assembly that is installed in the global assembly cache and accepts calls from partially-trusted code) must take explicit care when calling into WCF on behalf of a partially-trusted application to avoid introducing application-level security vulnerabilities.</span></span>  
  
 <span data-ttu-id="b203a-131">Voll vertrauenswürdigem Code vermeiden, ändern den CAS-Berechtigungssatz, der den aktuellen Thread (durch Aufrufen von <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A>, oder <xref:System.Security.PermissionSet.Deny%2A>) vor dem Aufrufen von WCF-APIs im Namen von teilweise vertrauenswürdigem Code.</span><span class="sxs-lookup"><span data-stu-id="b203a-131">Full-trust code should avoid altering the CAS permission set of the current thread (by calling <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A>, or <xref:System.Security.PermissionSet.Deny%2A>) prior to calling WCF APIs on behalf of partially-trusted code.</span></span> <span data-ttu-id="b203a-132">Das Gewähren, Abweisen oder anderweitige Erstellen von threadspezifischem Berechtigungskontext, der unabhängig vom Sicherheitskontext der Anwendungsebene ist, kann zu unerwartetem Verhalten führen.</span><span class="sxs-lookup"><span data-stu-id="b203a-132">Asserting, denying, or otherwise creating a thread-specific permission context that is independent of the application-level security context can result in unexpected behavior.</span></span> <span data-ttu-id="b203a-133">Je nach Anwendung kann dieses Verhalten zu Sicherheitslücken auf Anwendungsebene führen.</span><span class="sxs-lookup"><span data-stu-id="b203a-133">Depending on the application, this behavior may result in application-level security vulnerabilities.</span></span>  
  
 <span data-ttu-id="b203a-134">Code, der Aufrufe in WCF über eine threadspezifischer Berechtigungskontext darauf vorbereitet sein müssen, um den folgenden Situationen zu behandeln, die auftreten können:</span><span class="sxs-lookup"><span data-stu-id="b203a-134">Code that calls into WCF using a thread-specific permission context must be prepared to handle the following situations that may arise:</span></span>  
  
- <span data-ttu-id="b203a-135">Der threadspezifische Sicherheitskontext kann möglicherweise nicht für die Dauer des Vorgangs aufrechterhalten werden, was zu potenziellen Sicherheitsausnahmen führt.</span><span class="sxs-lookup"><span data-stu-id="b203a-135">The thread-specific security context may not be maintained for the duration of the operation, which results in potential security exceptions.</span></span>  
  
- <span data-ttu-id="b203a-136">Interne WCF-Code als auch für alle Benutzer bereitgestellte Rückrufe können in einem anderen Sicherheitskontext als dem Ausführen unter denen der Aufruf ursprünglich initiiert wurde.</span><span class="sxs-lookup"><span data-stu-id="b203a-136">Internal WCF code as well as any user-provided callbacks may run in a different security context than the one under which the call was originally initiated.</span></span> <span data-ttu-id="b203a-137">Zu diesen Kontexten gehören:</span><span class="sxs-lookup"><span data-stu-id="b203a-137">These contexts include:</span></span>  
  
    - <span data-ttu-id="b203a-138">Der Berechtigungskontext der Anwendung</span><span class="sxs-lookup"><span data-stu-id="b203a-138">The application permission context.</span></span>  
  
    - <span data-ttu-id="b203a-139">Alle threadspezifischer Berechtigungskontext, der zuvor erstellt haben, von anderen Benutzerthreads verwendet, um in WCF während der Lebensdauer der aktuell ausführenden aufzurufen <xref:System.AppDomain>.</span><span class="sxs-lookup"><span data-stu-id="b203a-139">Any thread-specific permission context previously created by other user threads used to call into WCF during the lifetime of the currently running <xref:System.AppDomain>.</span></span>  
  
 <span data-ttu-id="b203a-140">WCF wird sichergestellt, dass teilweise vertrauenswürdiger Code voll vertrauenswürdige Berechtigungen abrufen kann, es sei denn, diese Berechtigungen von einer voll vertrauenswürdigen Komponente vor dem Aufruf der öffentlichen WCF-APIs übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="b203a-140">WCF guarantees that partially-trusted code cannot obtain full-trust permissions unless such permissions are asserted by a fully-trusted component prior to calling into WCF public APIs.</span></span> <span data-ttu-id="b203a-141">Jedoch besteht dabei nicht die Garantie, dass die Gewährung voller Vertrauenswürdigkeit auf einen bestimmten Thread, Vorgang oder eine bestimmte Benutzeraktion beschränkt ist.</span><span class="sxs-lookup"><span data-stu-id="b203a-141">However, it does not guarantee that the effects of asserting full trust is isolated to a particular thread, operation, or user action.</span></span>  
  
 <span data-ttu-id="b203a-142">Es empfiehlt sich daher, die Erstellung von threadspezifischem Berechtigungskontext durch Aufrufen von <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A> oder <xref:System.Security.PermissionSet.Deny%2A> zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="b203a-142">As a best practice, avoid creating thread-specific permission context by calling <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A>, or <xref:System.Security.PermissionSet.Deny%2A>.</span></span> <span data-ttu-id="b203a-143">Gewähren oder verweigern Sie stattdessen der Anwendung selbst die Berechtigung, damit <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.Deny%2A> oder <xref:System.Security.PermissionSet.PermitOnly%2A> nicht erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="b203a-143">Instead, grant or deny the privilege to the application itself, so that no <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.Deny%2A>, or <xref:System.Security.PermissionSet.PermitOnly%2A> is required.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b203a-144">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="b203a-144">See also</span></span>

- <xref:System.Runtime.Serialization.DataContractSerializer>
- <xref:System.Xml.Serialization.IXmlSerializable>
