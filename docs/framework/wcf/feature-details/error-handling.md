---
title: Fehlerbehandlung
ms.date: 03/30/2017
ms.assetid: c948841a-7db9-40ae-9b78-587d216cbcaf
ms.openlocfilehash: 34f4f11176b3827ec3e4622944ffe02be5207df9
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/18/2019
ms.locfileid: "59300280"
---
# <a name="error-handling"></a><span data-ttu-id="01e6f-102">Fehlerbehandlung</span><span class="sxs-lookup"><span data-stu-id="01e6f-102">Error handling</span></span>
## <a name="error-handling-in-windows-communication-foundation"></a><span data-ttu-id="01e6f-103">Fehlerbehandlung in Windows Communication Foundation</span><span class="sxs-lookup"><span data-stu-id="01e6f-103">Error Handling in Windows Communication Foundation</span></span>  
 <span data-ttu-id="01e6f-104">Wenn in einem Dienst eine unerwartete Ausnahme oder ein unerwarteter Fehler auftritt, gibt es mehrere Möglichkeiten zum Entwerfen einer Lösung für die Ausnahmebehandlung.</span><span class="sxs-lookup"><span data-stu-id="01e6f-104">When a service encounters an unexpected exception or error, there are multiple ways to design an exception-handling solution.</span></span> <span data-ttu-id="01e6f-105">Es gibt zwar keine einzelnen "richtig" oder "best Practices" für die Fehlerbehandlung Lösung, es gibt mehrere Möglichkeiten zu berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="01e6f-105">While there is no single "correct" or "best practice" error-handling solution, there are multiple valid paths for one to consider.</span></span> <span data-ttu-id="01e6f-106">Wird normalerweise empfohlen, eine eine Hybrid-Lösung implementieren, die mehrere Ansätze aus der Liste unten, abhängig von der Komplexität der WCF-Implementierung, Typ und Häufigkeit der Ausnahmen, die behandelten im Vergleich zu nicht behandelten Natur von kombiniert die Ausnahmen, und die Ihnen zugeordneten Ablaufverfolgung, Protokollierung und richtlinienanforderungen.</span><span class="sxs-lookup"><span data-stu-id="01e6f-106">It is normally recommended that one implement a hybrid solution that combines multiple approaches from the list below, depending on the complexity of the WCF implementation, the type and frequency of the exceptions, the handled vs. unhandled nature of the exceptions, and any associated tracing, logging, or policy requirements.</span></span>  
  
 <span data-ttu-id="01e6f-107">Diese Lösungen werden im restlichen Teil dieses Abschnitts genauer erläutert.</span><span class="sxs-lookup"><span data-stu-id="01e6f-107">These solutions are explained more deeply in the rest of this section.</span></span>  
  
### <a name="the-microsoft-enterprise-library"></a><span data-ttu-id="01e6f-108">Die Microsoft Enterprise Library</span><span class="sxs-lookup"><span data-stu-id="01e6f-108">The Microsoft Enterprise Library</span></span>  
 <span data-ttu-id="01e6f-109">Der Ausnahmebehandlungs-Anwendungsblock der Microsoft Enterprise Library erleichtert das Implementieren häufiger Entwurfsmuster und das Erstellen einer einheitlichen Strategie für die Verarbeitung von Ausnahmen, die auf allen Architekturebenen einer Unternehmensanwendung auftreten.</span><span class="sxs-lookup"><span data-stu-id="01e6f-109">The Microsoft Enterprise Library Exception Handling Application Block helps implement common design patterns and create a consistent strategy for processing exceptions that occur in all architectural layers of an enterprise application.</span></span> <span data-ttu-id="01e6f-110">Er unterstützt den typischen Code in den Catch-Anweisungen von Anwendungskomponenten.</span><span class="sxs-lookup"><span data-stu-id="01e6f-110">It is designed to support the typical code contained in catch statements in application components.</span></span> <span data-ttu-id="01e6f-111">Statt diesen Code (z. B. Code zum Protokollieren von Ausnahmeinformationen) in der gesamten Anwendung in identischen Catch-Blöcken zu wiederholen, ermöglicht der Ausnahmebehandlungs-Anwendungsblock Entwicklern das Kapseln dieser Logik als wiederverwendbare Ausnahmehandler.</span><span class="sxs-lookup"><span data-stu-id="01e6f-111">Instead of repeating this code (such as code that logs exception information) in identical catch blocks throughout an application, the Exception Handling Application Block allows developers to encapsulate this logic as reusable exception handlers.</span></span>  
  
 <span data-ttu-id="01e6f-112">Diese Bibliothek enthält standardmäßig einen Fehlervertragsausnahmehandler.</span><span class="sxs-lookup"><span data-stu-id="01e6f-112">This Library includes out-of-the-box a Fault Contract Exception Handler.</span></span> <span data-ttu-id="01e6f-113">Dieser Ausnahmehandler ist für die Verwendung an den Grenzen des WCF (Windows® Communication Foundation)-Diensts vorgesehen, und er generiert aus der Ausnahme einen neuen Fehlervertrag.</span><span class="sxs-lookup"><span data-stu-id="01e6f-113">This exception handler is designed for use at Windows® Communication Foundation (WCF) service boundaries, and generates a new Fault Contract from the exception.</span></span>  
  
 <span data-ttu-id="01e6f-114">Anwendungsblöcke enthalten in der Regel häufig verwendete bewährte Methoden und bieten eine allgemeine Vorgehensweise für die Ausnahmebehandlung in der gesamten Anwendung.</span><span class="sxs-lookup"><span data-stu-id="01e6f-114">Application blocks aim to incorporate commonly used best practices and provide a common approach for exception handling throughout your application.</span></span> <span data-ttu-id="01e6f-115">Jedoch können benutzerdefinierte Fehlerhandler und Fehlerverträge, die selbst entwickelt wurden, ebenfalls sehr hilfreich sein.</span><span class="sxs-lookup"><span data-stu-id="01e6f-115">On the other hand, custom error handlers and fault contracts developed on one’s own can also be very useful.</span></span> <span data-ttu-id="01e6f-116">Beispielsweise bieten Benutzerdefinierte Fehlerhandler eine ausgezeichnete Gelegenheit, automatisch alle Ausnahmen FaultExceptions höher stufen und Hinzufügen von Protokollierfunktionen zu Ihrer Anwendung.</span><span class="sxs-lookup"><span data-stu-id="01e6f-116">For instance, custom error handlers provide an excellent opportunity to automatically promote all exceptions to FaultExceptions and also to add logging capabilities to your application.</span></span>  
  
 <span data-ttu-id="01e6f-117">Weitere Informationen finden Sie unter [Microsoft Enterprise Library](https://docs.microsoft.com/previous-versions/msp-n-p/ff632023(v=pandp.10)).</span><span class="sxs-lookup"><span data-stu-id="01e6f-117">For more information, please see [Microsoft Enterprise Library](https://docs.microsoft.com/previous-versions/msp-n-p/ff632023(v=pandp.10)).</span></span>  
  
### <a name="dealing-with-expected-exceptions"></a><span data-ttu-id="01e6f-118">Behandeln von erwarteten Ausnahmen</span><span class="sxs-lookup"><span data-stu-id="01e6f-118">Dealing with Expected Exceptions</span></span>  
 <span data-ttu-id="01e6f-119">Die korrekte Vorgehensweise ist Abfangen erwarteter Ausnahmen in jedem Vorgang oder die relevanten Erweiterungspunkt, entscheiden Sie, ob sie aus wiederhergestellt werden können, und geben Sie den ordnungsgemäßen benutzerdefinierten Fehler in einer FaultException zurück\<T ></span><span class="sxs-lookup"><span data-stu-id="01e6f-119">The proper course of action is to catch expected exceptions in every operation or relevant extensibility point, decide whether they can be recovered from, and return the proper custom fault in a FaultException\<T></span></span>  
  
### <a name="dealing-with-unexpected-exceptions-using-an-ierrorhandler"></a><span data-ttu-id="01e6f-120">Behandeln von unerwarteten Ausnahmen mit einem IErrorHandler</span><span class="sxs-lookup"><span data-stu-id="01e6f-120">Dealing with Unexpected Exceptions using an IErrorHandler</span></span>  
 <span data-ttu-id="01e6f-121">Um unerwartete Ausnahmen zu beheben, ist die empfohlene Vorgehensweise "Einen" ierrorhandler "verknüpfen" aus.</span><span class="sxs-lookup"><span data-stu-id="01e6f-121">To deal with unexpected exceptions, the recommended course of action is to "hook" an IErrorHandler.</span></span> <span data-ttu-id="01e6f-122">Fehlerhandler fangen nur Ausnahmen, die WCF-Laufzeitebene (der "" dienstmodellebene), nicht auf Kanalebene.</span><span class="sxs-lookup"><span data-stu-id="01e6f-122">Error handlers only catch exceptions at the WCF runtime level (the "service model" layer), not at the channel layer.</span></span> <span data-ttu-id="01e6f-123">Die einzige Möglichkeit, einen IErrorHandler auf Kanalebene zu verknüpfen, ist das Erstellen eines benutzerdefinierten Kanals, und dies wird in den meisten Szenarien nicht empfohlen.</span><span class="sxs-lookup"><span data-stu-id="01e6f-123">The only way to hook an IErrorHandler at the channel level is to create a custom channel, which is not recommended in most scenarios.</span></span>  
  
 <span data-ttu-id="01e6f-124">Eine "unerwartete"Ausnahme ist im Allgemeinen weder eine nicht behebbare Ausnahme noch eine Verarbeitungsausnahme; Es ist, stattdessen eine unerwartete Benutzerausnahme.</span><span class="sxs-lookup"><span data-stu-id="01e6f-124">An "unexpected exception" is generally neither an irrecoverable exception nor a processing exception; it is, instead, an unexpected user exception.</span></span> <span data-ttu-id="01e6f-125">Eine nicht behebbare Ausnahme (z. B. eine Out-of-Memory-Ausnahme) – eine in der Regel anhand der [Dienstmodell-Ausnahmehandler](xref:System.ServiceModel.Dispatcher.ExceptionHandler) automatisch kann nicht in der Regel nicht erfolgreich behandelt werden, und der einzige Grund, eine Ausnahme zu behandeln Alle möglicherweise zusätzliche Protokollierung oder eine Standardausnahme an den Client zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="01e6f-125">An irrecoverable exception (such as an out-of-memory exception) – one generally handled by the [Service Model Exception Handler](xref:System.ServiceModel.Dispatcher.ExceptionHandler) automatically – cannot generally be handled gracefully, and the only reason to handle such an exception at all may be do additional logging or to return a standard exception to the client.</span></span> <span data-ttu-id="01e6f-126">Eine Verarbeitungsausnahme tritt meist beim Verarbeiten der Nachricht auf, beispielsweise auf Serialisierungs-, Encoder- oder Formatiererebene, und kann im Allgemeinen nicht von einem "IErrorHandler" behandelt werden, weil die Fehlerbehandlung noch nicht oder nicht mehr eingreifen kann, wenn diese Ausnahmen auftreten.</span><span class="sxs-lookup"><span data-stu-id="01e6f-126">A processing exception occurs in the processing of the message – for example, at the serialization, encoder, or formatter level – generally cannot be handled at an IErrorHandler, because it is generally either too early or too late for the error handler to intervene by the time these exceptions occur.</span></span> <span data-ttu-id="01e6f-127">Ebenso können Transportausnahmen nicht von einem IErrorHandler behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="01e6f-127">Similarly, transport exceptions cannot be handled at an IErrorHandler.</span></span>  
  
 <span data-ttu-id="01e6f-128">Mit einem IErrorHandler können Sie das Verhalten der Anwendung explizit steuern, wenn eine Ausnahme ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="01e6f-128">With an IErrorHandler, you can explicitly control the behavior of your application when an exception is thrown.</span></span> <span data-ttu-id="01e6f-129">Sie haben folgende Möglichkeiten:</span><span class="sxs-lookup"><span data-stu-id="01e6f-129">You may:</span></span>  
  
1. <span data-ttu-id="01e6f-130">Entscheiden, ob ein Fehler an den Client gesendet wird</span><span class="sxs-lookup"><span data-stu-id="01e6f-130">Decide whether or not to send a fault to the client</span></span>  
  
2. <span data-ttu-id="01e6f-131">Ersetzen einer Ausnahme durch einen Fehler</span><span class="sxs-lookup"><span data-stu-id="01e6f-131">Replace an exception with a fault</span></span>  
  
3. <span data-ttu-id="01e6f-132">Ersetzen eines Fehlers durch einen anderen Fehler</span><span class="sxs-lookup"><span data-stu-id="01e6f-132">Replace a fault with another fault</span></span>  
  
4. <span data-ttu-id="01e6f-133">Ausführen von Protokollierung oder Ablaufverfolgung</span><span class="sxs-lookup"><span data-stu-id="01e6f-133">Perform logging or tracing</span></span>  
  
5. <span data-ttu-id="01e6f-134">Ausführen von anderen benutzerdefinierten Aktivitäten</span><span class="sxs-lookup"><span data-stu-id="01e6f-134">Perform other custom activities</span></span>  
  
 <span data-ttu-id="01e6f-135">Sie können einen benutzerdefinierten Fehlerhandler installieren, indem Sie ihn der ErrorHandlers-Eigenschaft der Kanalverteiler für den Dienst hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="01e6f-135">One can install a custom error handler by adding it to the ErrorHandlers property of the channel dispatchers for your service.</span></span>  <span data-ttu-id="01e6f-136">Es ist zulässig, mehrere Fehlerhandler zu verwenden. Sie werden in der Reihenfolge aufgerufen, in der sie der Auflistung hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="01e6f-136">It is possible to have more than one error handler and they are called in the order they are added to this collection.</span></span>  
  
 <span data-ttu-id="01e6f-137">IErrorHandler.ProvideFault steuert die Fehlermeldung, die an den Client gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="01e6f-137">IErrorHandler.ProvideFault controls the fault message that is sent to the client.</span></span> <span data-ttu-id="01e6f-138">Diese Methode wird unabhängig vom Typ der Ausnahme aufgerufen, die durch einen Vorgang im Dienst ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="01e6f-138">This method is called regardless of the type of the exception thrown by an operation in your service.</span></span> <span data-ttu-id="01e6f-139">Wenn hier kein Vorgang ausgeführt wird, wird WCF mit dem Standardverhalten fortgesetzt und auf die gleiche Weise wie ohne benutzerdefinierte Fehlerhandler ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="01e6f-139">If no operation is performed here, WCF assumes its default behaviour and continues as if there were no custom error handlers in place.</span></span>  
  
 <span data-ttu-id="01e6f-140">Sie können diese Herangehensweise beispielsweise verwenden, wenn Ausnahmen an einer zentralen Stelle in Fehler umgewandelt werden sollen, bevor sie an den Client gesendet werden (um sicherzustellen, dass die Instanz nicht verworfen wird und der Kanal nicht in den Faulted-Zustand wechselt).</span><span class="sxs-lookup"><span data-stu-id="01e6f-140">One area that you could perhaps use this approach is when you want to create a central place for converting exceptions to faults before they are sent to the client (ensuring that the instance is not disposed and the channel is not moved to the Faulted state).</span></span>  
  
 <span data-ttu-id="01e6f-141">Die "IErrorHandler.HandleError"-Methode wird in der Regel verwendet, um Verhalten für Fehler zu implementieren, z. B. Fehlerprotokollierung, Systembenachrichtigungen, Beenden der Anwendung usw. "IErrorHandler.HandleError" kann an mehreren Stellen im Dienst aufgerufen werden. Je nachdem, wo der Fehler ausgelöst wird, erfolgt der Aufruf der "HandleError"-Methode vom selben Thread wie der Vorgang oder auch nicht. Dies lässt sich nicht eindeutig festlegen.</span><span class="sxs-lookup"><span data-stu-id="01e6f-141">The IErrorHandler.HandleError method is usually used to implement error-related behaviors such as error logging, system notifications, shutting down the application, etc. IErrorHandler.HandleError can be called at multiple places inside the service, and depending on where the error is thrown, the HandleError method may or may not be called by the same thread as the operation; no guarantees are made in this regard.</span></span>  
  
### <a name="dealing-with-exceptions-outside-wcf"></a><span data-ttu-id="01e6f-142">Behandeln von Ausnahmen außerhalb von WCF</span><span class="sxs-lookup"><span data-stu-id="01e6f-142">Dealing with Exceptions outside WCF</span></span>  
 <span data-ttu-id="01e6f-143">Häufig treten Konfigurationsausnahmen, Ausnahmen im Hinblick auf Datenbankverbindungszeichenfolgen und ähnliche Ausnahmen im Kontext einer WCF-Anwendung auf, ohne vom Dienstmodell oder vom Webdienst selbst verursacht worden zu sein.</span><span class="sxs-lookup"><span data-stu-id="01e6f-143">Often, configuration exceptions, database connection string exceptions, and other similar exceptions may occur within the context of a WCF application, but are themselves are not exceptions caused by the service model or the web service itself.</span></span> <span data-ttu-id="01e6f-144">Diese Ausnahmen sind "regular" Ausnahmen außerhalb des Webdiensts und behandelt werden sollen, ebenso wie andere externen Ausnahmen in der Umgebung behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="01e6f-144">These exceptions are "regular" exceptions external to the web service, and should be handled just as other external exceptions in the environment are to be handled.</span></span>  
  
### <a name="tracing-exceptions"></a><span data-ttu-id="01e6f-145">Ablaufverfolgung von Ausnahmen</span><span class="sxs-lookup"><span data-stu-id="01e6f-145">Tracing exceptions</span></span>  
 <span data-ttu-id="01e6f-146">Die Ablaufverfolgung ist, die nur "Catch-All" Stelle, wo eine potenziell alle Ausnahmen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="01e6f-146">Tracing is the only "catch-all" place where one can potentially see all exceptions.</span></span> <span data-ttu-id="01e6f-147">Weitere Informationen zur Ablaufverfolgung und Protokollierung von Ausnahmen finden Sie unter "Ablaufverfolgung und Protokollierung".</span><span class="sxs-lookup"><span data-stu-id="01e6f-147">For more information on tracing and logging exceptions, see Tracing and Logging.</span></span>  
  
### <a name="uri-template-errors-when-using-webgetattribute-and-webinvokeattribute"></a><span data-ttu-id="01e6f-148">URI-Vorlagenfehler bei Verwendung von WebGetAttribute und WebInvokeAttribute</span><span class="sxs-lookup"><span data-stu-id="01e6f-148">URI template errors when using WebGetAttribute and WebInvokeAttribute</span></span>  
 <span data-ttu-id="01e6f-149">Mit dem WebGet-Attribut und dem WebInvoke-Attribut können Sie eine URI-Vorlage angeben, die Vorgangsparametern Komponenten der Anforderungsadresse zuordnet.</span><span class="sxs-lookup"><span data-stu-id="01e6f-149">The WebGet and WebInvoke attributes allow you to specify a URI template that maps components of the request address to operation parameters.</span></span> <span data-ttu-id="01e6f-150">Beispielsweise ordnet die URI-Vorlage "weather/{state}/{city}" die Anforderungsadresse als Literaltoken, als Parameter mit dem Namen state und als Parameter mit dem Namen city zu.</span><span class="sxs-lookup"><span data-stu-id="01e6f-150">For example, the URI template "weather/{state}/{city}" maps the request address into literal tokens, a parameter named state, and a parameter named city.</span></span> <span data-ttu-id="01e6f-151">Diese Parameter können dann nach Name an einige der formalen Parameter des Vorgangs gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="01e6f-151">These parameters might then be bound by name to some of the formal parameters of the operation.</span></span>  
  
 <span data-ttu-id="01e6f-152">Die Vorlagenparameter werden im URI als Zeichenfolgen angezeigt, während die formalen Parameter eines typisierten Vertrags möglicherweise nicht vom Typ String sind.</span><span class="sxs-lookup"><span data-stu-id="01e6f-152">The template parameters appear in the form of strings within the URI while the formal parameters of a typed contract might be of non-string types.</span></span> <span data-ttu-id="01e6f-153">Daher muss eine Konvertierung erfolgen, bevor der Vorgang aufgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="01e6f-153">Therefore, a conversion needs to take place before the operation can be invoked.</span></span> <span data-ttu-id="01e6f-154">Ein [Tabelle der konvertierungsformate](wcf-web-http-programming-model-overview.md) verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="01e6f-154">A [table of conversion formats](wcf-web-http-programming-model-overview.md) is available.</span></span>  
  
 <span data-ttu-id="01e6f-155">Wenn jedoch die Konvertierung fehlschlägt, gibt es keine Möglichkeit, dies dem Vorgang zu signalisieren.</span><span class="sxs-lookup"><span data-stu-id="01e6f-155">However, if the conversion fails, then there's no way to let the operation know that something has gone wrong.</span></span> <span data-ttu-id="01e6f-156">Stattdessen wird für die Typkonvertierung ein Verteilungsfehler ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="01e6f-156">The type conversion instead surfaces in the form of a dispatch failure.</span></span>  
  
 <span data-ttu-id="01e6f-157">Ein Typkonvertierungs-Verteilungsfehler kann wie viele andere Typen von Verteilungsfehlern durch das Installieren eines Fehlerhandlers überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="01e6f-157">A type conversion dispatch failure can be inspected the same as with many other types of dispatch failures by installing an error handler.</span></span> <span data-ttu-id="01e6f-158">Der IErrorHandler-Erweiterungspunkt wird aufgerufen, um auf Dienstebene aufgetretene Ausnahmen zu behandeln.</span><span class="sxs-lookup"><span data-stu-id="01e6f-158">The IErrorHandler extensibility point is called to handle service-level exceptions.</span></span> <span data-ttu-id="01e6f-159">Dort kann die an den Aufrufer zurückzusendende Antwort ausgewählt werden, und es lassen sich benutzerdefinierte Aufgaben ausführen und Berichte erstellen.</span><span class="sxs-lookup"><span data-stu-id="01e6f-159">From there, the response to be sent back to the caller – as well as perform any custom tasks and reporting – may be chosen.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="01e6f-160">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="01e6f-160">See also</span></span>

- [<span data-ttu-id="01e6f-161">Einfache WCF-Programmierung</span><span class="sxs-lookup"><span data-stu-id="01e6f-161">Basic WCF Programming</span></span>](../basic-wcf-programming.md)
