---
title: Kontrollieren des Ressourcenverbrauchs und Verbessern der Leistung
ms.date: 03/30/2017
ms.assetid: 9a829669-5f76-4c88-80ec-92d0c62c0660
ms.openlocfilehash: 11d1333ed0ae8b46f8f87fa6f4643d4b31fac3ff
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "61785059"
---
# <a name="controlling-resource-consumption-and-improving-performance"></a>Kontrollieren des Ressourcenverbrauchs und Verbessern der Leistung
Dieses Thema beschreibt die verschiedenen Eigenschaften, die in verschiedenen Bereichen der Windows Communication Foundation (WCF)-Architektur, die arbeiten, um den Ressourcenverbrauch Kontrolle und Einfluss auf die Leistungsmetriken.

## <a name="properties-that-constrain-resource-consumption-in-wcf"></a>Eigenschaften, die den Ressourcenverbrauch in WCF einschränken
 Windows Communication Foundation (WCF) gelten Einschränkungen für bestimmte Typen von Prozessen für entweder Sicherheits- oder Leistung. Diese Einschränkungen treten in zwei Hauptformen auf, jeweils als Kontingente und Drosselungen. *Kontingente* sind Beschränkungen, die beim erreicht oder überschritten eine sofortige Ausnahme an einem bestimmten Punkt im System verursachen. *Drosselt* sind Beschränkungen, die eine Ausnahme ausgelöst wird, werden nicht sofort bewirken. Stattdessen wird beim Erreichen einer Drosselungsbeschränkung der Prozess fortgesetzt, jedoch innerhalb der durch den Drosselungswert festgelegten Grenzen. Diese eingeschränkte Verarbeitung löst möglicherweise an anderer Stelle eine Ausnahme aus, dies hängt jedoch von der jeweiligen Anwendung ab.

 Zusätzlich zu der Unterscheidung zwischen Kontingenten und Drosselungen befinden sich einige einschränkende Eigenschaften auf der Serialisierungsebene, auf der Transportebene und auf der Anwendungsebene. Beispielsweise wird das Kontingent <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>, das von allen vom System bereitgestellten Transportbindungselementen implementiert wird, standardmäßig auf 65.536 Byte festgelegt, um böswillige Clients daran zu hindern, Denial-of-Service-Angriffe gegen einen bestimmten Dienst zu starten und dadurch einen überhöhten Speicherbedarf zu verursachen. (I. d. R. können Sie die Leistung erhöhen, indem Sie diesen Wert herabsetzen.)

 Ein Beispiel für ein Serialisierungskontingent ist die <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType>-Eigenschaft, die die maximale Anzahl an Objekten angibt, die das Serialisierungsprogramm in einem einzigen <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A>-Methodenaufruf serialisiert oder deserialisiert. Ein Beispiel für eine Drosselung auf Anwendungsebene ist die <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType>-Eigenschaft, die standardmäßig die Anzahl der gleichzeitigen sitzungsbasierten Kanalverbindungen auf "10" beschränkt. (Anders als bei den Kontingenten setzt die Anwendung die Verarbeitung fort, wenn dieser Drosselungswert erreicht ist, jedoch akzeptiert sie keine neuen sitzungsbasierten Kanäle, was bedeutet, dass neue Clients erst dann eine Verbindung herstellen können, wenn einer der anderen sitzungsbasierten Kanäle beendet wurde.)

 Diese Steuerelemente wurden dafür entwickelt, eine übliche Entschärfung gegen bestimmte Arten von Angriffen einzuleiten oder die Leistungsmetriken wie Speicherbeanspruchung, Startzeit usw. zu verbessern. Jedoch können diese Steuerelemente, je nach Anwendung, auch eine Beeinträchtigung der Anwendungsleistung zur Folge haben oder dazu führen, dass die Anwendung gar nicht mehr funktioniert. Zum Beispiel kann eine Anwendung, die für das Videostreaming entworfen wurde, die standardmäßige <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>-Eigenschaft leicht überschreiten. Dieses Thema enthält eine Übersicht über die verschiedenen Steuerelemente auf allen Ebenen der WCF-Anwendungen angewendet, beschreibt verschiedene Möglichkeiten, um weitere Informationen zu gibt an, ob eine Einstellung Ihre Anwendung behindert abzurufen und beschreibt, wie unterschiedliche Probleme behoben werden. Die meisten Drosselungen und einige Kontingente sind auf der Anwendungsebene verfügbar, auch wenn die Basiseigenschaft eine Serialisierungs- oder Transportbeschränkung ist. So können Sie z. B. die <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType>-Eigenschaft mithilfe der <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType>-Eigenschaft der Dienstklasse festlegen.

> [!NOTE]
> Wenn Sie ein bestimmtes Problem haben, lesen Sie zunächst die [Schnelleinstieg zur Problembehandlung in WCF](../../../docs/framework/wcf/wcf-troubleshooting-quickstart.md) um festzustellen, ob Ihr Problem (und einer Lösung) hier aufgeführt ist.

 Eigenschaften, die Serialisierungsprozesse einschränken finden Sie in [Sicherheitsüberlegungen zu Daten](../../../docs/framework/wcf/feature-details/security-considerations-for-data.md). Eigenschaften, die die Nutzung von Ressourcen, die sich auf Transporte beziehen einschränken finden Sie in [Transportkontingente](../../../docs/framework/wcf/feature-details/transport-quotas.md). Eigenschaften, die den Verbrauch von Ressourcen auf der Anwendungsschicht einschränken, gehören zur <xref:System.ServiceModel.Dispatcher.ServiceThrottle>-Klasse.

## <a name="detecting-application-and-performance-issues-related-to-quota-settings"></a>Erkennen von Anwendungs- und Leistungsproblemen in Zusammenhang mit den Kontingenteinstellungen
 Die Standardeinstellungen für die vorangehenden Werte wurden ausgewählt, um eine grundlegende Funktionalität für viele verschiedene Anwendungstypen zu ermöglichen und gleichzeitig einen Schutz vor häufig auftretenden Sicherheitsproblemen zu bieten. Jedoch überschreiten die verschiedenen Anwendungs-Designs möglicherweise eine oder mehrere Drosselungseinstellungen, obwohl die Anwendung ansonsten sicher ist und wie gewünscht funktionieren würde. In einem solchen Fall müssen Sie feststellen, welche Drosselungswerte auf welcher Ebene überschritten werden. Legen Sie anschließend angemessene Maßnahmen zur Erhöhung des Anwendungsdurchsatzes fest.

 In der Regel wird beim Schreiben und Debuggen der Anwendung die <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType>-Eigenschaft in der Konfigurationsdatei oder programmgesteuert auf `true` festgelegt. Dies weist WCF an, dienstausnahmestapelüberwachungen an die Clientanwendung für die Anzeige zurückgegeben. Diese Funktion meldet die meisten Ausnahmen auf Anwendungsebene so, dass angezeigt wird, welche Kontingenteinstellungen möglicherweise beteiligt sind, falls das Problem hierdurch verursacht wurde.

 Einige Ausnahmen treten während der Laufzeit außerhalb der Sichtbarkeit der Anwendungsschicht auf und werden nicht mithilfe dieses Mechanismus zurückgegeben. Möglicherweise werden sie auch nicht von einer benutzerdefinierten <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType>-Implementierung gehandhabt. Wenn Sie in einer Entwicklungsumgebung wie Microsoft Visual Studio arbeiten, werden die meisten dieser Ausnahmen automatisch angezeigt. Allerdings können einige Ausnahmen maskiert werden, durch Einstellungen der Entwicklungsumgebung wie z. B. [nur mein Code](/visualstudio/debugger/just-my-code) Visual Studio.

 Unabhängig von den Fähigkeiten Ihrer Entwicklungsumgebung können Sie die Funktionen von WCF-Ablaufverfolgung und nachrichtenprotokollierung verwenden, um alle Ausnahmen zu debuggen und Optimieren Sie die Leistung Ihrer Anwendungen. Weitere Informationen finden Sie unter [Problembehandlung für Ihre Anwendung eine Ablaufverfolgung mithilfe von](../../../docs/framework/wcf/diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).

## <a name="performance-issues-and-xmlserializer"></a>Leistungsprobleme und XmlSerializer
 Dienste und Clientanwendungen, die Datentypen verwenden, die mit dem <xref:System.Xml.Serialization.XmlSerializer> serialisiert werden können, generieren und kompilieren für diese Datentypen während der Laufzeit Code, was zu einem verlangsamten Start führen kann.

> [!NOTE]
> Vorab generierter Serialisierungscode kann nur in Clientanwendungen und nicht in Diensten verwendet werden.

 Die [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) können startleistung für diese Anwendungen verbessern, indem der erforderliche Serialisierungscode aus den kompilierten Assemblys für die Anwendung generiert. Weitere Informationen finden Sie unter [Vorgehensweise: Verbessern der Startzeit von WCF-Client Clientanwendungen mit dem XmlSerializer](../../../docs/framework/wcf/feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).

## <a name="performance-issues-when-hosting-wcf-services-under-aspnet"></a>Leistungsprobleme beim Hosten von WCF-Diensten unter ASP.NET
 Wird ein WCF-Dienst unter IIS und ASP.NET gehostet, können sich die Konfigurationseinstellungen von IIS und ASP.NET auf den Durchsatz und die Speicherbeanspruchung des WCF-Diensts auswirken.  Weitere Informationen zur Leistung von ASP.NET finden Sie unter [Verbessern der Leistung von ASP.NET](https://go.microsoft.com/fwlink/?LinkId=186462).  Eine Einstellung, durch die sich unbeabsichtigte Folgen ergeben können, ist <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>. Hierbei handelt es sich um eine Eigenschaft der <xref:System.Web.Configuration.ProcessModelSection>. Verfügt die Anwendung über eine feste oder über eine geringe Anzahl von Clients, lässt sich durch Festlegen von <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> auf "2" bei einem Computer mit mehreren Prozessoren, dessen CPU-Auslastung sich nahe bei 100 Prozent bewegt, möglicherweise ein Leistungsschub beim Durchsatz erzielen. Dieser Leistungszuwachs bringt jedoch auch einen Nachteil mit sich, da sich dadurch auch eine erhöhte Speicherauslastung ergibt, was zu einer geringeren Skalierbarkeit führt.

## <a name="see-also"></a>Siehe auch

- [Verwaltung und Diagnose](../../../docs/framework/wcf/diagnostics/index.md)
- [Umfangreiche Daten und Streaming](../../../docs/framework/wcf/feature-details/large-data-and-streaming.md)
