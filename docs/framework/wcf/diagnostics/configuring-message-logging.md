---
title: Konfigurieren der Nachrichtenprotokollierung
ms.date: 03/30/2017
helpviewer_keywords:
- message logging [WCF]
ms.assetid: 0ff4c857-8f09-4b85-9dc0-89084706e4c9
ms.openlocfilehash: 5b4da744151d8b667c0f944b1a0d51d1251bfae5
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "64652003"
---
# <a name="configuring-message-logging"></a><span data-ttu-id="1d7cb-102">Konfigurieren der Nachrichtenprotokollierung</span><span class="sxs-lookup"><span data-stu-id="1d7cb-102">Configuring Message Logging</span></span>
<span data-ttu-id="1d7cb-103">In diesem Thema wird beschrieben, wie Sie die Nachrichtenprotokollierung für verschiedene Szenarien konfigurieren können.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-103">This topic describes how you can configure message logging for different scenarios.</span></span>  
  
## <a name="enabling-message-logging"></a><span data-ttu-id="1d7cb-104">Aktivieren der Nachrichtenprotokollierung</span><span class="sxs-lookup"><span data-stu-id="1d7cb-104">Enabling Message Logging</span></span>  
 <span data-ttu-id="1d7cb-105">Windows Communication Foundation (WCF) protokolliert standardmäßig keine Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-105">Windows Communication Foundation (WCF) does not log messages by default.</span></span> <span data-ttu-id="1d7cb-106">Zum Aktivieren der Nachrichtenprotokollierung müssen Sie einen Ablaufverfolgungslistener zur `System.ServiceModel.MessageLogging`-Ablaufverfolgungsquelle hinzufügen und in der Konfigurationsdatei Attribute für das `<messagelogging>`-Element festlegen.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-106">To activate message logging, you must add a trace listener to the `System.ServiceModel.MessageLogging` trace source and set attributes for the `<messagelogging>` element in the configuration file.</span></span>  
  
 <span data-ttu-id="1d7cb-107">Das folgende Beispiel zeigt, wie die Protokollierung aktiviert und zusätzliche Optionen angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-107">The following example shows how to enable logging and specify additional options.</span></span>  
  
```xml  
<system.diagnostics>  
  <sources>  
    <source name="System.ServiceModel.MessageLogging">  
      <listeners>  
         <add name="messages"  
              type="System.Diagnostics.XmlWriterTraceListener"  
              initializeData="c:\logs\messages.svclog" />  
        </listeners>  
    </source>  
  </sources>  
</system.diagnostics>  
  
<system.serviceModel>  
  <diagnostics>  
    <messageLogging   
         logEntireMessage="true"   
         logMalformedMessages="false"  
         logMessagesAtServiceLevel="true"   
         logMessagesAtTransportLevel="false"  
         maxMessagesToLog="3000"  
         maxSizeOfMessageToLog="2000"/>  
  </diagnostics>  
</system.serviceModel>  
```  
  
 <span data-ttu-id="1d7cb-108">Weitere Informationen zu nachrichtenprotokollierungseinstellungen, finden Sie unter [empfohlenen Einstellungen für Ablaufverfolgung und Nachrichtenprotokollierung](../../../../docs/framework/wcf/diagnostics/tracing/recommended-settings-for-tracing-and-message-logging.md).</span><span class="sxs-lookup"><span data-stu-id="1d7cb-108">For more information about message logging settings, see [Recommended Settings for Tracing and Message Logging](../../../../docs/framework/wcf/diagnostics/tracing/recommended-settings-for-tracing-and-message-logging.md).</span></span>  
  
 <span data-ttu-id="1d7cb-109">Mit `add` können Sie den Namen und den Typ des Listeners angeben, den Sie verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-109">You can use `add` to specify the name and type of the listener you want to use.</span></span> <span data-ttu-id="1d7cb-110">In der Beispielkonfiguration wird der Listener "messages" genannt, und der standardmäßige .NET Framework-Ablaufverfolgungslistener (`System.Diagnostics.XmlWriterTraceListener`) wird als zu verwendender Typ hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-110">In the example configuration, the Listener is named "messages" and adds the standard .NET Framework trace listener (`System.Diagnostics.XmlWriterTraceListener`) as the type to use.</span></span> <span data-ttu-id="1d7cb-111">Wenn Sie `System.Diagnostics.XmlWriterTraceListener` verwenden, müssen Sie den Speicherort und den Namen der Ausgabedatei in der Konfigurationsdatei angeben.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-111">If you use `System.Diagnostics.XmlWriterTraceListener`, you must specify the output file location and name in the configuration file.</span></span> <span data-ttu-id="1d7cb-112">Legen Sie dafür `initializeData` auf den Namen der Protokolldatei fest.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-112">This is done by setting `initializeData` to the name of the log file.</span></span> <span data-ttu-id="1d7cb-113">Andernfalls löst das System eine Ausnahme aus.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-113">Otherwise, the system throws an exception.</span></span> <span data-ttu-id="1d7cb-114">Sie können auch einen benutzerdefinierten Listener implementieren, der Protokolle in einer Standarddatei ausgibt.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-114">You can also implement a custom listener that emits logs to a default file.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1d7cb-115">Da die Nachrichtenprotokollierung Speicherplatz verbraucht, beschränken Sie die Anzahl der Nachrichten, die auf die Festplatte geschrieben werden, auf einen bestimmten Dienst.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-115">Because message logging accesses disk space, you should limit the number of messages that are written to disk for a particular service.</span></span> <span data-ttu-id="1d7cb-116">Wenn die Nachrichtengrenze erreicht wird, wird eine Ablaufverfolgung auf Informationsebene erstellt und alle Nachrichtenprotokollierungsaktionen werden angehalten.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-116">When the message limit is reached, a trace at the Information level is produced and all message logging activities stop.</span></span>  
  
 <span data-ttu-id="1d7cb-117">Die Protokollierungsebene sowie die zusätzlichen Optionen werden im Abschnitt Protokollieren von Ebenen und Optionen erläutert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-117">The logging level, as well as the additional options, are discussed in the Logging Level and Options section.</span></span>  
  
 <span data-ttu-id="1d7cb-118">Das `switchValue`-Attribut von `source` ist nur für die Ablaufverfolgung gültig.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-118">The `switchValue` attribute of a `source` is only valid for tracing.</span></span> <span data-ttu-id="1d7cb-119">Wenn Sie ein `switchValue`-Attribut für die `System.ServiceModel.MessageLogging`-Ablaufverfolgungsquelle wie folgt angeben, hat dies keine Auswirkungen.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-119">If you specify a `switchValue` attribute for the `System.ServiceModel.MessageLogging` trace source as follows, it has no effect.</span></span>  
  
```xml  
<source name="System.ServiceModel.MessageLogging" switchValue="Verbose">  
```  
  
 <span data-ttu-id="1d7cb-120">Wenn Sie die Ablaufverfolgungsquelle deaktivieren möchten, verwenden Sie stattdessen das `logMessagesAtServiceLevel`, `logMalformedMessages`-Attribut und das `logMessagesAtTransportLevel`-Attribut des `messageLogging`-Elements.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-120">If you want to disable the trace source, you should use the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element instead.</span></span> <span data-ttu-id="1d7cb-121">Sie sollten all diese Attribute auf `false` festlegen.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-121">You should set all these attributes to `false`.</span></span> <span data-ttu-id="1d7cb-122">Dieser Schritt kann anhand der Konfigurationsdatei im vorigen Beispielcode über die Benutzeroberfläche des Configuration Editor oder über WMI durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-122">This can be done by using the configuration file in the previous code example, through the Configuration Editor UI interface, or using WMI.</span></span> <span data-ttu-id="1d7cb-123">Weitere Informationen zum Konfigurations-Editor-Tool finden Sie unter [Configuration Editor-Tool (SvcConfigEditor.exe)](../../../../docs/framework/wcf/configuration-editor-tool-svcconfigeditor-exe.md).</span><span class="sxs-lookup"><span data-stu-id="1d7cb-123">For more information about the Configuration Editor tool, see [Configuration Editor Tool (SvcConfigEditor.exe)](../../../../docs/framework/wcf/configuration-editor-tool-svcconfigeditor-exe.md).</span></span> <span data-ttu-id="1d7cb-124">Weitere Informationen zu WMI finden Sie unter [mithilfe von Windows-Verwaltungsinstrumentation für die Diagnose](../../../../docs/framework/wcf/diagnostics/wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="1d7cb-124">For more information about WMI, see [Using Windows Management Instrumentation for Diagnostics](../../../../docs/framework/wcf/diagnostics/wmi/index.md).</span></span>  
  
## <a name="logging-levels-and-options"></a><span data-ttu-id="1d7cb-125">Protokollieren von Ebenen und Optionen</span><span class="sxs-lookup"><span data-stu-id="1d7cb-125">Logging Levels and Options</span></span>  
 <span data-ttu-id="1d7cb-126">Für eingehende Nachrichten erfolgt die Protokollierung direkt nach dem Erstellen der Nachricht, unmittelbar bevor die Nachricht Benutzercode auf der Dienstebene erhält und wenn falsch formatierte Nachrichten erkannt werden.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-126">For incoming messages, logging happens immediately after the message is formed, immediately before the message gets to user code in the service level, and when malformed messages are detected.</span></span>  
  
 <span data-ttu-id="1d7cb-127">Für ausgehende Nachrichten erfolgt die Protokollierung unmittelbar nachdem die Nachricht den Benutzercode verlassen hat und unmittelbar bevor die Nachricht abgesendet wird.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-127">For outgoing messages, logging happens immediately after the message leaves user code and immediately before the message goes on the wire.</span></span>  
  
 <span data-ttu-id="1d7cb-128">WCF protokolliert Nachrichten auf zwei unterschiedlichen Ebenen, Dienst und Transport.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-128">WCF logs messages at two different levels, service and transport.</span></span> <span data-ttu-id="1d7cb-129">Falsch formatierte Nachrichten werden auch protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-129">Malformed messages are also logged.</span></span> <span data-ttu-id="1d7cb-130">Die drei Kategorien sind unabhängig voneinander und können in der Konfiguration getrennt aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-130">The three categories are independent from each other and can be activated separately in configuration.</span></span>  
  
 <span data-ttu-id="1d7cb-131">Sie können die Protokollierungsebene steuern, indem Sie das `logMessagesAtServiceLevel`, `logMalformedMessages`-Attribut und das `logMessagesAtTransportLevel`-Attribut des `messageLogging`-Elements festlegen.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-131">You can control the logging level by setting the `logMessagesAtServiceLevel`, `logMalformedMessages`, and `logMessagesAtTransportLevel` attributes of the `messageLogging` element.</span></span>  
  
### <a name="service-level"></a><span data-ttu-id="1d7cb-132">Dienstebene</span><span class="sxs-lookup"><span data-stu-id="1d7cb-132">Service Level</span></span>  
 <span data-ttu-id="1d7cb-133">Auf dieser Ebene protokollierte Nachrichten sind im Begriff, (beim Empfangen) Benutzercode einzugeben oder (beim Senden) zu belassen.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-133">Messages logged at this layer are about to enter (on receiving) or leave (on sending) user code.</span></span> <span data-ttu-id="1d7cb-134">Wenn Filter definiert wurden, werden nur Nachrichten, die zu den Filtern passen, protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-134">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="1d7cb-135">Andernfalls werden alle Nachrichten auf Dienstebene protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-135">Otherwise, all messages at the service level are logged.</span></span> <span data-ttu-id="1d7cb-136">Auf dieser Ebene werden auch Infrastrukturnachrichten (Transaktionen, Peerkanal und Sicherheit) protokolliert, mit Ausnahme von mit zuverlässigem Messaging erstellten Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-136">Infrastructure messages (transactions, peer channel, and security) are also logged at this level, except for Reliable Messaging messages.</span></span> <span data-ttu-id="1d7cb-137">Bei per Streaming übertragenen Nachrichten werden nur die Header protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-137">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="1d7cb-138">Außerdem werden sichere Nachrichten auf dieser Ebene entschlüsselt protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-138">In addition, secure messages are logged decrypted at this level.</span></span>  
  
### <a name="transport-level"></a><span data-ttu-id="1d7cb-139">Transportschicht</span><span class="sxs-lookup"><span data-stu-id="1d7cb-139">Transport Level</span></span>  
 <span data-ttu-id="1d7cb-140">Auf dieser Ebene protokollierte Nachrichten können vor oder nach dem Transport codiert oder decodiert werden.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-140">Messages logged at this layer are ready to be encoded or decoded for or after transportation on the wire.</span></span> <span data-ttu-id="1d7cb-141">Wenn Filter definiert wurden, werden nur Nachrichten, die zu den Filtern passen, protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-141">If filters have been defined, only messages that match the filters are logged.</span></span> <span data-ttu-id="1d7cb-142">Andernfalls werden alle Nachrichten auf der Transportschicht protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-142">Otherwise, all messages at the transport layer are logged.</span></span> <span data-ttu-id="1d7cb-143">Auf dieser Ebene werden alle Infrastrukturnachrichten protokolliert, einschließlich zuverlässiger Messagingnachrichten.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-143">All infrastructure messages are logged at this layer, including reliable messaging messages.</span></span> <span data-ttu-id="1d7cb-144">Bei per Streaming übertragenen Nachrichten werden nur die Header protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-144">On streamed messages, only the headers are logged.</span></span> <span data-ttu-id="1d7cb-145">Außerdem werden sichere Nachrichten auf dieser Ebene verschlüsselt protokolliert, außer bei Verwendung eines sicheren Transports wie HTTPS.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-145">In addition, secure messages are logged as encrypted at this level, except if a secure transport such as HTTPS is used.</span></span>  
  
### <a name="malformed-level"></a><span data-ttu-id="1d7cb-146">Falsch formatierte Ebene</span><span class="sxs-lookup"><span data-stu-id="1d7cb-146">Malformed Level</span></span>  
 <span data-ttu-id="1d7cb-147">Falsch formatierte Nachrichten sind Nachrichten, die vom WCF-Stapel in jeder Phase der Verarbeitung abgelehnt werden.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-147">Malformed messages are messages that are rejected by the WCF stack at any stage of processing.</span></span> <span data-ttu-id="1d7cb-148">Falsch formatierte Nachrichten werden unverändert protokolliert: verschlüsselt, wenn sie bereits verschlüsselt sind, mit nicht ordnungsgemäßem XML usw.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-148">Malformed messages are logged as-is: encrypted if they are so, with non-proper XML, and so on.</span></span> <span data-ttu-id="1d7cb-149">`maxSizeOfMessageToLog` definierte die zu protokollierende Nachrichtengröße als CDATA.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-149">`maxSizeOfMessageToLog` defined the size of the message to be logged as CDATA.</span></span> <span data-ttu-id="1d7cb-150">Standardmäßig beträgt `maxSizeOfMessageToLog` 256K.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-150">By default, `maxSizeOfMessageToLog` is equal to 256K.</span></span> <span data-ttu-id="1d7cb-151">Weitere Informationen zu diesem Attribut finden Sie im Abschnitt Weitere Optionen.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-151">For more information about this attribute, see the Other Options section.</span></span>  
  
### <a name="other-options"></a><span data-ttu-id="1d7cb-152">Weitere Optionen</span><span class="sxs-lookup"><span data-stu-id="1d7cb-152">Other Options</span></span>  
 <span data-ttu-id="1d7cb-153">Zusätzlich zu den Protokollierungsebenen kann der Benutzer die folgenden Optionen angeben:</span><span class="sxs-lookup"><span data-stu-id="1d7cb-153">In addition to the logging levels, the user can specify the following options:</span></span>  
  
- <span data-ttu-id="1d7cb-154">Gesamte Nachricht protokollieren (`logEntireMessage` Attribut): Dieser Wert gibt an, ob die ganze Meldung (Nachrichtenkopf und Text) protokolliert wird.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-154">Log Entire Message (`logEntireMessage` attribute): This value specifies whether the entire message (message header and body) is logged.</span></span> <span data-ttu-id="1d7cb-155">Der Standardwert lautet `false`, das bedeutet, dass nur der Nachrichtenheader protokolliert wird.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-155">The default value is `false`, meaning that only the header is logged.</span></span> <span data-ttu-id="1d7cb-156">Diese Einstellung beeinflusst die Nachrichtenprotokollierung auf Dienst- und Transportebene.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-156">This setting affects service and transport message logging levels..</span></span>  
  
- <span data-ttu-id="1d7cb-157">Max. zu protokollierende Nachrichten (`maxMessagesToLog` Attribut): Dieser Wert gibt die maximale Anzahl von zu protokollierenden Meldungen.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-157">Max messages to log (`maxMessagesToLog` attribute): This value specifies the maximum number of messages to log.</span></span> <span data-ttu-id="1d7cb-158">Alle Nachrichten (Dienst, Transport und falsch formatierte Nachrichten) werden zu diesem Kontingent gezählt.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-158">All messages (service, transport, and malformed messages) are counted towards this quota.</span></span> <span data-ttu-id="1d7cb-159">Wenn das Kontingent erreicht wird, wird eine Ablaufverfolgung ausgegeben und keine weitere Nachricht protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-159">When the quota is reached, a trace is emitted and no additional message is logged.</span></span> <span data-ttu-id="1d7cb-160">Der Standardwert ist 10.000.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-160">The default value is 10000.</span></span>  
  
- <span data-ttu-id="1d7cb-161">Maximale Größe einer zu protokollierenden Meldung (`maxSizeOfMessageToLog` Attribut): Dieser Wert gibt die maximale Größe von Nachrichten, melden Sie sich in Bytes.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-161">Max size of message to log (`maxSizeOfMessageToLog` attribute): This value specifies the maximum size of messages to log in bytes.</span></span> <span data-ttu-id="1d7cb-162">Nachrichten, die das Größenlimit überschreiten, werden nicht protokolliert, und für diese Nachricht werden keine weiteren Aktivitäten durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-162">Messages that exceed the size limit are not logged, and no other activity is performed for that message.</span></span> <span data-ttu-id="1d7cb-163">Diese Einstellung wirkt sich auf alle Nachverfolgungsebenen aus.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-163">This setting affects all trace levels.</span></span> <span data-ttu-id="1d7cb-164">Wenn die ServiceModel-Ablaufverfolgung aktiviert ist, wird am ersten Protokollierungspunkt (ServiceModelSend\* oder TransportReceive) zur Benachrichtigung des Benutzers eine Ablaufverfolgung auf Warnungsebene ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-164">If ServiceModel tracing is on, a Warning level trace is emitted at the first logging point (ServiceModelSend\* or TransportReceive) to notify the user.</span></span> <span data-ttu-id="1d7cb-165">Der Standardwert für Nachrichten auf Dienst- und auf Transportebene ist 256K, während der Standardwert für falsch formatierte Nachrichten 4K beträgt.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-165">The default value for service level and transport level messages is 256K, while the default value for malformed messages is 4K.</span></span>  
  
    > [!CAUTION]
    >  <span data-ttu-id="1d7cb-166">Bei der Nachrichtengröße, die für den Vergleich mit `maxSizeOfMessageToLog` berechnet wird, handelt es sich um die Nachrichtengröße im Arbeitsspeicher vor der Serialisierung.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-166">The message size that is computed to compare against `maxSizeOfMessageToLog` is the message size in memory before serialization.</span></span> <span data-ttu-id="1d7cb-167">Diese Größe kann von der tatsächlichen Länge der Nachrichtenzeichenfolge, die protokolliert wird, abweichen. In vielen Fällen überschreitet sie die tatsächliche Größe.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-167">This size can differ from the actual length of the message string that is being logged, and in many occasions is bigger than the actual size.</span></span> <span data-ttu-id="1d7cb-168">Demzufolge werden Nachrichten möglicherweise nicht protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-168">As a result, messages may not be logged.</span></span> <span data-ttu-id="1d7cb-169">Um dieser Tatsache Rechnung zu tragen, können Sie das `maxSizeOfMessageToLog`-Attribut um 10 % größer angeben als die erwartete Nachrichtengröße.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-169">You can account for this fact by specifying the `maxSizeOfMessageToLog` attribute to be 10% larger than the expected message size.</span></span> <span data-ttu-id="1d7cb-170">Wenn falsch formatierte Nachrichten protokolliert werden, kann die tatsächliche Festplattenspeichergröße, die von Nachrichtenprotokollen genutzt wird, die Größe des durch `maxSizeOfMessageToLog` angegebenen Werts um das Fünffache übersteigen.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-170">In addition, if malformed messages are logged, the actual disk space utilized by the message logs can be up to 5 times the size of the value specified by `maxSizeOfMessageToLog`.</span></span>  
  
 <span data-ttu-id="1d7cb-171">Wenn in der Konfigurationsdatei kein Ablaufverfolgungslistener definiert ist, wird unabhängig von der angegebenen Protokollierungsebene keine Protokollierungsausgabe generiert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-171">If no trace listener is defined in the configuration file, no logging output is generated regardless of the specified logging level.</span></span>  
  
 <span data-ttu-id="1d7cb-172">Die Nachrichtenprotokollierungsoptionen, wie die in diesem Abschnitt beschriebenen Attribute, können zur Laufzeit mit der Windows-Verwaltungsinstrumentation (WMI) geändert werden.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-172">Message logging options, such as the attributes described in this section, can be changed at runtime using Windows Management Instrumentation (WMI).</span></span> <span data-ttu-id="1d7cb-173">Dies ist möglich durch den Zugriff auf die [AppDomainInfo](../../../../docs/framework/wcf/diagnostics/wmi/appdomaininfo.md) -Instanz, die folgende booleschen Eigenschaften verfügbar macht: `LogMessagesAtServiceLevel`, `LogMessagesAtTransportLevel`, und `LogMalformedMessages`.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-173">This can be done by accessing the [AppDomainInfo](../../../../docs/framework/wcf/diagnostics/wmi/appdomaininfo.md) instance, which exposes these Boolean properties: `LogMessagesAtServiceLevel`, `LogMessagesAtTransportLevel`, and `LogMalformedMessages`.</span></span> <span data-ttu-id="1d7cb-174">Wenn Sie einen Ablaufverfolgungslistener für die Nachrichtenprotokollierung konfigurieren, diese Optionen in der Konfiguration jedoch auf `false` festlegen, können Sie sie später, wenn die Anwendung ausgeführt wird, zu `true` ändern.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-174">Therefore, if you configure a trace listener for message logging, but set these options to `false` in configuration, you can later change them to `true` when the application is running.</span></span> <span data-ttu-id="1d7cb-175">Dadurch wird die Nachrichtenprotokollierung zur Laufzeit aktiviert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-175">This effectively enables message logging at runtime.</span></span> <span data-ttu-id="1d7cb-176">Entsprechend können Sie die Nachrichtenprotokollierung zur Laufzeit mit WMI deaktivieren, wenn Sie sie in der Konfigurationsdatei aktivieren.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-176">Similarly, if you enable message logging in your configuration file, you can disable it at runtime using WMI.</span></span> <span data-ttu-id="1d7cb-177">Weitere Informationen finden Sie unter [mithilfe von Windows-Verwaltungsinstrumentation für die Diagnose](../../../../docs/framework/wcf/diagnostics/wmi/index.md).</span><span class="sxs-lookup"><span data-stu-id="1d7cb-177">For more information, see [Using Windows Management Instrumentation for Diagnostics](../../../../docs/framework/wcf/diagnostics/wmi/index.md).</span></span>  
  
 <span data-ttu-id="1d7cb-178">Das `source`-Feld in einem Nachrichtenprotokoll gibt an, in welchem Kontext die Nachricht protokolliert wird: beim Senden/Empfangen einer Anforderungsnachricht, für eine Anforderungsantwort oder eine unidirektionale Anforderung, auf der Dienstmodell- oder Transportschicht oder im Falle einer falsch formatierten Nachricht.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-178">The `source` field in a message log specifies in which context the message is logged: when sending/receiving a request message, for a request-reply or 1-way request, at service model or transport layer, or in the case of a malformed message.</span></span>  
  
 <span data-ttu-id="1d7cb-179">Für falsch formatierte Nachrichten `source` gleich `Malformed`.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-179">For malformed messages, `source`  is equal to `Malformed`.</span></span> <span data-ttu-id="1d7cb-180">Andernfalls verfügt die Quelle über die folgenden Werte auf der Grundlage des Kontexts.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-180">Otherwise, source has the following values based on the context.</span></span>  
  
 <span data-ttu-id="1d7cb-181">Für Anforderung/Antwort</span><span class="sxs-lookup"><span data-stu-id="1d7cb-181">For Request/Reply</span></span>  
  
||<span data-ttu-id="1d7cb-182">Anforderung senden</span><span class="sxs-lookup"><span data-stu-id="1d7cb-182">Send Request</span></span>|<span data-ttu-id="1d7cb-183">Anforderung empfangen</span><span class="sxs-lookup"><span data-stu-id="1d7cb-183">Receive Request</span></span>|<span data-ttu-id="1d7cb-184">Antwort senden</span><span class="sxs-lookup"><span data-stu-id="1d7cb-184">Send Reply</span></span>|<span data-ttu-id="1d7cb-185">Antwort empfangen</span><span class="sxs-lookup"><span data-stu-id="1d7cb-185">Receive Reply</span></span>|  
|-|------------------|---------------------|----------------|-------------------|  
|<span data-ttu-id="1d7cb-186">Dienstmodellebene</span><span class="sxs-lookup"><span data-stu-id="1d7cb-186">Service Model layer</span></span>|<span data-ttu-id="1d7cb-187">Dienst</span><span class="sxs-lookup"><span data-stu-id="1d7cb-187">Service</span></span><br /><br /> <span data-ttu-id="1d7cb-188">Ebene</span><span class="sxs-lookup"><span data-stu-id="1d7cb-188">Level</span></span><br /><br /> <span data-ttu-id="1d7cb-189">Senden</span><span class="sxs-lookup"><span data-stu-id="1d7cb-189">Send</span></span><br /><br /> <span data-ttu-id="1d7cb-190">Anforderung</span><span class="sxs-lookup"><span data-stu-id="1d7cb-190">Request</span></span>|<span data-ttu-id="1d7cb-191">Dienst</span><span class="sxs-lookup"><span data-stu-id="1d7cb-191">Service</span></span><br /><br /> <span data-ttu-id="1d7cb-192">Ebene</span><span class="sxs-lookup"><span data-stu-id="1d7cb-192">Level</span></span><br /><br /> <span data-ttu-id="1d7cb-193">Empfangen</span><span class="sxs-lookup"><span data-stu-id="1d7cb-193">Receive</span></span><br /><br /> <span data-ttu-id="1d7cb-194">Anforderung</span><span class="sxs-lookup"><span data-stu-id="1d7cb-194">Request</span></span>|<span data-ttu-id="1d7cb-195">Dienst</span><span class="sxs-lookup"><span data-stu-id="1d7cb-195">Service</span></span><br /><br /> <span data-ttu-id="1d7cb-196">Ebene</span><span class="sxs-lookup"><span data-stu-id="1d7cb-196">Level</span></span><br /><br /> <span data-ttu-id="1d7cb-197">Senden</span><span class="sxs-lookup"><span data-stu-id="1d7cb-197">Send</span></span><br /><br /> <span data-ttu-id="1d7cb-198">Antworten</span><span class="sxs-lookup"><span data-stu-id="1d7cb-198">Reply</span></span>|<span data-ttu-id="1d7cb-199">Dienst</span><span class="sxs-lookup"><span data-stu-id="1d7cb-199">Service</span></span><br /><br /> <span data-ttu-id="1d7cb-200">Ebene</span><span class="sxs-lookup"><span data-stu-id="1d7cb-200">Level</span></span><br /><br /> <span data-ttu-id="1d7cb-201">Empfangen</span><span class="sxs-lookup"><span data-stu-id="1d7cb-201">Receive</span></span><br /><br /> <span data-ttu-id="1d7cb-202">Antworten</span><span class="sxs-lookup"><span data-stu-id="1d7cb-202">Reply</span></span>|  
|<span data-ttu-id="1d7cb-203">Transportschicht</span><span class="sxs-lookup"><span data-stu-id="1d7cb-203">Transport layer</span></span>|<span data-ttu-id="1d7cb-204">Transport</span><span class="sxs-lookup"><span data-stu-id="1d7cb-204">Transport</span></span><br /><br /> <span data-ttu-id="1d7cb-205">Senden</span><span class="sxs-lookup"><span data-stu-id="1d7cb-205">Send</span></span>|<span data-ttu-id="1d7cb-206">Transport</span><span class="sxs-lookup"><span data-stu-id="1d7cb-206">Transport</span></span><br /><br /> <span data-ttu-id="1d7cb-207">Empfangen</span><span class="sxs-lookup"><span data-stu-id="1d7cb-207">Receive</span></span>|<span data-ttu-id="1d7cb-208">Transport</span><span class="sxs-lookup"><span data-stu-id="1d7cb-208">Transport</span></span><br /><br /> <span data-ttu-id="1d7cb-209">Senden</span><span class="sxs-lookup"><span data-stu-id="1d7cb-209">Send</span></span>|<span data-ttu-id="1d7cb-210">Transport</span><span class="sxs-lookup"><span data-stu-id="1d7cb-210">Transport</span></span><br /><br /> <span data-ttu-id="1d7cb-211">Empfangen</span><span class="sxs-lookup"><span data-stu-id="1d7cb-211">Receive</span></span>|  
  
 <span data-ttu-id="1d7cb-212">Für unidirektionale Anforderung</span><span class="sxs-lookup"><span data-stu-id="1d7cb-212">For One-way Request</span></span>  
  
||<span data-ttu-id="1d7cb-213">Anforderung senden</span><span class="sxs-lookup"><span data-stu-id="1d7cb-213">Send Request</span></span>|<span data-ttu-id="1d7cb-214">Anforderung empfangen</span><span class="sxs-lookup"><span data-stu-id="1d7cb-214">Receive Request</span></span>|  
|-|------------------|---------------------|  
|<span data-ttu-id="1d7cb-215">Dienstmodellebene</span><span class="sxs-lookup"><span data-stu-id="1d7cb-215">Service Model layer</span></span>|<span data-ttu-id="1d7cb-216">Dienst</span><span class="sxs-lookup"><span data-stu-id="1d7cb-216">Service</span></span><br /><br /> <span data-ttu-id="1d7cb-217">Ebene</span><span class="sxs-lookup"><span data-stu-id="1d7cb-217">Level</span></span><br /><br /> <span data-ttu-id="1d7cb-218">Senden</span><span class="sxs-lookup"><span data-stu-id="1d7cb-218">Send</span></span><br /><br /> <span data-ttu-id="1d7cb-219">Datagramm</span><span class="sxs-lookup"><span data-stu-id="1d7cb-219">Datagram</span></span>|<span data-ttu-id="1d7cb-220">Dienst</span><span class="sxs-lookup"><span data-stu-id="1d7cb-220">Service</span></span><br /><br /> <span data-ttu-id="1d7cb-221">Ebene</span><span class="sxs-lookup"><span data-stu-id="1d7cb-221">Level</span></span><br /><br /> <span data-ttu-id="1d7cb-222">Empfangen</span><span class="sxs-lookup"><span data-stu-id="1d7cb-222">Receive</span></span><br /><br /> <span data-ttu-id="1d7cb-223">Datagramm</span><span class="sxs-lookup"><span data-stu-id="1d7cb-223">Datagram</span></span>|  
|<span data-ttu-id="1d7cb-224">Transportschicht</span><span class="sxs-lookup"><span data-stu-id="1d7cb-224">Transport layer</span></span>|<span data-ttu-id="1d7cb-225">Transport</span><span class="sxs-lookup"><span data-stu-id="1d7cb-225">Transport</span></span><br /><br /> <span data-ttu-id="1d7cb-226">Senden</span><span class="sxs-lookup"><span data-stu-id="1d7cb-226">Send</span></span>|<span data-ttu-id="1d7cb-227">Transport</span><span class="sxs-lookup"><span data-stu-id="1d7cb-227">Transport</span></span><br /><br /> <span data-ttu-id="1d7cb-228">Empfangen</span><span class="sxs-lookup"><span data-stu-id="1d7cb-228">Receive</span></span>|  
  
## <a name="message-filters"></a><span data-ttu-id="1d7cb-229">Nachrichtenfilter</span><span class="sxs-lookup"><span data-stu-id="1d7cb-229">Message Filters</span></span>  
 <span data-ttu-id="1d7cb-230">Nachrichtenfilter werden im `messageLogging`-Konfigurationselement des `diagnostics`-Konfigurationsabschnitts definiert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-230">Message filters are defined in the `messageLogging` configuration element of the `diagnostics` configuration section.</span></span> <span data-ttu-id="1d7cb-231">Sie werden auf der Dienst- und Transportebene angewendet.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-231">They are applied at the service and transport level.</span></span> <span data-ttu-id="1d7cb-232">Wenn mindestens ein Filter definiert ist, werden nur Nachrichten protokolliert, die mindestens einem der Filter entsprechen.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-232">When one or more filters are defined, only messages that match at least one of the filters are logged.</span></span> <span data-ttu-id="1d7cb-233">Wenn kein Filter definiert wird, werden alle Meldungen protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-233">If no filter is defined, all messages pass through.</span></span>  
  
 <span data-ttu-id="1d7cb-234">Filter unterstützen die gesamte Xpath-Syntax und werden in der Reihenfolge angewendet, in der sie in der Konfigurationsdatei angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-234">Filters support the full XPath syntax and are applied in the order they appear in the configuration file.</span></span> <span data-ttu-id="1d7cb-235">Ein syntaktisch falscher Filter führt zu einer Konfigurationsausnahme.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-235">A syntactically incorrect filter results in a configuration exception.</span></span>  
  
 <span data-ttu-id="1d7cb-236">Filter bieten unter Verwendung des `nodeQuota`-Attributs auch eine Sicherheitsfunktion, das die maximale Anzahl der Knoten im XPath DOM beschränkt, die im Hinblick auf den Filter geprüft werden.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-236">Filters also provide a safety feature using the `nodeQuota` attribute, which limits the maximum number of nodes in the XPath DOM that can be examined to match the filter.</span></span>  
  
 <span data-ttu-id="1d7cb-237">Im Folgenden finden Sie ein Beispiel für das Konfigurieren eines Filters, der nur Nachrichten aufzeichnet, die über einen SOAP-Headerabschnitt verfügen.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-237">The following example shows how to configure a filter that records only messages that have a SOAP header section.</span></span>  
  
```xml  
<messageLogging logEntireMessage="true"  
    logMalformedMessages="true"   
    logMessagesAtServiceLevel="true"  
    logMessagesAtTransportLevel="true"  
    maxMessagesToLog="420">  
    <filters>  
        <add nodeQuota="10" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">  
                 /soap:Envelope/soap:Header  
        </add>  
     </filters>  
</messageLogging>  
```  
  
 <span data-ttu-id="1d7cb-238">Filter können nicht auf den Text einer Nachricht angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-238">Filters cannot be applied to the body of a message.</span></span> <span data-ttu-id="1d7cb-239">Filter, die versuchen, den Text einer Nachricht zu bearbeiten, werden aus der Liste von Filtern entfernt.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-239">Filters that attempt to manipulate the body of a message are removed from the list of filters.</span></span> <span data-ttu-id="1d7cb-240">Außerdem wird ein entsprechendes Ereignis ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-240">An event is also emitted that indicates this.</span></span> <span data-ttu-id="1d7cb-241">Der folgende Filter würde z. B. aus der Filtertabelle entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-241">For example, the following filter would be removed from the filter table.</span></span>  
  
```xml  
<add xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">/s:Envelope/s:Body[contains(text(), "Hello")]</add>  
```  
  
## <a name="configuring-a-custom-listener"></a><span data-ttu-id="1d7cb-242">Konfigurieren eines benutzerdefinierten Listeners</span><span class="sxs-lookup"><span data-stu-id="1d7cb-242">Configuring a Custom Listener</span></span>  
 <span data-ttu-id="1d7cb-243">Sie können auch einen benutzerdefinierten Listener mit zusätzlichen Optionen konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-243">You can also configure a custom listener with additional options.</span></span> <span data-ttu-id="1d7cb-244">Ein benutzerdefinierter Listener kann nützlich sein, um vor der Protokollierung anwendungsspezifische PII-Elemente von Nachrichten zu filtern.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-244">A custom listener can be useful in filtering application-specific PII elements from messages before logging.</span></span> <span data-ttu-id="1d7cb-245">Das folgende Beispiel veranschaulicht eine benutzerdefinierte Listenerkonfiguration.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-245">The following example demonstrates a custom listener configuration.</span></span>  
  
```xml  
<system.diagnostics>  
   <sources>  
     <source name="System.ServiceModel.MessageLogging">  
           <listeners>  
             <add name="MyListener"   
                    type="YourCustomListener"  
                    initializeData="c:\logs\messages.svclog"  
                    maxDiskSpace="1000"/>  
           </listeners>  
     </source>  
   </sources>  
</system.diagnostics>  
```  
  
 <span data-ttu-id="1d7cb-246">Das `type`-Attribut sollte auf einen vollqualifizierten Assemblynamen festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="1d7cb-246">You should be aware that the `type` attribute should be set to a qualified assembly name of the type.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1d7cb-247">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="1d7cb-247">See also</span></span>

- [<span data-ttu-id="1d7cb-248">\<messageLogging></span><span class="sxs-lookup"><span data-stu-id="1d7cb-248">\<messageLogging></span></span>](../../../../docs/framework/configure-apps/file-schema/wcf/messagelogging.md)
- [<span data-ttu-id="1d7cb-249">Nachrichtenprotokollierung</span><span class="sxs-lookup"><span data-stu-id="1d7cb-249">Message Logging</span></span>](../../../../docs/framework/wcf/diagnostics/message-logging.md)
- [<span data-ttu-id="1d7cb-250">Empfohlene Einstellungen für Ablaufverfolgung und Nachrichtenprotokollierung</span><span class="sxs-lookup"><span data-stu-id="1d7cb-250">Recommended Settings for Tracing and Message Logging</span></span>](../../../../docs/framework/wcf/diagnostics/tracing/recommended-settings-for-tracing-and-message-logging.md)
