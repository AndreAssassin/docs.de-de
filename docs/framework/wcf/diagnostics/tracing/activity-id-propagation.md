---
title: Weitergabe der Aktivitäts-ID
ms.date: 03/30/2017
ms.assetid: cd1c1ae5-cc8a-4f51-90c9-f7b476bcfe70
ms.openlocfilehash: e51970f693d9ca2d2f81bf4efc97969896de4828
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "61998048"
---
# <a name="activity-id-propagation"></a><span data-ttu-id="cd24a-102">Weitergabe der Aktivitäts-ID</span><span class="sxs-lookup"><span data-stu-id="cd24a-102">Activity ID Propagation</span></span>
<span data-ttu-id="cd24a-103">Die Weitergabe erfolgt, wenn die ServiceModel-Aktivitätsablaufverfolgung aktiviert (ServiceModel-Weitergabe) oder deaktiviert (Benutzer-zu-Benutzer-Aktivitätsweitergabe) ist.</span><span class="sxs-lookup"><span data-stu-id="cd24a-103">Propagation happens when ServiceModel activity tracing is enabled (ServiceModel propagation) or disabled (User-to-User activity propagation).</span></span>  
  
## <a name="servicemodel-activity-tracing-is-enabled"></a><span data-ttu-id="cd24a-104">ServiceModel-Aktivitätsablaufverfolgung ist aktiviert</span><span class="sxs-lookup"><span data-stu-id="cd24a-104">ServiceModel Activity Tracing is Enabled</span></span>  
 <span data-ttu-id="cd24a-105">Wenn die ServiceModel-Aktivitätsablaufverfolgung aktiviert ist, erfolgt die Weitergabe zwischen ProcessAction-Aktivitäten.</span><span class="sxs-lookup"><span data-stu-id="cd24a-105">If ServiceModel ActivityTracing is enabled, propagation happens between ProcessAction activities.</span></span>  
  
### <a name="server"></a><span data-ttu-id="cd24a-106">Server</span><span class="sxs-lookup"><span data-stu-id="cd24a-106">Server</span></span>  
 <span data-ttu-id="cd24a-107">Wenn die `propagateActivity` -Attributsatz auf `true` auf dem Client und den Server, die ID des der `ProcessAction` Aktivität auf dem Server ist identisch mit der ID im weitergegebenen `ActivityId` Nachrichtenheader.</span><span class="sxs-lookup"><span data-stu-id="cd24a-107">When the `propagateActivity` attribute is set to `true` on both the client and server, the ID of the `ProcessAction` activity in the server is identical to the ID in the propagated `ActivityId` message header.</span></span>  
  
 <span data-ttu-id="cd24a-108">Wenn kein `ActivityId` Header in der Nachricht vorhanden ist (d. h. `propagateActivity` = `false` auf dem Client), oder wenn `propagateActivity` = `false` auf dem Server, generiert der Server eine neue Aktivitäts-ID.</span><span class="sxs-lookup"><span data-stu-id="cd24a-108">When no `ActivityId` header is present in the message (that is, `propagateActivity`=`false` on the client), or when `propagateActivity`=`false` on the server, the server generates a new activity ID.</span></span>  
  
### <a name="client"></a><span data-ttu-id="cd24a-109">Client</span><span class="sxs-lookup"><span data-stu-id="cd24a-109">Client</span></span>  
 <span data-ttu-id="cd24a-110">Wenn der Client ein synchroner Singlethread-Client ist, ignoriert er alle Einstellungen von `propagateActivity` auf dem Client oder Server.</span><span class="sxs-lookup"><span data-stu-id="cd24a-110">If the client is synchronously single threaded, the client disregards any settings of `propagateActivity` at the client or server.</span></span> <span data-ttu-id="cd24a-111">Stattdessen wird die Antwort in der Anforderungsaktivität behandelt.</span><span class="sxs-lookup"><span data-stu-id="cd24a-111">Instead, the response is handled in the request activity.</span></span> <span data-ttu-id="cd24a-112">Wenn der Client asynchron oder synchron ausgerichtet ist Multithread, `propagateActivity` = `true` im Client und ein Aktivitäts-ID-Header vorhanden ist, in der vom Server gesendete Nachricht ist, wird der Client Ruft die Aktivitäts-ID aus der Nachricht ab und überträgt an das Verarbeiten Sie Aktion-Aktivität, die die weitergegebene Aktivitäts-ID enthält.</span><span class="sxs-lookup"><span data-stu-id="cd24a-112">If the client is asynchronous or synchronous multithreaded, `propagateActivity`=`true` in the client, and there is an activity ID header in the message sent by the server, the client retrieves the activity ID from the message, and transfers to the Process Action activity that contains the propagated activity ID.</span></span> <span data-ttu-id="cd24a-113">Andernfalls überträgt der Client aus der ProcessMessage-Aktivität zu einer neuen ProcessAction-Aktivität.</span><span class="sxs-lookup"><span data-stu-id="cd24a-113">Otherwise, the client transfers from Process Message activity to a new Process Action activity.</span></span> <span data-ttu-id="cd24a-114">Diese zusätzliche Übertragung zu einer neuen ProcessAction-Aktivität erfolgt im Hinblick auf die Konsistenz.</span><span class="sxs-lookup"><span data-stu-id="cd24a-114">This extra transfer to a new Process Action activity is done for consistency.</span></span> <span data-ttu-id="cd24a-115">Innerhalb dieser Aktivität ruft der Client die Aktivitäts-ID der BeginCall-Aktivität aus dem lokalen Threadkontext ab, wenn der Thread für die Verarbeitung der Antwortnachricht reserviert wird.</span><span class="sxs-lookup"><span data-stu-id="cd24a-115">Inside this activity, the client retrieves the activity ID of the BeginCall activity from the local thread context, when the thread is allocated for response message processing.</span></span> <span data-ttu-id="cd24a-116">Er überträgt dann zur ursprünglichen ProcessAction-Aktivität.</span><span class="sxs-lookup"><span data-stu-id="cd24a-116">It then transfers to the initial Process Action activity.</span></span>  
  
 <span data-ttu-id="cd24a-117">Wenn der Client ein Duplexclient ist, fungiert der Client beim Empfangen der Nachricht als Server.</span><span class="sxs-lookup"><span data-stu-id="cd24a-117">If the client is duplex, the client acts as server on receiving the message.</span></span>  
  
### <a name="propagation-in-fault-messages"></a><span data-ttu-id="cd24a-118">Weitergabe in Fehlermeldungen</span><span class="sxs-lookup"><span data-stu-id="cd24a-118">Propagation in Fault Messages</span></span>  
 <span data-ttu-id="cd24a-119">Es gibt keinen Unterschied bei der Behandlung von gültigen Meldungen und Fehlermeldungen.</span><span class="sxs-lookup"><span data-stu-id="cd24a-119">There is no difference in handling valid and fault messages.</span></span> <span data-ttu-id="cd24a-120">Wenn `propagateActivity` = `true`, die Aktivitäts-ID, die die SOAP-Fehler Nachrichtenheader hinzugefügt ist identisch mit der ambient-Aktivität.</span><span class="sxs-lookup"><span data-stu-id="cd24a-120">If `propagateActivity`=`true`, the activity ID added to the SOAP fault message headers is identical to the ambient activity.</span></span>  
  
## <a name="servicemodel-activity-tracing-is-disabled"></a><span data-ttu-id="cd24a-121">ServiceModel-Aktivitätsablaufverfolgung ist deaktiviert</span><span class="sxs-lookup"><span data-stu-id="cd24a-121">ServiceModel Activity Tracing is Disabled</span></span>  
 <span data-ttu-id="cd24a-122">Wenn die ServiceModel-Aktivitätsablaufverfolgung deaktiviert ist, erfolgt die Weitergabe direkt zwischen Benutzercodeaktivitäten ohne Durchlaufen von ServiceModel-Aktivitäten.</span><span class="sxs-lookup"><span data-stu-id="cd24a-122">If ServiceModel ActivityTracing is disabled, propagation occurs between user code activities directly without going through ServiceModel activities.</span></span> <span data-ttu-id="cd24a-123">Eine benutzerdefinierte Aktivitäts-ID wird auch durch den Nachrichtenaktivitäts-ID-Header weitergegeben.</span><span class="sxs-lookup"><span data-stu-id="cd24a-123">A user-defined activity ID is also propagated through the message activity ID header.</span></span>  
  
 <span data-ttu-id="cd24a-124">Wenn `propagateActivity` = `true` und `ActivityTracing` = `off` für einen ServiceModel-Ablaufverfolgungslistener (unabhängig davon, ob die Ablaufverfolgung für ServiceModel aktiviert ist), die folgenden auftreten, auf dem Client oder Server:</span><span class="sxs-lookup"><span data-stu-id="cd24a-124">If `propagateActivity`=`true` and `ActivityTracing`=`off` for a ServiceModel trace listener (regardless of whether tracing is enabled on ServiceModel), the following happen on either the client or server:</span></span>  
  
- <span data-ttu-id="cd24a-125">Bei einer Vorgangsanforderung oder beim Senden von Antworten wird die Aktivitäts-ID im TLS aus Benutzercode weitergegeben, bis eine Nachricht erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="cd24a-125">On operation request or sending response, the activity ID in TLS is propagated out of user code until a message is formed.</span></span> <span data-ttu-id="cd24a-126">Außerdem wird ein Aktivitäts-ID-Header in die Nachricht eingefügt, bevor sie gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="cd24a-126">An activity ID header is also inserted into the message before it is sent.</span></span>  
  
- <span data-ttu-id="cd24a-127">Beim Empfangen einer Anforderung oder einer Antwort wird die Aktivitäts-ID aus dem Nachrichtenheader abgerufen, sobald das empfangene Nachrichtenobjekt erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="cd24a-127">On receiving request or receiving response, the activity ID is retrieved from the message header as soon as the received message object is created.</span></span> <span data-ttu-id="cd24a-128">Die Aktivitäts-ID im TLS wird weitergegeben, sobald die Nachricht nicht mehr im Bereich angezeigt wird, bis Benutzercode erreicht wird.</span><span class="sxs-lookup"><span data-stu-id="cd24a-128">The activity ID in TLS is propagated as soon as the message disappears from scope until user code is reached.</span></span>  
  
 <span data-ttu-id="cd24a-129">Diese Aktionen garantieren, dass Benutzerablaufverfolgungen in der gleichen Aktivität angezeigt werden, wenn die Weitergabe aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="cd24a-129">These actions guarantee that user traces will appear in the same activity if propagation is on.</span></span> <span data-ttu-id="cd24a-130">ServiceModel-Ablaufverfolgungen sind jedoch nicht garantiert.</span><span class="sxs-lookup"><span data-stu-id="cd24a-130">However, it makes no guarantee on ServiceModel traces.</span></span> <span data-ttu-id="cd24a-131">ServiceModel-Ablaufverfolgungen treten in einer Benutzercodeaktivität nur dann auf, wenn die Verarbeitung dieser Ablaufverfolgungen auf dem gleichen Thread erfolgt, auf dem die Benutzercodeaktivität festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="cd24a-131">ServiceModel traces occur in a user code activity only if the processing of those traces is executed on the same thread where the user code activity was set.</span></span>  
  
 <span data-ttu-id="cd24a-132">Im Allgemeinen können ServiceModel-Ablaufverfolgungen an den folgenden Stellen beobachtet werden:</span><span class="sxs-lookup"><span data-stu-id="cd24a-132">In general, ServiceModel traces can be observed in the following places:</span></span>  
  
- <span data-ttu-id="cd24a-133">Wenn die ServiceModel-Ablaufverfolgung deaktiviert ist, werden alle ausgegebenen Ablaufverfolgungen in Benutzeraktivitäten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="cd24a-133">If ServiceModel tracing is disabled, all emitted traces appear in user activities.</span></span> <span data-ttu-id="cd24a-134">Wenn die Weitergabe auf dem Server und auf dem Client aktiviert ist, befinden sich diese Ablaufverfolgungen in der gleichen Aktivität.</span><span class="sxs-lookup"><span data-stu-id="cd24a-134">If propagation is enabled at both the server and client, these traces will be in the same activity.</span></span>  
  
- <span data-ttu-id="cd24a-135">Ist die ServiceModel-Ablaufverfolgung aktiviert, die Aktivitätsablaufverfolgung jedoch deaktiviert, werden Benutzerablaufverfolgungen in der gleichen Aktivität angezeigt, wenn die Weitergabe an beiden Enden aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="cd24a-135">If ServiceModel tracing is enabled, but ActivityTracing is disabled, user traces appear in the same activity if propagation is enabled on both ends.</span></span> <span data-ttu-id="cd24a-136">ServiceModel-Ablaufverfolgungen werden in der standardmäßigen Aktivität "0000" angezeigt, wenn sie sich nicht auf dem gleichen Thread wie die Benutzercodeverarbeitung befinden, auf dem die Aktivität ursprünglich festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="cd24a-136">ServiceModel traces appear in the default 0000 activity, unless they occur in the same thread as the user code processing where the activity is initially set.</span></span>  
  
- <span data-ttu-id="cd24a-137">Wenn sowohl die ServiceModel-Ablaufverfolgung als auch die Aktivitätsablaufverfolgung aktiviert ist, werden Benutzerablaufverfolgungen in benutzerdefinierten Aktivitäten angezeigt, und ServiceModel-Ablaufverfolgungen werden in vom ServiceModel definierten Aktivitäten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="cd24a-137">If both ServiceModel tracing and ActivityTracing are enabled, user traces appear in user-defined activities, and ServiceModel traces appear in ServiceModel-defined activities.</span></span> <span data-ttu-id="cd24a-138">Die Weitergabe erfolgt auf ServiceModel-Ebene.</span><span class="sxs-lookup"><span data-stu-id="cd24a-138">Propagation happens at ServiceModel level.</span></span>
