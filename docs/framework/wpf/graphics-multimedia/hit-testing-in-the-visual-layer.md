---
title: Treffertests in der visuellen Ebene
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- hit testing functionality [WPF]
- visual layer [WPF], hit testing functionality
ms.assetid: b1a64b61-14be-4d75-b89a-5c67bebb2c7b
ms.openlocfilehash: d4d304353e91147c57297dcc4525759ff1474b4f
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/12/2020
ms.locfileid: "79186401"
---
# <a name="hit-testing-in-the-visual-layer"></a><span data-ttu-id="b3f60-102">Treffertests in der visuellen Ebene</span><span class="sxs-lookup"><span data-stu-id="b3f60-102">Hit Testing in the Visual Layer</span></span>
<span data-ttu-id="b3f60-103">Dieses Thema enthält eine Übersicht über die Treffertestfunktionen der visuellen Ebene.</span><span class="sxs-lookup"><span data-stu-id="b3f60-103">This topic provides an overview of hit testing functionality provided by the visual layer.</span></span> <span data-ttu-id="b3f60-104">Mit der Treffertestunterstützung können Sie bestimmen, ob eine Geometrie <xref:System.Windows.Media.Visual>oder ein Punktwert innerhalb des gerenderten Inhalts einer liegt, sodass Sie das Verhalten der Benutzeroberfläche implementieren können, z. B. ein Auswahlrechteck, um mehrere Objekte auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-104">Hit testing support allows you to determine whether a geometry or point value falls within the rendered content of a <xref:System.Windows.Media.Visual>, allowing you to implement user interface behavior such as a selection rectangle to select multiple objects.</span></span>  

<a name="hit_testing_scenarios"></a>
## <a name="hit-testing-scenarios"></a><span data-ttu-id="b3f60-105">Treffertestszenarios</span><span class="sxs-lookup"><span data-stu-id="b3f60-105">Hit Testing Scenarios</span></span>  
 <span data-ttu-id="b3f60-106">Die <xref:System.Windows.UIElement> Klasse <xref:System.Windows.UIElement.InputHitTest%2A> stellt die Methode bereit, mit der Sie testen gegen ein Element mithilfe eines bestimmten Koordinatenwerts treffen können.</span><span class="sxs-lookup"><span data-stu-id="b3f60-106">The <xref:System.Windows.UIElement> class provides the <xref:System.Windows.UIElement.InputHitTest%2A> method, which allows you to hit test against an element using a given coordinate value.</span></span> <span data-ttu-id="b3f60-107">In vielen Fällen <xref:System.Windows.UIElement.InputHitTest%2A> bietet die Methode die gewünschte Funktionalität zum Implementieren von Treffertests von Elementen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-107">In many cases, the <xref:System.Windows.UIElement.InputHitTest%2A> method provides the desired functionality for implementing hit testing of elements.</span></span> <span data-ttu-id="b3f60-108">Es gibt jedoch mehrere Szenarios, bei denen es möglicherweise erforderlich ist, den Treffertest auf der visuellen Ebene zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="b3f60-108">However, there are several scenarios in which you may need to implement hit testing at the visual layer.</span></span>  
  
- <span data-ttu-id="b3f60-109">Treffertests für<xref:System.Windows.UIElement> Nicht-Objekte: Dies gilt,<xref:System.Windows.UIElement> wenn Sie <xref:System.Windows.Media.DrawingVisual> auf das Testen von Nicht-Objekten, z. B. Grafikobjekten, treffen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-109">Hit testing against non-<xref:System.Windows.UIElement> objects: This applies if you are hit testing non-<xref:System.Windows.UIElement> objects, such as <xref:System.Windows.Media.DrawingVisual> or graphics objects.</span></span>  
  
- <span data-ttu-id="b3f60-110">Ein Treffertest unter Verwendung einer Geometrie: Dies gilt für Treffertests unter Verwendung eines Geometrieobjekts statt des Koordinatenwerts eines Punkts.</span><span class="sxs-lookup"><span data-stu-id="b3f60-110">Hit testing using a geometry: This applies if you need to hit test using a geometry object rather than the coordinate value of a point.</span></span>  
  
- <span data-ttu-id="b3f60-111">Ein Treffertest für mehrere Objekte: Dies gilt fürs Treffertests für mehrere Objekte, wie z.B. überlappende Objekte.</span><span class="sxs-lookup"><span data-stu-id="b3f60-111">Hit testing against multiple objects: This applies when you need to hit test against multiple objects, such as overlapping objects.</span></span> <span data-ttu-id="b3f60-112">Sie können Ergebnisse für alle grafischen Elemente abrufen, die eine Geometrie oder einen Punkt kreuzen, nicht nur für das erste.</span><span class="sxs-lookup"><span data-stu-id="b3f60-112">You can get results for all visuals intersecting a geometry or point, not just the first one.</span></span>  
  
- <span data-ttu-id="b3f60-113">Ignorieren <xref:System.Windows.UIElement> der Treffertestrichtlinie: Dies gilt, wenn Sie die Treffertestrichtlinie ignorieren müssen, bei der <xref:System.Windows.UIElement> Faktoren wie deaktiviert oder unsichtbar berücksichtigt werden.</span><span class="sxs-lookup"><span data-stu-id="b3f60-113">Ignoring <xref:System.Windows.UIElement> hit testing policy: This applies when you need to ignore the <xref:System.Windows.UIElement> hit testing policy, which takes into consideration such factors as whether an element is disabled or invisible.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="b3f60-114">Ein vollständiges Codebeispiel für einen Treffertest in der visuellen Ebene finden Sie unter [Beispiel für einen Treffertest mit DrawingVisuals](https://github.com/Microsoft/WPF-Samples/tree/master/Visual%20Layer/DrawingVisual) und [Beispiel für einen Treffertest mit Win32-Interoperabilität](https://github.com/microsoft/WPF-Samples/tree/master/Visual%20Layer/VisualsHitTesting).</span><span class="sxs-lookup"><span data-stu-id="b3f60-114">For a complete code sample illustrating hit testing at the visual layer, see [Hit Test Using DrawingVisuals Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Visual%20Layer/DrawingVisual) and [Hit Test with Win32 Interoperation Sample](https://github.com/microsoft/WPF-Samples/tree/master/Visual%20Layer/VisualsHitTesting).</span></span>  
  
<a name="hit_testing_support"></a>
## <a name="hit-testing-support"></a><span data-ttu-id="b3f60-115">Unterstützung für den Treffertest</span><span class="sxs-lookup"><span data-stu-id="b3f60-115">Hit Testing Support</span></span>  
 <span data-ttu-id="b3f60-116">Der Zweck <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> der Methoden <xref:System.Windows.Media.VisualTreeHelper> in der Klasse besteht darin, zu bestimmen, ob sich ein Geometrie- oder Punktkoordinatenwert innerhalb des gerenderten Inhalts eines bestimmten Objekts befindet, z. B. eines Steuerelements oder Grafikelements.</span><span class="sxs-lookup"><span data-stu-id="b3f60-116">The purpose of the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> methods in the <xref:System.Windows.Media.VisualTreeHelper> class is to determine whether a geometry or point coordinate value is within the rendered content of a given object, such as a control or graphic element.</span></span> <span data-ttu-id="b3f60-117">Sie können beispielsweise den Treffertest verwenden um zu bestimmen, ob ein Mausklick innerhalb des umgebenden Rechtecks eines Objekts in die Geometrie eines Kreises fällt.</span><span class="sxs-lookup"><span data-stu-id="b3f60-117">For example, you could use hit testing to determine whether a mouse click within the bounding rectangle of an object falls within the geometry of a circle.</span></span> <span data-ttu-id="b3f60-118">Sie können auch die Standardimplementierung für den Treffertest überschreiben, um Ihre eigenen benutzerdefinierten Treffertestberechnungen durchzuführen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-118">You can also choose to override the default implementation of hit testing to perform your own custom hit test calculations.</span></span>  
  
 <span data-ttu-id="b3f60-119">Die folgende Abbildung zeigt die Beziehung zwischen dem Bereich eines nicht rechteckigen Objekts und seinem umschließenden Rechteck.</span><span class="sxs-lookup"><span data-stu-id="b3f60-119">The following illustration shows the relationship between a non-rectangular object's region and its bounding rectangle.</span></span>  
  
 <span data-ttu-id="b3f60-120">![Diagramm eines gültigen Treffertestbereichs](./media/wcpsdk-mmgraphics-visuals-hittest-1.png "wcpsdk_mmgraphics_visuals_hittest_1")</span><span class="sxs-lookup"><span data-stu-id="b3f60-120">![Diagram of valid hit test region](./media/wcpsdk-mmgraphics-visuals-hittest-1.png "wcpsdk_mmgraphics_visuals_hittest_1")</span></span>  
<span data-ttu-id="b3f60-121">Diagramm eines gültigen Treffertestbereichs</span><span class="sxs-lookup"><span data-stu-id="b3f60-121">Diagram of valid hit test region</span></span>  
  
<a name="hit_testing_and_z-order"></a>
## <a name="hit-testing-and-z-order"></a><span data-ttu-id="b3f60-122">Treffertest und Z-Reihenfolge</span><span class="sxs-lookup"><span data-stu-id="b3f60-122">Hit Testing and Z-Order</span></span>  
 <span data-ttu-id="b3f60-123">Die visuelle Ebene für [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] unterstützt den Treffertest für alle Objekte unter einem Punkt oder einer Geometrie und nicht nur für das oberste Objekt.</span><span class="sxs-lookup"><span data-stu-id="b3f60-123">The [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] visual layer supports hit testing against all objects under a point or geometry, not just the top-most object.</span></span> <span data-ttu-id="b3f60-124">Die Ergebnisse werden in Z-Reihenfolge zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="b3f60-124">Results are returned in z-order.</span></span> <span data-ttu-id="b3f60-125">Das visuelle Objekt, das Sie als <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> Parameter an die Methode übergeben, bestimmt jedoch, welcher Teil der visuellen Struktur getestet wird.</span><span class="sxs-lookup"><span data-stu-id="b3f60-125">However, the visual object that you pass as the parameter to the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method determines which portion of the visual tree that will be hit test.</span></span> <span data-ttu-id="b3f60-126">Sie können einen Treffertest für die ganze visuelle Struktur oder einen beliebigen Teil davon durchführen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-126">You can hit test against the entire visual tree, or any portion of it.</span></span>  
  
 <span data-ttu-id="b3f60-127">In der folgenden Abbildung befindet sich das Kreisobjekt sowohl auf dem Quadrat als auch auf dem Dreieck.</span><span class="sxs-lookup"><span data-stu-id="b3f60-127">In the following illustration, the circle object is on top of both the square and triangle objects.</span></span> <span data-ttu-id="b3f60-128">Wenn Sie nur daran interessiert sind, das visuelle Objekt zu testen, dessen Wert für die Z-Reihenfolge <xref:System.Windows.Media.HitTestResultCallback> am obersten Wert ist, können Sie die visuelle Treffertest-Enumeration so einstellen, dass sie von der zurückkehrt, um die Treffertestdurchquerung nach dem ersten Element zu <xref:System.Windows.Media.HitTestResultBehavior.Stop> beenden.</span><span class="sxs-lookup"><span data-stu-id="b3f60-128">If you are only interested in hit testing the visual object whose z-order value is top-most, you can set the visual hit test enumeration to return <xref:System.Windows.Media.HitTestResultBehavior.Stop> from the <xref:System.Windows.Media.HitTestResultCallback> to stop the hit test traversal after the first item.</span></span>  
  
 <span data-ttu-id="b3f60-129">![Diagramm der Z&#45;Reihenfolge in einer visuellen Struktur](./media/wcpsdk-mmgraphics-visuals-hittest-2.png "wcpsdk_mmgraphics_visuals_hittest_2")</span><span class="sxs-lookup"><span data-stu-id="b3f60-129">![Diagram of the z&#45;order of a visual tree](./media/wcpsdk-mmgraphics-visuals-hittest-2.png "wcpsdk_mmgraphics_visuals_hittest_2")</span></span>  
<span data-ttu-id="b3f60-130">Diagramm der Z-Reihenfolge einer visuellen Struktur</span><span class="sxs-lookup"><span data-stu-id="b3f60-130">Diagram of the z-order of a visual tree</span></span>  
  
 <span data-ttu-id="b3f60-131">Wenn Sie alle visuellen Objekte unter einem bestimmten Punkt <xref:System.Windows.Media.HitTestResultBehavior.Continue> oder <xref:System.Windows.Media.HitTestResultCallback>einer bestimmten Geometrie aufzählen möchten, kehren Sie aus dem zurück.</span><span class="sxs-lookup"><span data-stu-id="b3f60-131">If you want to enumerate all visual objects under a specific point or geometry, return <xref:System.Windows.Media.HitTestResultBehavior.Continue> from the <xref:System.Windows.Media.HitTestResultCallback>.</span></span> <span data-ttu-id="b3f60-132">Dies bedeutet, dass Sie den Treffertest sogar für vollständig von anderen Objekten überdeckte visuelle Objekte durchführen können.</span><span class="sxs-lookup"><span data-stu-id="b3f60-132">This means you can hit test for visual objects that are beneath other objects, even if they are wholly obscured.</span></span> <span data-ttu-id="b3f60-133">Weitere Informationen finden Sie im Beispielcode im Abschnitt „Verwenden eines Treffertest-Ergebnisrückrufs“.</span><span class="sxs-lookup"><span data-stu-id="b3f60-133">See the sample code in the section "Using a Hit Test Results Callback" for more information.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="b3f60-134">Auch für transparente visuelle Objekte kann der Treffertest durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="b3f60-134">A visual object that is transparent can also be hit test.</span></span>  
  
<a name="using_default_hit_testing"></a>
## <a name="using-default-hit-testing"></a><span data-ttu-id="b3f60-135">Verwenden des Standardtreffertests</span><span class="sxs-lookup"><span data-stu-id="b3f60-135">Using Default Hit Testing</span></span>  
 <span data-ttu-id="b3f60-136">Sie können ermitteln, ob sich ein Punkt innerhalb der <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> Geometrie eines visuellen Objekts befindet, indem Sie die Methode zum Angeben eines visuellen Objekts und eines Punktkoordinatenwerts verwenden, mit dem getestet werden soll.</span><span class="sxs-lookup"><span data-stu-id="b3f60-136">You can identify whether a point is within the geometry of a visual object, by using the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method to specify a visual object and a point coordinate value to test against.</span></span> <span data-ttu-id="b3f60-137">Der visuelle Objektparameter identifiziert den Ausgangspunkt in der visuellen Struktur für die Treffertestsuche.</span><span class="sxs-lookup"><span data-stu-id="b3f60-137">The visual object parameter identifies the starting point in the visual tree for the hit test search.</span></span> <span data-ttu-id="b3f60-138">Wenn ein visuelles Objekt in der visuellen Struktur gefunden wird, deren Geometrie die Koordinate enthält, wird es auf die <xref:System.Windows.Media.HitTestResult.VisualHit%2A> Eigenschaft eines <xref:System.Windows.Media.HitTestResult> Objekts festgelegt.</span><span class="sxs-lookup"><span data-stu-id="b3f60-138">If a visual object is found in the visual tree whose geometry contains the coordinate, it is set to the <xref:System.Windows.Media.HitTestResult.VisualHit%2A> property of a <xref:System.Windows.Media.HitTestResult> object.</span></span> <span data-ttu-id="b3f60-139">Der <xref:System.Windows.Media.HitTestResult> wird dann <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> von der Methode zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="b3f60-139">The <xref:System.Windows.Media.HitTestResult> is then returned from the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span> <span data-ttu-id="b3f60-140">Wenn der Punkt nicht in der visuellen Unterstruktur <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> `null`enthalten ist, die Sie beim Testen drücken, wird zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="b3f60-140">If the point is not contained with the visual sub-tree you are hit testing, <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> returns `null`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="b3f60-141">Der Standardtreffertest gibt immer das oberste Objekt in der Z-Reihenfolge zurück.</span><span class="sxs-lookup"><span data-stu-id="b3f60-141">Default hit testing always returns the top-most object in the z-order.</span></span> <span data-ttu-id="b3f60-142">Wenn Sie alle visuellen Objekte identifizieren möchten – auch diejenigen, die teilweise oder vollständig verdeckt sind –, verwenden Sie einen Treffertest-Ergebnisrückruf.</span><span class="sxs-lookup"><span data-stu-id="b3f60-142">In order to identify all visual objects, even those that may be partly or wholly obscured, use a hit test result callback.</span></span>  
  
 <span data-ttu-id="b3f60-143">Der Koordinatenwert, den Sie als <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> Punktparameter für die Methode übergeben, muss relativ zum Koordinatenraum des visuellen Objekts sein, auf das Sie beim Testen treffen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-143">The coordinate value you pass as the point parameter for the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method has to be relative to the coordinate space of the visual object you are hit testing against.</span></span> <span data-ttu-id="b3f60-144">Wenn Sie beispielsweise visuelle Objekte geschachtelt haben, die im übergeordneten Koordinatenraum bei (100, 100) definiert sind, entspricht der Treffertest eines untergeordneten visuellen Objekts bei (0, 0) dem Treffertest bei (100, 100) im übergeordneten Koordinatenraum.</span><span class="sxs-lookup"><span data-stu-id="b3f60-144">For example, if you have nested visual objects defined at (100, 100) in the parent's coordinate space, then hit testing a child visual at (0, 0) is equivalent to hit testing at (100, 100) in the parent's coordinate space.</span></span>  
  
 <span data-ttu-id="b3f60-145">Der folgende Code zeigt, wie Mausereignishandler <xref:System.Windows.UIElement> für ein Objekt eingerichtet werden, das zum Erfassen von Ereignissen verwendet wird, die für Treffertests verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="b3f60-145">The following code shows how to set up mouse event handlers for a <xref:System.Windows.UIElement> object that is used to capture events used for hit testing.</span></span>  
  
 [!code-csharp[HitTestingOverview#100](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#100)]
 [!code-vb[HitTestingOverview#100](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#100)]  
  
### <a name="how-the-visual-tree-affects-hit-testing"></a><span data-ttu-id="b3f60-146">Beeinflussung des Treffertests durch die visuelle Struktur</span><span class="sxs-lookup"><span data-stu-id="b3f60-146">How the Visual Tree Affects Hit Testing</span></span>  
 <span data-ttu-id="b3f60-147">Der Startpunkt in der visuellen Struktur bestimmt, welche Objekte während der Treffertestenumeration der Objekte zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="b3f60-147">The starting point in the visual tree determines which objects are returned during the hit test enumeration of objects.</span></span> <span data-ttu-id="b3f60-148">Wenn Sie für mehrere Objekte einen Treffertest durchführen möchten, muss das in der visuellen Struktur als Startpunkt verwendete Objekt das gemeinsame übergeordnete Element aller betroffenen Objekte sein.</span><span class="sxs-lookup"><span data-stu-id="b3f60-148">If you have multiple objects you want to hit test, the visual object used as the starting point in the visual tree must be the common ancestor of all objects of interest.</span></span> <span data-ttu-id="b3f60-149">Wenn Sie beispielsweise sowohl für das Schaltflächenelement als auch für das visuelle Zeichnungsobjekt im folgenden Diagramm einen Treffertest durchführen möchten, müssen Sie den Startpunkt in der visuellen Struktur auf das gemeinsame übergeordnete Objekt für diese beiden Elemente festlegen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-149">For example, if you were interested in hit testing both the button element and drawing visual in the following diagram, you would have to set the starting point in the visual tree to the common ancestor of both.</span></span> <span data-ttu-id="b3f60-150">In diesem Fall ist das Canvas-Element das übergeordnete Objekt für das Schaltflächenelement und das visuelle Zeichnungsobjekt.</span><span class="sxs-lookup"><span data-stu-id="b3f60-150">In this case, the canvas element is the common ancestor of both the button element and the drawing visual.</span></span>  
  
 <span data-ttu-id="b3f60-151">![Diagramm einer visuellen Strukturhierarchie](./media/wcpsdk-mmgraphics-visuals-overview-01.gif "wcpsdk_mmgraphics_visuals_overview_01")</span><span class="sxs-lookup"><span data-stu-id="b3f60-151">![Diagram of a visual tree hierarchy](./media/wcpsdk-mmgraphics-visuals-overview-01.gif "wcpsdk_mmgraphics_visuals_overview_01")</span></span>  
<span data-ttu-id="b3f60-152">Diagramm einer visuellen Strukturhierarchie</span><span class="sxs-lookup"><span data-stu-id="b3f60-152">Diagram of a visual tree hierarchy</span></span>  
  
> [!NOTE]
> <span data-ttu-id="b3f60-153">Die <xref:System.Windows.UIElement.IsHitTestVisible%2A> Eigenschaft ruft einen Wert ab <xref:System.Windows.UIElement>oder legt ihn fest, der deklariert, ob ein -derived-Objekt möglicherweise als Treffertestergebnis aus einem Teil des gerenderten Inhalts zurückgegeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="b3f60-153">The <xref:System.Windows.UIElement.IsHitTestVisible%2A> property gets or sets a value that declares whether a <xref:System.Windows.UIElement>-derived object can possibly be returned as a hit test result from some portion of its rendered content.</span></span> <span data-ttu-id="b3f60-154">Dadurch haben Sie die Möglichkeit, selektiv Änderungen an der visuellen Struktur vorzunehmen, um zu bestimmen, welche visuellen Objekte an einem Treffertest beteiligt sind.</span><span class="sxs-lookup"><span data-stu-id="b3f60-154">This allows you to selectively alter the visual tree to determine which visual objects are involved in a hit test.</span></span>  
  
<a name="using_a_hit_test_result_callback"></a>
## <a name="using-a-hit-test-result-callback"></a><span data-ttu-id="b3f60-155">Verwenden eines Treffertest-Ergebnisrückrufs</span><span class="sxs-lookup"><span data-stu-id="b3f60-155">Using a Hit Test Result Callback</span></span>  
 <span data-ttu-id="b3f60-156">Sie können alle visuellen Objekte in einer visuellen Struktur auflisten, deren Geometrie einen angegebenen Koordinatenwert enthält.</span><span class="sxs-lookup"><span data-stu-id="b3f60-156">You can enumerate all visual objects in a visual tree whose geometry contains a specified coordinate value.</span></span> <span data-ttu-id="b3f60-157">Dadurch können Sie alle visuellen Objekte identifizieren, auch diejenigen, die teilweise oder vollständig von anderen visuellen Objekten verdeckt werden.</span><span class="sxs-lookup"><span data-stu-id="b3f60-157">This allows you to identify all visual objects, even those that may be partly or wholly obscured by other visual objects.</span></span> <span data-ttu-id="b3f60-158">Um visuelle Objekte in einer visuellen <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> Struktur aufzuzählen, verwenden Sie die Methode mit einer Treffertestrückruffunktion.</span><span class="sxs-lookup"><span data-stu-id="b3f60-158">To enumerate visual objects in a visual tree use the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method with a hit test callback function.</span></span> <span data-ttu-id="b3f60-159">Die Treffertest-Rückruffunktion wird vom System aufgerufen, wenn der von Ihnen angegebene Koordinatenwert in einem visuellen Objekt enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="b3f60-159">The hit test callback function is called by the system when the coordinate value you specify is contained in a visual object.</span></span>  
  
 <span data-ttu-id="b3f60-160">Während der Auflistung der Treffertestergebnisse sollten Sie keine Vorgänge ausführen, die die visuelle Struktur ändern.</span><span class="sxs-lookup"><span data-stu-id="b3f60-160">During the hit test results enumeration, you should not perform any operation that modifies the visual tree.</span></span> <span data-ttu-id="b3f60-161">Das Hinzufügen oder Entfernen eines Objekts aus der visuellen Struktur, während diese durchlaufen wird, kann zu unvorhersehbarem Verhalten führen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-161">Adding or removing an object from the visual tree while it is being traversed can result in unpredictable behavior.</span></span> <span data-ttu-id="b3f60-162">Sie können die visuelle Struktur <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> sicher ändern, nachdem die Methode zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="b3f60-162">You can safely modify the visual tree after the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method returns.</span></span> <span data-ttu-id="b3f60-163">Sie können eine Datenstruktur bereitstellen, <xref:System.Collections.ArrayList>z. B. eine , um Werte während der Aufzählung der Treffertestergebnisse zu speichern.</span><span class="sxs-lookup"><span data-stu-id="b3f60-163">You may want to provide a data structure, such as an <xref:System.Collections.ArrayList>, to store values during the hit test results enumeration.</span></span>  
  
 [!code-csharp[HitTestingOverview#101](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#101)]
 [!code-vb[HitTestingOverview#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#101)]  
  
 <span data-ttu-id="b3f60-164">Die Treffertest-Rückrufmethode definiert die Aktionen, die ausgeführt werden, wenn ein Treffertest für ein bestimmtes visuelles Objekt in der visuellen Struktur identifiziert wird.</span><span class="sxs-lookup"><span data-stu-id="b3f60-164">The hit test callback method defines the actions you perform when a hit test is identified on a particular visual object in the visual tree.</span></span> <span data-ttu-id="b3f60-165">Nachdem Sie die Aktionen ausgeführt <xref:System.Windows.Media.HitTestResultBehavior> haben, geben Sie einen Wert zurück, der bestimmt, ob die Aufzählung anderer visueller Objekte fortgesetzt werden soll oder nicht.</span><span class="sxs-lookup"><span data-stu-id="b3f60-165">After you perform the actions, you return a <xref:System.Windows.Media.HitTestResultBehavior> value that determines whether to continue the enumeration of any other visual objects or not.</span></span>  
  
 [!code-csharp[HitTestingOverview#102](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#102)]
 [!code-vb[HitTestingOverview#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#102)]  
  
> [!NOTE]
> <span data-ttu-id="b3f60-166">Die Auflistung der visuellen Objekttreffer erfolgt in Z-Reihenfolge.</span><span class="sxs-lookup"><span data-stu-id="b3f60-166">The order of enumeration of hit visual objects is by z-order.</span></span> <span data-ttu-id="b3f60-167">Das visuelle Objekt auf der obersten Z-Reihenfolgenebene ist das erste aufgelistete Objekt.</span><span class="sxs-lookup"><span data-stu-id="b3f60-167">The visual object at the top-most z-order level is the first object enumerated.</span></span> <span data-ttu-id="b3f60-168">Alle anderen visuellen Objekte werden absteigend gemäß der Z-Reihenfolge aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="b3f60-168">Any other visual objects enumerated are at decreasing z-order level.</span></span> <span data-ttu-id="b3f60-169">Diese Auflistungsreihenfolge entspricht der Renderingreihenfolge der grafischen Elemente.</span><span class="sxs-lookup"><span data-stu-id="b3f60-169">This order of enumeration corresponds to the rendering order of the visuals.</span></span>  
  
 <span data-ttu-id="b3f60-170">Sie können die Aufzählung visueller Objekte jederzeit in der Erfolgstestrückruffunktion beenden, indem Sie <xref:System.Windows.Media.HitTestResultBehavior.Stop>zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="b3f60-170">You can stop the enumeration of visual objects at any time in the hit test callback function by returning <xref:System.Windows.Media.HitTestResultBehavior.Stop>.</span></span>  
  
 [!code-csharp[HitTestingOverview#103](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#103)]
 [!code-vb[HitTestingOverview#103](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#103)]  
  
<a name="using_a_hit_test_filter_callback"></a>
## <a name="using-a-hit-test-filter-callback"></a><span data-ttu-id="b3f60-171">Verwenden eines Treffertestfilter-Rückrufs</span><span class="sxs-lookup"><span data-stu-id="b3f60-171">Using a Hit Test Filter Callback</span></span>  
 <span data-ttu-id="b3f60-172">Sie können einen optionalen Treffertestfilter verwenden, um die an die Treffertestergebnisse übergebenen Objekte zu begrenzen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-172">You can use an optional hit test filter to restrict the objects that are passed on to the hit test results.</span></span> <span data-ttu-id="b3f60-173">Dadurch können Sie die Teile der visuellen Struktur ignorieren, die nicht in Ihren Treffertestergebnissen verarbeitet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-173">This allows you to ignore parts of the visual tree that you are not interested in processing in your hit test results.</span></span> <span data-ttu-id="b3f60-174">Um einen Treffertestfilter zu implementieren, definieren Sie eine Treffertestfilterrückruffunktion und <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> übergeben sie beim Aufrufen der Methode als Parameterwert.</span><span class="sxs-lookup"><span data-stu-id="b3f60-174">To implement a hit test filter, you define a hit test filter callback function and pass it as a parameter value when you call the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span>  
  
 [!code-csharp[HitTestingOverview#104](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#104)]
 [!code-vb[HitTestingOverview#104](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#104)]  
  
 <span data-ttu-id="b3f60-175">Wenn Sie die optionale Treffertestfilterrückruffunktion nicht angeben `null` möchten, übergeben <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> Sie einen Wert als Parameter für die Methode.</span><span class="sxs-lookup"><span data-stu-id="b3f60-175">If you do not want to supply the optional hit test filter callback function, pass a `null` value as its parameter for the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span>  
  
 [!code-csharp[HitTestingOverview#105](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#105)]
 [!code-vb[HitTestingOverview#105](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#105)]  
  
 <span data-ttu-id="b3f60-176">![Bereinigen einer visuellen Struktur mithilfe eines Treffertestfilters](./media/filteredvisualtree-01.png "FilteredVisualTree_01")</span><span class="sxs-lookup"><span data-stu-id="b3f60-176">![Pruning a visual tree using a hit test filter](./media/filteredvisualtree-01.png "FilteredVisualTree_01")</span></span>  
<span data-ttu-id="b3f60-177">Reduzieren der Verzweigungen in einer visuellen Struktur</span><span class="sxs-lookup"><span data-stu-id="b3f60-177">Pruning a visual tree</span></span>  
  
 <span data-ttu-id="b3f60-178">Mit der Treffertestfilter-Rückruffunktion können Sie alle visuellen Objekte auflisten, deren gerenderte Inhalte die von Ihnen angegebenen Koordinaten enthalten.</span><span class="sxs-lookup"><span data-stu-id="b3f60-178">The hit test filter callback function allows you to enumerate through all the visuals whose rendered content contains the coordinates you specify.</span></span> <span data-ttu-id="b3f60-179">Sie können jedoch auch bestimmte Verzweigungen der visuellen Struktur ignorieren, die im Rahmen Ihrer Treffertestergebnis-Rückruffunktion nicht verarbeitet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-179">However, you may want to ignore certain branches of the visual tree that you are not interested in processing in your hit test results callback function.</span></span> <span data-ttu-id="b3f60-180">Der Rückgabewert der Treffertestfilter-Rückruffunktion bestimmt, welcher Typ von Aktion von der Enumeration der visuellen Objekte ausgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="b3f60-180">The return value of the hit test filter callback function determines what type of action the enumeration of the visual objects should take.</span></span> <span data-ttu-id="b3f60-181">Wenn Sie z. B. <xref:System.Windows.Media.HitTestFilterBehavior.ContinueSkipSelfAndChildren>den Wert zurückgeben, können Sie das aktuelle visuelle Objekt und seine untergeordneten Objekte aus der Aufzählung der Treffertestergebnisse entfernen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-181">For example, if you return the value, <xref:System.Windows.Media.HitTestFilterBehavior.ContinueSkipSelfAndChildren>, you can remove the current visual object and its children from the hit test results enumeration.</span></span> <span data-ttu-id="b3f60-182">Dies bedeutet, dass für die Treffertestergebnis-Rückruffunktion diese Objekte nicht in der Auflistung enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="b3f60-182">This means that the hit test results callback function will not see these objects in its enumeration.</span></span> <span data-ttu-id="b3f60-183">Durch das Reduzieren der Verzweigungen in der visuellen Struktur von Objekten wird der Verarbeitungsaufwand während der Übergabe der Auflistung von Treffertestergebnissen verringert.</span><span class="sxs-lookup"><span data-stu-id="b3f60-183">Pruning the visual tree of objects decreases the amount of processing during the hit test results enumeration pass.</span></span> <span data-ttu-id="b3f60-184">Im folgenden Codebeispiel überspringt der Filter Bezeichnungen und ihre Nachfolgerelemente und führt für alle anderen Elemente Treffertests durch.</span><span class="sxs-lookup"><span data-stu-id="b3f60-184">In the following code example, the filter skips labels and their descendants and hit tests everything else.</span></span>  
  
 [!code-csharp[HitTestingOverview#106](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#106)]
 [!code-vb[HitTestingOverview#106](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#106)]  
  
> [!NOTE]
> <span data-ttu-id="b3f60-185">Der Treffertestfilter-Rückruf wird gelegentlich aufgerufen, wenn der Treffertestergebnis-Rückruf nicht aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="b3f60-185">The hit test filter callback will sometimes be called in cases where the hit test results callback is not called.</span></span>  
  
<a name="overriding_default_hit_testing"></a>
## <a name="overriding-default-hit-testing"></a><span data-ttu-id="b3f60-186">Überschreiben des Standardtreffertests</span><span class="sxs-lookup"><span data-stu-id="b3f60-186">Overriding Default Hit Testing</span></span>  
 <span data-ttu-id="b3f60-187">Sie können die standardmäßige Treffertestunterstützung eines visuellen <xref:System.Windows.Media.Visual.HitTestCore%2A> Objekts überschreiben, indem Sie die Methode überschreiben.</span><span class="sxs-lookup"><span data-stu-id="b3f60-187">You can override a visual object’s default hit testing support by overriding the <xref:System.Windows.Media.Visual.HitTestCore%2A> method.</span></span> <span data-ttu-id="b3f60-188">Dies bedeutet, dass <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> beim Aufrufen der <xref:System.Windows.Media.Visual.HitTestCore%2A> Methode die überschriebene Implementierung von aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="b3f60-188">This means that when you invoke the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method, your overridden implementation of <xref:System.Windows.Media.Visual.HitTestCore%2A> is called.</span></span> <span data-ttu-id="b3f60-189">Ihre überschriebene Methode wird aufgerufen, wenn sich ein Treffertest innerhalb des umgebenden Rechtecks für das visuelle Objekt befindet. Dies gilt auch dann, wenn die Koordinate außerhalb des gerenderten Inhalts des visuellen Objekts liegt.</span><span class="sxs-lookup"><span data-stu-id="b3f60-189">Your overridden method is called when a hit test falls within the bounding rectangle of the visual object, even if the coordinate falls outside the rendered content of the visual object.</span></span>  
  
 [!code-csharp[HitTestingOverview#107](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#107)]
 [!code-vb[HitTestingOverview#107](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#107)]  
  
 <span data-ttu-id="b3f60-190">Es kann vorkommen, dass Sie einen Treffertest sowohl für das umschließende Rechteck als auch für den gerenderten Inhalt eines visuellen Objekts durchführen möchten.</span><span class="sxs-lookup"><span data-stu-id="b3f60-190">There may be times when you want to hit test against both the bounding rectangle and the rendered content of a visual object.</span></span> <span data-ttu-id="b3f60-191">Wenn Sie `PointHitTestParameters` den Parameterwert <xref:System.Windows.Media.Visual.HitTestCore%2A> in der überschriebenen <xref:System.Windows.Media.Visual.HitTestCore%2A>Methode als Parameter für die Basismethode verwenden, können Sie Aktionen basierend auf einem Treffer des umgebenden Rechtecks eines visuellen Objekts ausführen und dann einen zweiten Treffertest für den gerenderten Inhalt des visuellen Objekts durchführen.</span><span class="sxs-lookup"><span data-stu-id="b3f60-191">By using the `PointHitTestParameters` parameter value in your overridden <xref:System.Windows.Media.Visual.HitTestCore%2A> method as the parameter to the base method <xref:System.Windows.Media.Visual.HitTestCore%2A>, you can perform actions based on a hit of the bounding rectangle of a visual object, and then perform a second hit test against the rendered content of the visual object.</span></span>  
  
 [!code-csharp[HitTestingOverview#108](~/samples/snippets/csharp/VS_Snippets_Wpf/HitTestingOverview/CSharp/Window1.xaml.cs#108)]
 [!code-vb[HitTestingOverview#108](~/samples/snippets/visualbasic/VS_Snippets_Wpf/HitTestingOverview/visualbasic/window1.xaml.vb#108)]  
  
## <a name="see-also"></a><span data-ttu-id="b3f60-192">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="b3f60-192">See also</span></span>

- <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A>
- <xref:System.Windows.Media.HitTestResult>
- <xref:System.Windows.Media.HitTestResultCallback>
- <xref:System.Windows.Media.HitTestFilterCallback>
- <xref:System.Windows.UIElement.IsHitTestVisible%2A>
- [<span data-ttu-id="b3f60-193">Beispiel für Treffertests mit DarwingVisuals</span><span class="sxs-lookup"><span data-stu-id="b3f60-193">Hit Test Using DrawingVisuals Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Visual%20Layer/DrawingVisual)
- [<span data-ttu-id="b3f60-194">Beispiel für Treffertests mit Win32-Interoperabilität</span><span class="sxs-lookup"><span data-stu-id="b3f60-194">Hit Test with Win32 Interoperation Sample</span></span>](https://github.com/microsoft/WPF-Samples/tree/master/Visual%20Layer/VisualsHitTesting)
- [<span data-ttu-id="b3f60-195">Vorgehensweise: Treffertest für eine Geometrie in einem visuellen Objekt</span><span class="sxs-lookup"><span data-stu-id="b3f60-195">Hit Test Geometry in a Visual</span></span>](how-to-hit-test-geometry-in-a-visual.md)
- [<span data-ttu-id="b3f60-196">Treffertest mithilfe eines Win32-Hostcontainers</span><span class="sxs-lookup"><span data-stu-id="b3f60-196">Hit Test Using a Win32 Host Container</span></span>](how-to-hit-test-using-a-win32-host-container.md)
