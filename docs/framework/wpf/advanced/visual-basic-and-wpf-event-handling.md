---
title: Visual Basic- und WPF-Ereignisbehandlung
ms.date: 03/30/2017
helpviewer_keywords:
- Visual Basic [WPF], event handlers
- event handlers [WPF], Visual Basic
ms.assetid: ad4eb9aa-3afc-4a71-8cf6-add3fbea54a1
ms.openlocfilehash: 9a3d579019db4d2b59a0252dbe63b4a6a0468849
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/03/2019
ms.locfileid: "73458304"
---
# <a name="visual-basic-and-wpf-event-handling"></a><span data-ttu-id="113bd-102">Visual Basic- und WPF-Ereignisbehandlung</span><span class="sxs-lookup"><span data-stu-id="113bd-102">Visual Basic and WPF Event Handling</span></span>
<span data-ttu-id="113bd-103">Speziell für die Microsoft Visual Basic .NET-Sprache können Sie das sprachspezifische `Handles`-Schlüsselwort verwenden, um Ereignishandler Instanzen zuzuordnen, anstatt Ereignishandler mit Attributen anzufügen oder die <xref:System.Windows.UIElement.AddHandler%2A>-Methode zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="113bd-103">For the Microsoft Visual Basic .NET language specifically, you can use the language-specific `Handles` keyword to associate event handlers with instances, instead of attaching event handlers with attributes or using the <xref:System.Windows.UIElement.AddHandler%2A> method.</span></span> <span data-ttu-id="113bd-104">Allerdings weist die `Handles`-Technik für das Anfügen von Handlern an Instanzen einige Einschränkungen auf, da die `Handles`-Syntax einige der spezifischen Funktionen von Routingereignissen des [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Ereignissystems nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="113bd-104">However, the `Handles` technique for attaching handlers to instances does have some limitations, because the `Handles` syntax cannot support some of the specific routed event features of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span>  
  
## <a name="using-handles-in-a-wpf-application"></a><span data-ttu-id="113bd-105">Verwenden von „Handles“ in einer WPF-Anwendung</span><span class="sxs-lookup"><span data-stu-id="113bd-105">Using "Handles" in a WPF Application</span></span>  
 <span data-ttu-id="113bd-106">Die Ereignishandler, die über `Handles` mit Instanzen und Ereignissen verbunden sind, müssen alle innerhalb der partiellen Klassendefinition der Instanz definiert sein, die auch eine Anforderung für Ereignishandler darstellt, die über Attributwerte für Elemente zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="113bd-106">The event handlers that are connected to instances and events with `Handles` must all be defined within the partial class declaration of the instance, which is also a requirement for event handlers that are assigned through attribute values on elements.</span></span> <span data-ttu-id="113bd-107">Sie können nur `Handles` für ein Element auf der Seite angeben, das über einen <xref:System.Windows.FrameworkContentElement.Name%2A>-Eigenschafts Wert (oder eine [x:Name-Direktive](../../xaml-services/x-name-directive.md) deklariert) verfügt.</span><span class="sxs-lookup"><span data-stu-id="113bd-107">You can only specify `Handles` for an element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property value (or [x:Name Directive](../../xaml-services/x-name-directive.md) declared).</span></span> <span data-ttu-id="113bd-108">Dies liegt daran, dass der <xref:System.Windows.FrameworkContentElement.Name%2A> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] den Instanzverweis erstellt, der zur Unterstützung des instanzverweisverweisformats erforderlich ist, das von der `Handles`-Syntax benötigt wird</span><span class="sxs-lookup"><span data-stu-id="113bd-108">This is because the <xref:System.Windows.FrameworkContentElement.Name%2A> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] creates the instance reference that is necessary to support the *Instance.Event* reference format required by the `Handles` syntax.</span></span> <span data-ttu-id="113bd-109">Das einzige Element, das ohne <xref:System.Windows.FrameworkContentElement.Name%2A> Verweis für `Handles` verwendet werden kann, ist die Stamm Element Instanz, die die partielle Klasse definiert.</span><span class="sxs-lookup"><span data-stu-id="113bd-109">The only element that can be used for `Handles` without a <xref:System.Windows.FrameworkContentElement.Name%2A> reference is the root-element instance that defines the partial class.</span></span>  
  
 <span data-ttu-id="113bd-110">Sie können mehreren Elemente den gleichen Handler zuweisen, indem Sie *Instance.Event*-Verweise nach `Handles` durch Kommas trennen.</span><span class="sxs-lookup"><span data-stu-id="113bd-110">You can assign the same handler to multiple elements by separating *Instance.Event* references after `Handles` with commas.</span></span>  
  
 <span data-ttu-id="113bd-111">Sie können `Handles` dazu nutzen, um dem gleichen *Instance.Event*-Verweis mehr als einen Handler zuzuweisen.</span><span class="sxs-lookup"><span data-stu-id="113bd-111">You can use `Handles` to assign more than one handler to the same *Instance.Event*reference.</span></span> <span data-ttu-id="113bd-112">Bemessen Sie der Reihenfolge, in der Handler im `Handles`-Verweis gegeben werden, keine Wichtigkeit zu. Sie können davon ausgehen, dass Handler, die dasselbe Ereignis behandlen, in beliebiger Reihenfolge aufgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="113bd-112">Do not assign any importance to the order in which handlers are given in the `Handles` reference; you should assume that handlers that handle the same event can be invoked in any order.</span></span>  
  
 <span data-ttu-id="113bd-113">Um einen Handler zu entfernen, der mit `Handles` in der Deklaration hinzugefügt wurde, können Sie <xref:System.Windows.UIElement.RemoveHandler%2A>abrufen.</span><span class="sxs-lookup"><span data-stu-id="113bd-113">To remove a handler that was added with `Handles` in the declaration, you can call <xref:System.Windows.UIElement.RemoveHandler%2A>.</span></span>  
  
 <span data-ttu-id="113bd-114">Mithilfe von `Handles` können Sie Handler für Routingereignisse anfügen, solange Sie Handler an Instanzen anfügen, die das behandelte Ereignis in ihren Membertabellen definieren.</span><span class="sxs-lookup"><span data-stu-id="113bd-114">You can use `Handles` to attach handlers for routed events, so long as you attach handlers to instances that define the event being handled in their members tables.</span></span> <span data-ttu-id="113bd-115">Für Routing Ereignisse folgen Handler, die mit `Handles` verbunden sind, denselben Routing Regeln wie Handler, die als [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] Attribute angefügt sind, oder mit der allgemeinen Signatur von <xref:System.Windows.UIElement.AddHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="113bd-115">For routed events, handlers that are attached with `Handles` follow the same routing rules as do handlers that are attached as [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] attributes, or with the common signature of <xref:System.Windows.UIElement.AddHandler%2A>.</span></span> <span data-ttu-id="113bd-116">Dies bedeutet Folgendes: Wenn das Ereignis bereits als behandelt markiert ist (die <xref:System.Windows.RoutedEventArgs.Handled%2A>-Eigenschaft in den Ereignisdaten ist `True`), werden Handler, die mit `Handles` verbunden sind, nicht als Antwort auf diese Ereignis Instanz aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="113bd-116">This means that if the event is already marked handled (the <xref:System.Windows.RoutedEventArgs.Handled%2A> property in the event data is `True`), then handlers attached with `Handles` are not invoked in response to that event instance.</span></span> <span data-ttu-id="113bd-117">Das Ereignis kann von Instanzhandlern auf ein anderes Element in der Route oder von der Klassenbehandlung für das aktuelle Element oder frühere Elemente entlang der Route als behandelt markiert werden.</span><span class="sxs-lookup"><span data-stu-id="113bd-117">The event could be marked handled by instance handlers on another element in the route, or by class handling either on the current element or earlier elements along the route.</span></span> <span data-ttu-id="113bd-118">Für Eingabeereignisse, die gekoppelte Tunneling-/Bubblingereignisse unterstützen, kann die Tunnelingroute das Ereignispaar als behandelt markiert haben.</span><span class="sxs-lookup"><span data-stu-id="113bd-118">For input events that support paired tunnel/bubble events, the tunneling route may have marked the event pair handled.</span></span> <span data-ttu-id="113bd-119">Weitere Informationen zu Routingereignissen finden Sie unter [Übersicht über Routingereignisse](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="113bd-119">For more information about routed events, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
## <a name="limitations-of-handles-for-adding-handlers"></a><span data-ttu-id="113bd-120">Einschränkungen von „Handles“ beim Hinzufügen von Handlern</span><span class="sxs-lookup"><span data-stu-id="113bd-120">Limitations of "Handles" for Adding Handlers</span></span>  
 <span data-ttu-id="113bd-121">`Handles` kann für angefügte Ereignisse nicht auf Handler verweisen.</span><span class="sxs-lookup"><span data-stu-id="113bd-121">`Handles` cannot reference handlers for attached events.</span></span> <span data-ttu-id="113bd-122">Verwenden Sie die `add`-Accessormethode für das angefügte Ereignis oder *typename.eventname*-Ereignisattribute in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="113bd-122">You must use the `add` accessor method for that attached event, or *typename.eventname* event attributes in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="113bd-123">Weitere Informationen finden Sie unter [Übersicht über Routingereignisse](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="113bd-123">For details, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="113bd-124">Für Routingereignisse können Sie nur `Handles` dazu verwenden, um Handler für Instanzen zuzuweisen, auf denen das Ereignis in der Instanzmembertabelle vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="113bd-124">For routed events, you can only use `Handles` to assign handlers for instances where that event exists in the instance members table.</span></span> <span data-ttu-id="113bd-125">Mit Routingereignissen kann ein übergeordnetes Element aber im Allgemeinen ein Listener für ein Ereignis aus untergeordneten Elementen sein, selbst wenn dieses Ereignis nicht in der Membertabelle des übergeordneten Elements vorkommt.</span><span class="sxs-lookup"><span data-stu-id="113bd-125">However, with routed events in general, a parent element can be a listener for an event from child elements, even if the parent element does not have that event in its members table.</span></span> <span data-ttu-id="113bd-126">In der Attributsyntax können Sie dies über die *typename.membername*-Attributform angeben, die beschreibt, welcher Typ tatsächlich das zu behandlende Ereignis definiert.</span><span class="sxs-lookup"><span data-stu-id="113bd-126">In attribute syntax, you can specify this through a *typename.membername* attribute form that qualifies which type actually defines the event you want to handle.</span></span> <span data-ttu-id="113bd-127">Beispielsweise kann eine übergeordnete `Page` (ohne `Click` Ereignis definiert) auf Schaltflächen Klick Ereignisse lauschen, indem ein Attribut Handler in der Form `Button.Click`zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="113bd-127">For instance, a parent `Page` (with no `Click` event defined) can listen for button-click events by assigning an attribute handler in the form `Button.Click`.</span></span> <span data-ttu-id="113bd-128">`Handles` unterstützt aber nicht die Form *typename.membername*, da es eine in Konflikt stehende *Instance.Event*-Form unterstützen muss.</span><span class="sxs-lookup"><span data-stu-id="113bd-128">But `Handles` does not support the *typename.membername* form, because it must support a conflicting *Instance.Event* form.</span></span> <span data-ttu-id="113bd-129">Weitere Informationen finden Sie unter [Übersicht über Routingereignisse](routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="113bd-129">For details, see [Routed Events Overview](routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="113bd-130">`Handles` kann keine Handler anfügen, die für Ereignisse aufgerufen werden, die bereits als behandelt markiert sind.</span><span class="sxs-lookup"><span data-stu-id="113bd-130">`Handles` cannot attach handlers that are invoked for events that are already marked handled.</span></span> <span data-ttu-id="113bd-131">Stattdessen müssen Sie Code verwenden und die `handledEventsToo` Überladung von <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>aufrufen.</span><span class="sxs-lookup"><span data-stu-id="113bd-131">Instead, you must use code and call the `handledEventsToo` overload of <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="113bd-132">Verwenden Sie die `Handles`-Syntax in Visual Basic Code nicht, wenn Sie einen Ereignishandler für das gleiche Ereignis in XAML angeben.</span><span class="sxs-lookup"><span data-stu-id="113bd-132">Do not use the `Handles` syntax in Visual Basic code when you specify an event handler for the same event in XAML.</span></span> <span data-ttu-id="113bd-133">In diesem Fall wird der Ereignishandler zweimal aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="113bd-133">In this case, the event handler is called twice.</span></span>  
  
## <a name="how-wpf-implements-handles-functionality"></a><span data-ttu-id="113bd-134">So implementiert WPF die „Handles“-Funktionalität</span><span class="sxs-lookup"><span data-stu-id="113bd-134">How WPF Implements "Handles" Functionality</span></span>  
 <span data-ttu-id="113bd-135">Wenn eine [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] Seite kompiliert wird, deklariert die zwischen Datei `Friend` `WithEvents` Verweise auf jedes Element auf der Seite, das einen <xref:System.Windows.FrameworkContentElement.Name%2A> Eigenschaften Satz (oder eine [x:Name-Direktive](../../xaml-services/x-name-directive.md) deklariert) aufweist.</span><span class="sxs-lookup"><span data-stu-id="113bd-135">When a [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] page is compiled, the intermediate file declares `Friend` `WithEvents` references to every element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property set (or [x:Name Directive](../../xaml-services/x-name-directive.md) declared).</span></span> <span data-ttu-id="113bd-136">Jede benannte Instanz ist potenziell ein Element, das an einem Handler mit `Handles` zugewiesen werden kann.</span><span class="sxs-lookup"><span data-stu-id="113bd-136">Each named instance is potentially an element that can be assigned to a handler through `Handles`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="113bd-137">In Visual Studio kann IntelliSense Ihnen den Abschluss zeigen, für den Elemente für einen `Handles` Verweis in einer Seite verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="113bd-137">Within Visual Studio, IntelliSense can show you completion for which elements are available for a `Handles` reference in a page.</span></span> <span data-ttu-id="113bd-138">Dies kann jedoch einen Kompilierungsschritt dauern, sodass die Zwischendatei alle `Friends`-Verweise auffüllen kann.</span><span class="sxs-lookup"><span data-stu-id="113bd-138">However, this might take one compile pass so that the intermediate file can populate all the `Friends` references.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="113bd-139">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="113bd-139">See also</span></span>

- <xref:System.Windows.UIElement.AddHandler%2A>
- [<span data-ttu-id="113bd-140">Markieren von Routingereignissen als behandelt und Klassenbehandlung</span><span class="sxs-lookup"><span data-stu-id="113bd-140">Marking Routed Events as Handled, and Class Handling</span></span>](marking-routed-events-as-handled-and-class-handling.md)
- [<span data-ttu-id="113bd-141">Übersicht über Routingereignisse</span><span class="sxs-lookup"><span data-stu-id="113bd-141">Routed Events Overview</span></span>](routed-events-overview.md)
- [<span data-ttu-id="113bd-142">Übersicht über XAML (WPF)</span><span class="sxs-lookup"><span data-stu-id="113bd-142">XAML Overview (WPF)</span></span>](../../../desktop-wpf/fundamentals/xaml.md)
