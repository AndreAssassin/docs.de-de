---
title: Abhängigkeitseigenschaften vom Auflistungstyp
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- properties [WPF], dependency
- properties [WPF], collection-type
- dependency properties [WPF]
- collection-type properties [WPF]
ms.assetid: 99f96a42-3ab7-4f64-a16b-2e10d654e97c
ms.openlocfilehash: 9ce0b70bfdd70b47857167ff14e62ed2bbda569d
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "62010695"
---
# <a name="collection-type-dependency-properties"></a><span data-ttu-id="7e54a-102">Abhängigkeitseigenschaften vom Auflistungstyp</span><span class="sxs-lookup"><span data-stu-id="7e54a-102">Collection-Type Dependency Properties</span></span>
<span data-ttu-id="7e54a-103">Dieses Thema enthält einen Leitfaden und empfohlene Muster zur Implementierung einer Abhängigkeitseigenschaft für Eigenschaften vom Auflistungstyp.</span><span class="sxs-lookup"><span data-stu-id="7e54a-103">This topic provides guidance and suggested patterns for how to implement a dependency property where the type of the property is a collection type.</span></span>  

<a name="implementing"></a>   
## <a name="implementing-a-collection-type-dependency-property"></a><span data-ttu-id="7e54a-104">Implementieren einer Abhängigkeitseigenschaft vom Auflistungstyp</span><span class="sxs-lookup"><span data-stu-id="7e54a-104">Implementing a Collection-Type Dependency Property</span></span>  
 <span data-ttu-id="7e54a-105">Für eine Abhängigkeitseigenschaft im Allgemeinen Implementierung, die Sie ausführen, wird Sie definieren eine [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] Eigenschaftenwrapper, in dem diese Eigenschaft basiert auf einer <xref:System.Windows.DependencyProperty> -Bezeichner statt ein Feld oder anderes Konstrukt.</span><span class="sxs-lookup"><span data-stu-id="7e54a-105">For a dependency property in general, the implementation pattern that you follow is that you define a [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] property wrapper, where that property is backed by a <xref:System.Windows.DependencyProperty> identifier rather than a field or other construct.</span></span> <span data-ttu-id="7e54a-106">Folgen Sie diesem Muster auch bei der Implementierung einer Eigenschaft vom Auflistungstyp.</span><span class="sxs-lookup"><span data-stu-id="7e54a-106">You follow this same pattern when you implement a collection-type property.</span></span> <span data-ttu-id="7e54a-107">Eine Eigenschaft vom Auflistungstyp führt jedoch komplexer, das Muster, wenn der Typ, der in der Auflistung enthalten ist, die selbst ist ein <xref:System.Windows.DependencyObject> oder <xref:System.Windows.Freezable> abgeleitete Klasse.</span><span class="sxs-lookup"><span data-stu-id="7e54a-107">However, a collection-type property introduces some complexity to the pattern whenever the type that is contained within the collection is itself a <xref:System.Windows.DependencyObject> or <xref:System.Windows.Freezable> derived class.</span></span>  
  
<a name="initializing"></a>   
## <a name="initializing-the-collection-beyond-the-default-value"></a><span data-ttu-id="7e54a-108">Initialisieren der Auflistung für einen anderen Wert als den Standardwert</span><span class="sxs-lookup"><span data-stu-id="7e54a-108">Initializing the Collection Beyond the Default Value</span></span>  
 <span data-ttu-id="7e54a-109">Beim Erstellen einer Abhängigkeitseigenschaft geben Sie nicht den Standardwert der Eigenschaft als Anfangsfeldwert an.</span><span class="sxs-lookup"><span data-stu-id="7e54a-109">When you create a dependency property, you do not specify the property default value as the initial field value.</span></span> <span data-ttu-id="7e54a-110">Geben Sie den Standardwert stattdessen über die Metadaten für Abhängigkeitseigenschaften an.</span><span class="sxs-lookup"><span data-stu-id="7e54a-110">Instead, you specify the default value through the dependency property metadata.</span></span> <span data-ttu-id="7e54a-111">Handelt es sich bei der Eigenschaft um einen Verweistyp, ist der in den Metadaten für Abhängigkeitseigenschaften angegebene Standardwert kein Standardwert pro Instanz. Er stellt vielmehr einen Standardwert dar, der für alle Instanzen des Typs gilt.</span><span class="sxs-lookup"><span data-stu-id="7e54a-111">If your property is a reference type, the default value specified in dependency property metadata is not a default value per instance; instead it is a default value that applies to all instances of the type.</span></span> <span data-ttu-id="7e54a-112">Achten Sie also darauf, dass Sie nicht die durch die Metadaten für Auflistungseigenschaften definierte, einzelne statische Auflistung als funktionierenden Standardwert für neu erstellte Instanzen des Typs verwenden.</span><span class="sxs-lookup"><span data-stu-id="7e54a-112">Therefore you must be careful to not use the singular static collection defined by the collection property metadata as the working default value for newly created instances of your type.</span></span> <span data-ttu-id="7e54a-113">Vergewissern Sie sich stattdessen, dass Sie den Auflistungswert bewusst als eine eindeutige (Instanz-)Auflistung als Teil Ihrer Klassenkonstruktorlogik festlegen.</span><span class="sxs-lookup"><span data-stu-id="7e54a-113">Instead, you must make sure that you deliberately set the collection value to a unique (instance) collection as part of your class constructor logic.</span></span> <span data-ttu-id="7e54a-114">Andernfalls erstellen Sie unbeabsichtigterweise eine Singleton-Klasse.</span><span class="sxs-lookup"><span data-stu-id="7e54a-114">Otherwise you will have created an unintentional singleton class.</span></span>  
  
 <span data-ttu-id="7e54a-115">Betrachten Sie das folgende Beispiel.</span><span class="sxs-lookup"><span data-stu-id="7e54a-115">Consider the following example.</span></span> <span data-ttu-id="7e54a-116">Der nachfolgende Abschnitt des Beispiels veranschaulicht die Definition einer `Aquarium`-Klasse.</span><span class="sxs-lookup"><span data-stu-id="7e54a-116">The following section of the example shows the definition for a class `Aquarium`.</span></span> <span data-ttu-id="7e54a-117">Die Klasse definiert die Auflistung Typ Abhängigkeitseigenschaft `AquariumObjects`, verwendet die generische <xref:System.Collections.Generic.List%601> Typ mit einem <xref:System.Windows.FrameworkElement> typeinschränkung.</span><span class="sxs-lookup"><span data-stu-id="7e54a-117">The class defines the collection type dependency property `AquariumObjects`, which uses the generic <xref:System.Collections.Generic.List%601> type with a <xref:System.Windows.FrameworkElement> type constraint.</span></span> <span data-ttu-id="7e54a-118">In der <xref:System.Windows.DependencyProperty.Register%28System.String%2CSystem.Type%2CSystem.Type%2CSystem.Windows.PropertyMetadata%29> -Aufruf für die Abhängigkeitseigenschaft, die Metadaten legt den Standardwert als neue generische <xref:System.Collections.Generic.List%601>.</span><span class="sxs-lookup"><span data-stu-id="7e54a-118">In the <xref:System.Windows.DependencyProperty.Register%28System.String%2CSystem.Type%2CSystem.Type%2CSystem.Windows.PropertyMetadata%29> call for the dependency property, the metadata establishes the default value to be a new generic <xref:System.Collections.Generic.List%601>.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport2#CollectionProblemDefinition](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport2/CSharp/page.xaml.cs#collectionproblemdefinition)]
 [!code-vb[PropertiesOvwSupport2#CollectionProblemDefinition](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport2/visualbasic/page.xaml.vb#collectionproblemdefinition)]  
  
 <span data-ttu-id="7e54a-119">Wenn Sie den Code unverändert lassen, wird dieser einzelne Listenstandardwert für alle Instanzen von `Aquarium` freigegeben.</span><span class="sxs-lookup"><span data-stu-id="7e54a-119">However, if you just left the code as shown, that single list default value is shared for all instances of `Aquarium`.</span></span> <span data-ttu-id="7e54a-120">Beim Ausführen des folgenden Testcodes, der zeigen soll, wie zwei getrennte `Aquarium`-Instanzen instanziiert und jeder ein einzelner unterschiedlicher `Fish` hinzugefügt würde, käme es zu einem überraschenden Ergebnis:</span><span class="sxs-lookup"><span data-stu-id="7e54a-120">If you ran the following test code, which is intended to show how you would instantiate two separate `Aquarium` instances and add a single different `Fish` to each of them, you would see a surprising result:</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#CollectionProblemTestCode](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page4.xaml.cs#collectionproblemtestcode)]
 [!code-vb[PropertiesOvwSupport#CollectionProblemTestCode](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page4.xaml.vb#collectionproblemtestcode)]  
  
 <span data-ttu-id="7e54a-121">Anstatt eines Eintrags besitzt jede Auflistung nun zwei!</span><span class="sxs-lookup"><span data-stu-id="7e54a-121">Instead of each collection having a count of one, each collection has a count of two!</span></span> <span data-ttu-id="7e54a-122">Das liegt daran, dass jedes `Aquarium` seinen `Fish` der Standardwertauflistung hinzugefügt hat, die das Ergebnis eines einzelnen Konstruktoraufrufs in den Metadaten ist und daher für alle Instanzen freigegeben ist.</span><span class="sxs-lookup"><span data-stu-id="7e54a-122">This is because each `Aquarium` added its `Fish` to the default value collection, which resulted from a single constructor call in the metadata and is therefore shared between all instances.</span></span> <span data-ttu-id="7e54a-123">Diese Situation ist so gut wie nie erwünscht.</span><span class="sxs-lookup"><span data-stu-id="7e54a-123">This situation is almost never what you want.</span></span>  
  
 <span data-ttu-id="7e54a-124">Zur Behebung des Problems müssen Sie den Abhängigkeitseigenschaftswert der Auflistung auf eine eindeutige Instanz als Teil des Klassenkonstruktoraufrufs zurücksetzen.</span><span class="sxs-lookup"><span data-stu-id="7e54a-124">To correct this problem, you must reset the collection dependency property value to a unique instance, as part of the class constructor call.</span></span> <span data-ttu-id="7e54a-125">Da die Eigenschaft eine schreibgeschützte Abhängigkeitseigenschaft ist, verwenden Sie die <xref:System.Windows.DependencyObject.SetValue%28System.Windows.DependencyPropertyKey%2CSystem.Object%29> Methode, mit der <xref:System.Windows.DependencyPropertyKey> , die nur innerhalb der Klasse zugänglich ist.</span><span class="sxs-lookup"><span data-stu-id="7e54a-125">Because the property is a read-only dependency property, you use the <xref:System.Windows.DependencyObject.SetValue%28System.Windows.DependencyPropertyKey%2CSystem.Object%29> method to set it, using the <xref:System.Windows.DependencyPropertyKey> that is only accessible within the class.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#CollectionProblemCtor](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page4.xaml.cs#collectionproblemctor)]
 [!code-vb[PropertiesOvwSupport#CollectionProblemCtor](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page4.xaml.vb#collectionproblemctor)]  
  
 <span data-ttu-id="7e54a-126">Bei einer erneuten Ausführung des Testcodes wären die Ergebnisse nun eher wie erwartet, da jedes `Aquarium` seine eigene eindeutige Auflistung unterstützen würde.</span><span class="sxs-lookup"><span data-stu-id="7e54a-126">Now, if you ran that same test code again, you could see more expected results, where each `Aquarium` supported its own unique collection.</span></span>  
  
 <span data-ttu-id="7e54a-127">Dieses Muster wäre geringfügig abgewandelt, wenn Sie die Auflistungseigenschaft mit Lese-/Schreibzugriff wählen würden.</span><span class="sxs-lookup"><span data-stu-id="7e54a-127">There would be a slight variation on this pattern if you chose to have your collection property be read-write.</span></span> <span data-ttu-id="7e54a-128">In diesem Fall könnten Sie den öffentlichen Set-Accessor aufrufen, aus dem Konstruktor, um die Initialisierung auszuführen, die weiterhin die nichtschlüsselsignatur von Aufrufen <xref:System.Windows.DependencyObject.SetValue%28System.Windows.DependencyProperty%2CSystem.Object%29> innerhalb Ihres Set-Wrappers mithilfe einer öffentlichen <xref:System.Windows.DependencyProperty> Bezeichner.</span><span class="sxs-lookup"><span data-stu-id="7e54a-128">In that case, you could call the public set accessor from the constructor to do the initialization, which would still be calling the nonkey signature of <xref:System.Windows.DependencyObject.SetValue%28System.Windows.DependencyProperty%2CSystem.Object%29> within your set wrapper, using a public <xref:System.Windows.DependencyProperty> identifier.</span></span>  
  
## <a name="reporting-binding-value-changes-from-collection-properties"></a><span data-ttu-id="7e54a-129">Melden von Bindungswertänderungen durch Auflistungseigenschaften</span><span class="sxs-lookup"><span data-stu-id="7e54a-129">Reporting Binding Value Changes from Collection Properties</span></span>  
 <span data-ttu-id="7e54a-130">Eine Auflistungseigenschaft, die selbst eine Abhängigkeitseigenschaft ist, meldet nicht automatisch Änderungen an die ihr untergeordneten Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="7e54a-130">A collection property that is itself a dependency property does not automatically report changes to its subproperties.</span></span> <span data-ttu-id="7e54a-131">Wenn Sie in einer Auflistung Bindungen erstellen, kann möglicherweise das Melden von Änderungen durch die Bindung verhindert werden, wodurch einige Datenbindungsszenarios ungültig gemacht werden können.</span><span class="sxs-lookup"><span data-stu-id="7e54a-131">If you are creating bindings into a collection, this can prevent the binding from reporting changes, thus invalidating some data binding scenarios.</span></span> <span data-ttu-id="7e54a-132">Allerdings bei der Verwendung des Auflistungstyps <xref:System.Windows.FreezableCollection%601> als Ihren Auflistungstyp dann Untereigenschaften-Änderungen an den darin enthaltenen Elemente in der Auflistung ordnungsgemäß gemeldet, und Bindung funktioniert wie erwartet.</span><span class="sxs-lookup"><span data-stu-id="7e54a-132">However, if you use the collection type <xref:System.Windows.FreezableCollection%601> as your collection type, then subproperty changes to contained elements in the collection are properly reported, and binding works as expected.</span></span>  
  
 <span data-ttu-id="7e54a-133">Um die Bindung von untergeordneten Eigenschaften in einer Auflistung zu ermöglichen, erstellen Sie die Auflistungseigenschaft als Typ <xref:System.Windows.FreezableCollection%601>, mit einer typeinschränkung für diese Sammlung in einen <xref:System.Windows.DependencyObject> abgeleitete Klasse.</span><span class="sxs-lookup"><span data-stu-id="7e54a-133">To enable subproperty binding in a dependency object collection, create the collection property as type <xref:System.Windows.FreezableCollection%601>, with a type constraint for that collection to any <xref:System.Windows.DependencyObject> derived class.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7e54a-134">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="7e54a-134">See also</span></span>

- <xref:System.Windows.FreezableCollection%601>
- [<span data-ttu-id="7e54a-135">XAML- und benutzerdefinierte Klassen für WPF</span><span class="sxs-lookup"><span data-stu-id="7e54a-135">XAML and Custom Classes for WPF</span></span>](xaml-and-custom-classes-for-wpf.md)
- [<span data-ttu-id="7e54a-136">Übersicht zur Datenbindung</span><span class="sxs-lookup"><span data-stu-id="7e54a-136">Data Binding Overview</span></span>](../data/data-binding-overview.md)
- [<span data-ttu-id="7e54a-137">Übersicht über Abhängigkeitseigenschaften</span><span class="sxs-lookup"><span data-stu-id="7e54a-137">Dependency Properties Overview</span></span>](dependency-properties-overview.md)
- [<span data-ttu-id="7e54a-138">Benutzerdefinierte Abhängigkeitseigenschaften</span><span class="sxs-lookup"><span data-stu-id="7e54a-138">Custom Dependency Properties</span></span>](custom-dependency-properties.md)
- [<span data-ttu-id="7e54a-139">Metadaten für Abhängigkeitseigenschaften</span><span class="sxs-lookup"><span data-stu-id="7e54a-139">Dependency Property Metadata</span></span>](dependency-property-metadata.md)
