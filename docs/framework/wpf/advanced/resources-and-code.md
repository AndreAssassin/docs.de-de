---
title: Ressourcen und Code
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- keys [WPF], using objects as
- resources [WPF], accessing from procedural code
- procedural code [WPF], creating resources with
- procedural code [WPF], accessing resources from
- resources [WPF], creating with procedural code
ms.assetid: c1cfcddb-e39c-41c8-a7f3-60984914dfae
ms.openlocfilehash: 3d504467c137c1e3f494e120217957661f4e75a3
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/03/2019
ms.locfileid: "73458756"
---
# <a name="resources-and-code"></a><span data-ttu-id="7d0af-102">Ressourcen und Code</span><span class="sxs-lookup"><span data-stu-id="7d0af-102">Resources and Code</span></span>
<span data-ttu-id="7d0af-103">Diese Übersicht konzentriert sich darauf, wie auf [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]-Ressourcen zugegriffen werden kann oder wie sie mithilfe eines Codes erstellt werden können, anstatt mit [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]-Syntax.</span><span class="sxs-lookup"><span data-stu-id="7d0af-103">This overview concentrates on how [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] resources can be accessed or created using  code rather than [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] syntax.</span></span> <span data-ttu-id="7d0af-104">Weitere Informationen über die allgemeine Ressourcenverwendung und Ressourcen aus einer [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]-Syntaxperspektive finden Sie unter [XAML-Ressourcen](xaml-resources.md).</span><span class="sxs-lookup"><span data-stu-id="7d0af-104">For more information on general resource usage and resources from a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax perspective, see [XAML Resources](xaml-resources.md).</span></span>  

<a name="accessing"></a>   
## <a name="accessing-resources-from-code"></a><span data-ttu-id="7d0af-105">Zugreifen auf Ressourcen aus dem Code</span><span class="sxs-lookup"><span data-stu-id="7d0af-105">Accessing Resources from Code</span></span>  
 <span data-ttu-id="7d0af-106">Die Schlüssel, die Ressourcen identifizieren, wenn sie über [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] festgelegt sind, werden auch verwendet, um bestimmte Ressourcen abrufen, wenn Sie die Ressource im Code anfordern.</span><span class="sxs-lookup"><span data-stu-id="7d0af-106">The keys that identify resources if they are defined through [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] are also used to retrieve specific resources if you request the resource in code.</span></span> <span data-ttu-id="7d0af-107">Die einfachste Methode zum Abrufen einer Ressource aus dem Code besteht darin, entweder die <xref:System.Windows.FrameworkElement.FindResource%2A> oder die <xref:System.Windows.FrameworkElement.TryFindResource%2A>-Methode von Objekten auf Frameworkebene in der Anwendung aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="7d0af-107">The simplest way to retrieve a resource from code is to call either the <xref:System.Windows.FrameworkElement.FindResource%2A> or the <xref:System.Windows.FrameworkElement.TryFindResource%2A> method from framework-level objects in your application.</span></span> <span data-ttu-id="7d0af-108">Der Verhaltensunterschiede zwischen diesen Methoden ist: Was geschieht, wenn der angeforderte Schlüssel nicht gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="7d0af-108">The behavioral difference between these methods is what happens if the requested key is not found.</span></span> <span data-ttu-id="7d0af-109"><xref:System.Windows.FrameworkElement.FindResource%2A> löst eine Ausnahme aus. <xref:System.Windows.FrameworkElement.TryFindResource%2A> gibt keine Ausnahme aus, sondern gibt `null`zurück.</span><span class="sxs-lookup"><span data-stu-id="7d0af-109"><xref:System.Windows.FrameworkElement.FindResource%2A> raises an exception; <xref:System.Windows.FrameworkElement.TryFindResource%2A> will not raise an exception but returns `null`.</span></span> <span data-ttu-id="7d0af-110">Jede Methode verwendet den Ressourcenschlüssel als Eingabeparameter und gibt ein lose typisiertes Objekt zurück.</span><span class="sxs-lookup"><span data-stu-id="7d0af-110">Each method takes the resource key as an input parameter, and returns a loosely typed object.</span></span> <span data-ttu-id="7d0af-111">In der Regel ist der Ressourcenschlüssel eine Zeichenfolge, aber es gibt gelegentlich Objektressourcenverwendungen; mehr dazu finden Sie unter dem Abschnitt [Verwendung von Objekten als Schlüssel](#objectaskey).</span><span class="sxs-lookup"><span data-stu-id="7d0af-111">Typically, a resource key is a string, but there are occasional nonstring usages; see the [Using Objects as Keys](#objectaskey) section for details.</span></span> <span data-ttu-id="7d0af-112">In der Regel wandeln Sie das zurückgegebene Objekt, durch die Eigenschaft, die Sie beim Anfordern der Ressourcen festlegen, in den erforderlichen Typ um.</span><span class="sxs-lookup"><span data-stu-id="7d0af-112">Typically you would cast the returned object to the type required by the property that you are setting when requesting the resource.</span></span> <span data-ttu-id="7d0af-113">Die Suchlogik für die Coderessourcenauflösung ist identisch mit dem dynamischen [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]-Ressourcenverweisfall.</span><span class="sxs-lookup"><span data-stu-id="7d0af-113">The lookup logic for code resource resolution is the same as the dynamic resource reference [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] case.</span></span> <span data-ttu-id="7d0af-114">Die Suche nach Ressourcen beginnt beim aufrufenden Element und wird anschließend bei aufeinanderfolgenden, übergeordneten Elementen in der logischen Struktur fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="7d0af-114">The search for resources starts from the calling element, then continues to successive parent elements in the logical tree.</span></span> <span data-ttu-id="7d0af-115">Die Suche wird in den Anwendungsressourcen, Designs und bei Bedarf in den Systemressourcen fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="7d0af-115">The lookup continues onwards into application resources, themes, and system resources if necessary.</span></span> <span data-ttu-id="7d0af-116">Eine Codeanforderung für eine Ressource wird Laufzeitänderungen in Ressourcenwörterbüchern ordnungsgemäß erfassen, die möglicherweise anschließend von diesem Ressourcenverzeichnis erfolgen, das von [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] aus geladen wurde, und auch für die Echtzeit-Systemressourcenänderungen.</span><span class="sxs-lookup"><span data-stu-id="7d0af-116">A code request for a resource will properly account for runtime changes in resource dictionaries that might have been made subsequent to that resource dictionary being loaded from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], and also for realtime system resource changes.</span></span>  
  
 <span data-ttu-id="7d0af-117">Im folgenden finden Sie ein kurzes Codebeispiel, das eine Ressource nach Schlüssel findet und den zurückgegebenen Wert verwendet, um eine Eigenschaft festzulegen, die als <xref:System.Windows.Controls.Primitives.ButtonBase.Click> Ereignishandler implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="7d0af-117">The following is a brief code example that finds a resource by key and uses the returned value to set a property, implemented as a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page3.xaml.cs#resourceproceduralget)]
 [!code-vb[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page3.xaml.vb#resourceproceduralget)]  
  
 <span data-ttu-id="7d0af-118">Eine alternative Methode zum Zuweisen eines Ressourcen Verweises ist <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d0af-118">An alternative method for assigning a resource reference is <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span></span> <span data-ttu-id="7d0af-119">Diese Methode akzeptiert zwei Parameter: Den Schlüssel der Ressource und den Bezeichner für eine bestimmte Abhängigkeitseigenschaft, die in der Elementinstanz vorhanden ist, der der Wert zugewiesen werden soll.</span><span class="sxs-lookup"><span data-stu-id="7d0af-119">This method takes two parameters: the key of the resource, and the identifier for a particular dependency property that is present on the element instance to which the resource value should be assigned.</span></span> <span data-ttu-id="7d0af-120">Konkret ist diese Methode die Gleiche und hat den Vorteil, dass keine Umwandlung von Rückgabewerten erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="7d0af-120">Functionally, this method is the same and has the advantage of not requiring any casting of return values.</span></span>  
  
 <span data-ttu-id="7d0af-121">Eine weitere Möglichkeit, Programm gesteuert auf Ressourcen zuzugreifen, ist der Zugriff auf den Inhalt der <xref:System.Windows.FrameworkElement.Resources%2A>-Eigenschaft als Wörterbuch.</span><span class="sxs-lookup"><span data-stu-id="7d0af-121">Still another way to access resources programmatically is to access the contents of the <xref:System.Windows.FrameworkElement.Resources%2A> property as a dictionary.</span></span> <span data-ttu-id="7d0af-122">Durch das Zugreifen auf das Wörterbuch, das in dieser Eigenschaft enthalten ist, können Sie auch neue Ressourcen zu vorhandenen Auflistungen hinzufügen. Überprüfen Sie, ob ein angegebener Schlüsselname in der Auflistung vergeben ist, und überprüfen Sie auch andere Vorgänge im Wörterbuch bzw. in der Auflistung.</span><span class="sxs-lookup"><span data-stu-id="7d0af-122">Accessing the dictionary contained by this property is also how you can add new resources to existing collections, check to see if a given key name is already taken in the collection, and other dictionary/collection operations.</span></span> <span data-ttu-id="7d0af-123">Wenn Sie eine [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Anwendung vollständig in Code schreiben, können Sie auch die gesamte Auflistung im Code erstellen, Ihr Schlüssel zuweisen und dann die fertige Auflistung der <xref:System.Windows.FrameworkElement.Resources%2A>-Eigenschaft eines eingerichteten Elements zuweisen.</span><span class="sxs-lookup"><span data-stu-id="7d0af-123">If you are writing a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application entirely in code, you can also create the entire collection in code, assign keys to it, and then assign the finished collection to the <xref:System.Windows.FrameworkElement.Resources%2A> property of an established element.</span></span> <span data-ttu-id="7d0af-124">Dies wird im nächsten Abschnitt erläutert.</span><span class="sxs-lookup"><span data-stu-id="7d0af-124">This will be described in the next section.</span></span>  
  
 <span data-ttu-id="7d0af-125">Sie können innerhalb einer beliebigen <xref:System.Windows.FrameworkElement.Resources%2A> Auflistung indizieren, indem Sie einen bestimmten Schlüssel als Index verwenden. Beachten Sie jedoch, dass der Zugriff auf die Ressource auf diese Weise nicht den normalen Lauf Zeit Regeln der Ressourcen Auflösung entspricht.</span><span class="sxs-lookup"><span data-stu-id="7d0af-125">You can index within any given <xref:System.Windows.FrameworkElement.Resources%2A> collection, using a specific key as the index, but you should be aware that accessing the resource in this way does not follow the normal runtime rules of resource resolution.</span></span> <span data-ttu-id="7d0af-126">Sie greifen nur auf diese bestimmte Auflistung zu.</span><span class="sxs-lookup"><span data-stu-id="7d0af-126">You are only accessing that particular collection.</span></span> <span data-ttu-id="7d0af-127">Die Ressourcensuche wird nicht den Geltungsbereich bis zum Stamm oder der Anwendung durchlaufen, wenn kein gültiges Objekt beim angeforderten Schlüssel gefunden wurde.</span><span class="sxs-lookup"><span data-stu-id="7d0af-127">Resource lookup will not be traversing the scope to the root or the application if no valid object was found at the requested key.</span></span> <span data-ttu-id="7d0af-128">Dieser Ansatz hat jedoch Leistungsvorteile in einigen Fällen, möglicherweise gerade weil der Suchbereich für den Schlüssel eingeschränkter ist.</span><span class="sxs-lookup"><span data-stu-id="7d0af-128">However, this approach may have performance advantages in some cases precisely because the scope of the search for the key is more constrained.</span></span> <span data-ttu-id="7d0af-129">Weitere Informationen zur direkten Arbeit mit dem Ressourcen Wörterbuch finden Sie in der <xref:System.Windows.ResourceDictionary>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="7d0af-129">See the <xref:System.Windows.ResourceDictionary> class for more details on how to work with the resource dictionary directly.</span></span>  
  
<a name="creating"></a>   
## <a name="creating-resources-with-code"></a><span data-ttu-id="7d0af-130">Erstellen von Ressourcen mit Code</span><span class="sxs-lookup"><span data-stu-id="7d0af-130">Creating Resources with Code</span></span>  
 <span data-ttu-id="7d0af-131">Wenn Sie eine gesamte [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Anwendung im Code erstellen möchten, möchten Sie möglicherweise auch alle Ressourcen in dieser Anwendung im Code erstellen.</span><span class="sxs-lookup"><span data-stu-id="7d0af-131">If you want to create an entire [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application in code, you might also want to create any resources in that application in code.</span></span> <span data-ttu-id="7d0af-132">Um dies zu erreichen, erstellen Sie eine neue <xref:System.Windows.ResourceDictionary> Instanz, und fügen Sie dann alle Ressourcen zum Wörterbuch hinzu, indem Sie aufeinander folgende Aufrufe von <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>verwenden.</span><span class="sxs-lookup"><span data-stu-id="7d0af-132">To achieve this, create a new <xref:System.Windows.ResourceDictionary> instance, and then add all the resources to the dictionary using successive calls to <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="7d0af-133">Verwenden Sie dann die <xref:System.Windows.ResourceDictionary>, die erstellt wurde, um die <xref:System.Windows.FrameworkElement.Resources%2A>-Eigenschaft für ein Element festzulegen, das in einem Seitenbereich oder in der <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="7d0af-133">Then, use the <xref:System.Windows.ResourceDictionary> thus created to set the <xref:System.Windows.FrameworkElement.Resources%2A> property on an element that is present in a page scope, or the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="7d0af-134">Sie können die <xref:System.Windows.ResourceDictionary> auch als eigenständiges Objekt verwalten, ohne es einem Element hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="7d0af-134">You could also maintain the <xref:System.Windows.ResourceDictionary> as a standalone object without adding it to an element.</span></span> <span data-ttu-id="7d0af-135">Wenn Sie dies jedoch tun, müssen Sie mit einem Elementschlüssel auf die darin enthaltenen Ressourcen zugreifen, als handele es sich um ein generisches Wörterbuch.</span><span class="sxs-lookup"><span data-stu-id="7d0af-135">However, if you do this, you must access the resources within it by item key, as if it were a generic dictionary.</span></span> <span data-ttu-id="7d0af-136">Eine <xref:System.Windows.ResourceDictionary>, die nicht an ein Element `Resources` Eigenschaft angefügt ist, ist nicht als Teil der Elementstruktur vorhanden und weist keinen Bereich in einer Such Sequenz auf, der von <xref:System.Windows.FrameworkElement.FindResource%2A> und zugehörigen Methoden verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="7d0af-136">A <xref:System.Windows.ResourceDictionary> that is not attached to an element `Resources` property would not  exist as part of the element tree and has no scope in a lookup sequence that can be used by <xref:System.Windows.FrameworkElement.FindResource%2A> and related methods.</span></span>  
  
<a name="objectaskey"></a>   
## <a name="using-objects-as-keys"></a><span data-ttu-id="7d0af-137">Verwendung von Objekten als Schlüssel</span><span class="sxs-lookup"><span data-stu-id="7d0af-137">Using Objects as Keys</span></span>  
 <span data-ttu-id="7d0af-138">Die meisten Ressourcenverwendungen werden den Schlüssel der Ressource als eine Zeichenfolge festlegen.</span><span class="sxs-lookup"><span data-stu-id="7d0af-138">Most resource usages will set the key of the resource to be a string.</span></span> <span data-ttu-id="7d0af-139">Verschiedene [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Funktionen verwenden jedoch absichtlich keinen Zeichenfolgetyp, um Schlüssel anzugeben, stattdessen ist dieser Parameter ein Objekt.</span><span class="sxs-lookup"><span data-stu-id="7d0af-139">However, various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features deliberately do not use a string type to specify keys, instead this parameter is an object.</span></span> <span data-ttu-id="7d0af-140">Die Fähigkeit, die Ressource mit einem Objekt zu verschlüsseln, wird vom [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Stil und der Designunterstützung verwendet.</span><span class="sxs-lookup"><span data-stu-id="7d0af-140">The capability of having the resource be keyed by an object is used by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] style and theming support.</span></span> <span data-ttu-id="7d0af-141">Die Stile in Designs, die zum Standardstil für ein anderweitig nicht formatiertes Steuerelement werden, sind jeweils durch den <xref:System.Type> des Steuer Elements verschlüsselt, auf das Sie angewendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="7d0af-141">The styles in themes which become the default style for an otherwise non-styled control are each keyed by the <xref:System.Type> of the control that they should apply to.</span></span> <span data-ttu-id="7d0af-142">Die Verschlüsselung nach dem Typ bietet einen zuverlässigen Suchmechanismus, der in den Standardinstanzen jedes Steuerelementtyps funktioniert, und der Typ kann durch Reflektion ermittelt und für die Formatierung abgeleiteter Klassen verwendet werden, obwohl der abgeleitete Typ andernfalls kein Standardformat hat.</span><span class="sxs-lookup"><span data-stu-id="7d0af-142">Being keyed by type provides a reliable lookup mechanism that works on default instances of each control type, and type can be detected by reflection and used for styling derived classes even though the derived type otherwise has no default style.</span></span> <span data-ttu-id="7d0af-143">Sie können einen <xref:System.Type> Schlüssel für eine in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] definierte Ressource angeben, indem Sie die [x:Type-Markup Erweiterung](../../xaml-services/x-type-markup-extension.md)verwenden.</span><span class="sxs-lookup"><span data-stu-id="7d0af-143">You can specify a <xref:System.Type> key for a resource defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] by using the [x:Type Markup Extension](../../xaml-services/x-type-markup-extension.md).</span></span> <span data-ttu-id="7d0af-144">Ähnliche Erweiterungen sind für andere Schlüsselverwendungen vorhanden, die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Funktionen, wie z.B. [ComponentResourceKey-Markuperweiterungen](componentresourcekey-markup-extension.md), unterstützen.</span><span class="sxs-lookup"><span data-stu-id="7d0af-144">Similar extensions exist for other nonstring key usages that support [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features, such as [ComponentResourceKey Markup Extension](componentresourcekey-markup-extension.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7d0af-145">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="7d0af-145">See also</span></span>

- [<span data-ttu-id="7d0af-146">XAML-Ressourcen</span><span class="sxs-lookup"><span data-stu-id="7d0af-146">XAML Resources</span></span>](xaml-resources.md)
- [<span data-ttu-id="7d0af-147">Erstellen von Formaten und Vorlagen</span><span class="sxs-lookup"><span data-stu-id="7d0af-147">Styling and Templating</span></span>](../../../desktop-wpf/fundamentals/styles-templates-overview.md)
