---
title: Übersicht über WPF-Add-Ins
ms.date: 03/30/2017
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
ms.openlocfilehash: a146f15a1c2755f254e198d471a42ca9ec29b072
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/23/2019
ms.locfileid: "71182535"
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="b29b0-102">Übersicht über WPF-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="b29b0-102">WPF Add-Ins Overview</span></span>

<a name="Introduction"></a><span data-ttu-id="b29b0-103">Die .NET Framework enthält ein Add-in-Modell, mit dem Entwickler Anwendungen erstellen können, die Add-in-Erweiterbarkeit unterstützen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-103">The .NET Framework includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="b29b0-104">Dieses Add-In-Modell ermöglicht die Erstellung von Add-Ins, die in die Anwendungsfunktionalität integriert werden und diese erweitern.</span><span class="sxs-lookup"><span data-stu-id="b29b0-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="b29b0-105">In einigen Szenarien müssen Anwendungen auch Benutzeroberflächen anzeigen, die von Add-ins bereitgestellt werden. In diesem Thema wird gezeigt, wie WPF das .NET Framework Add-in-Modell erweitert, um diese Szenarien, die dahinter liegende Architektur, die Vorteile und die Einschränkungen zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-105">In some scenarios, applications also need to display user interfaces that are provided by add-ins. This topic shows how WPF augments the .NET Framework add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>

<a name="Requirements"></a>

## <a name="prerequisites"></a><span data-ttu-id="b29b0-106">Erforderliche Komponenten</span><span class="sxs-lookup"><span data-stu-id="b29b0-106">Prerequisites</span></span>

<span data-ttu-id="b29b0-107">Vertrautheit mit dem .NET Framework Add-in-Modell ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="b29b0-107">Familiarity with the .NET Framework add-in model is required.</span></span> <span data-ttu-id="b29b0-108">Weitere Informationen finden Sie unter [Add-Ins und Erweiterbarkeit](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span><span class="sxs-lookup"><span data-stu-id="b29b0-108">For more information, see [Add-ins and Extensibility](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span></span>

<a name="AddInsOverview"></a>

## <a name="add-ins-overview"></a><span data-ttu-id="b29b0-109">Übersicht über Add-Ins</span><span class="sxs-lookup"><span data-stu-id="b29b0-109">Add-Ins Overview</span></span>

<span data-ttu-id="b29b0-110">Um das mit dem Integrieren neuer Funktionen verbundene erneute Kompilieren und Bereitstellen von Anwendungen zu vermeiden, da diese Vorgänge sehr komplex sind, sind Anwendungen mit Erweiterbarkeitsmechanismen ausgestattet. Diese ermöglichen Entwicklern (sowohl Erst- als auch Drittanbieter) das Erstellen anderer Anwendungen, die integriert werden können.</span><span class="sxs-lookup"><span data-stu-id="b29b0-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="b29b0-111">Diese Art von Erweiterbarkeit wird in der Regel durch die Verwendung von Add-Ins (auch als „Add-Ons“ oder „Plug-Ins“ bezeichnet) unterstützt.</span><span class="sxs-lookup"><span data-stu-id="b29b0-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="b29b0-112">Es folgen Beispiele für reale Anwendungen, die eine Erweiterbarkeit mit Add-Ins verfügbar machen:</span><span class="sxs-lookup"><span data-stu-id="b29b0-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>

- <span data-ttu-id="b29b0-113">Internet Explorer-Add-Ons</span><span class="sxs-lookup"><span data-stu-id="b29b0-113">Internet Explorer add-ons.</span></span>

- <span data-ttu-id="b29b0-114">Windows Media Player-Plug-Ins</span><span class="sxs-lookup"><span data-stu-id="b29b0-114">Windows Media Player plug-ins.</span></span>

- <span data-ttu-id="b29b0-115">Visual Studio-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="b29b0-115">Visual Studio add-ins.</span></span>

<span data-ttu-id="b29b0-116">Beispielsweise können Drittanbieterentwickler mithilfe des Add-In-Modells von Windows Media Player „Plug-Ins“ implementieren, durch die der Windows Media Player auf vielfältige Weise erweitert wird. Dazu zählen das Erstellen von Decodern und Encodern für Medienformate, für die keine systemeigene Unterstützung durch Windows Media Player besteht (z. B. DVD, MP3), Audioeffekte und Skins.</span><span class="sxs-lookup"><span data-stu-id="b29b0-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="b29b0-117">Jedes Add-In-Modell ist so aufgebaut, dass es die zu einer Anwendung gehörenden Funktionen verfügbar macht, obwohl verschiedene Entitäten und Verhaltensweisen für alle Add-In-Modelle gelten.</span><span class="sxs-lookup"><span data-stu-id="b29b0-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>

<span data-ttu-id="b29b0-118">Die drei Hauptentitäten typischer Add-In-Erweiterbarkeitslösungen sind *Verträge*, *Add-Ins* und *Hostanwendungen*.</span><span class="sxs-lookup"><span data-stu-id="b29b0-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="b29b0-119">Mit Verträgen wird auf zwei Arten definiert, wie Add-Ins mit Hostanwendungen integriert sind:</span><span class="sxs-lookup"><span data-stu-id="b29b0-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>

- <span data-ttu-id="b29b0-120">Add-Ins sind in Funktionen integriert, die von Hostanwendungen implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>

- <span data-ttu-id="b29b0-121">Hostanwendungen machen Funktionen verfügbar, in die Add-Ins integriert werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-121">Host applications expose functionality for add-ins to integrate with.</span></span>

<span data-ttu-id="b29b0-122">Damit Add-Ins verwendet werden können, müssen sie von Hostanwendungen gefunden und zur Laufzeit geladen werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="b29b0-123">Daher sind Anwendungen, die Add-Ins unterstützen, zusätzlich für folgende Aufgaben verantwortlich:</span><span class="sxs-lookup"><span data-stu-id="b29b0-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>

- <span data-ttu-id="b29b0-124">Ermittlung: Suchen von Add-Ins, die Verträge einhalten, die von Host Anwendungen unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>

- <span data-ttu-id="b29b0-125">**Aktivierung**: Laden, ausführen und Einrichten der Kommunikation mit Add-Ins.</span><span class="sxs-lookup"><span data-stu-id="b29b0-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>

- <span data-ttu-id="b29b0-126">**Isolation**: Verwenden von Anwendungs Domänen oder Prozessen zum Einrichten von Isolations Grenzen, mit denen Anwendungen vor potenziellen Sicherheits-und Ausführungs Problemen mit Add-Ins geschützt werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>

- <span data-ttu-id="b29b0-127">**Kommunikation**: Zulassen, dass Add-Ins und Host Anwendungen über Isolations Grenzen hinweg miteinander kommunizieren, indem Methoden aufgerufen und Daten übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>

- <span data-ttu-id="b29b0-128">**Verwaltung der Lebensdauer**: Laden und Entladen von Anwendungs Domänen und Prozessen auf eine saubere, vorhersagbare Weise (siehe [Anwendungs Domänen](../../app-domains/application-domains.md)).</span><span class="sxs-lookup"><span data-stu-id="b29b0-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../app-domains/application-domains.md)).</span></span>

- <span data-ttu-id="b29b0-129">**Versionsverwaltung**: Sicherstellen, dass Host Anwendungen und Add-Ins auch dann kommunizieren können, wenn neue Versionen von erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>

<span data-ttu-id="b29b0-130">Letztlich ist es eine wichtige Aufgabe, ein stabiles Add-In-Modell zu entwickeln.</span><span class="sxs-lookup"><span data-stu-id="b29b0-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="b29b0-131">Aus diesem Grund stellt die .NET Framework eine Infrastruktur zum Entwickeln von Add-in-Modellen bereit.</span><span class="sxs-lookup"><span data-stu-id="b29b0-131">For this reason, the .NET Framework provides an infrastructure for building add-in models.</span></span>

> [!NOTE]
> <span data-ttu-id="b29b0-132">Weitere Informationen zu Add-Ins finden Sie unter [Add-Ins und Erweiterbarkeit](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span><span class="sxs-lookup"><span data-stu-id="b29b0-132">For more detailed information on add-ins, see [Add-ins and Extensibility](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)).</span></span>

<a name="NETFrameworkAddInModelOverview"></a>

## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="b29b0-133">Übersicht über das Add-In-Modell von .NET Framework</span><span class="sxs-lookup"><span data-stu-id="b29b0-133">.NET Framework Add-In Model Overview</span></span>

<span data-ttu-id="b29b0-134">Das .NET Framework Add-in-Modell, das im <xref:System.AddIn> -Namespace enthalten ist, enthält einen Satz von Typen, die entwickelt wurden, um die Entwicklung der Add-in-Erweiterbarkeit zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-134">The .NET Framework add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="b29b0-135">Die grundlegende Einheit des .NET Framework Add-in-Modells ist der *Vertrag*, der definiert, wie eine Host Anwendung und ein Add-in miteinander kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="b29b0-135">The fundamental unit of the .NET Framework add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="b29b0-136">Ein Vertrag wird mit einer für Hostanwendungen spezifischen *Ansicht* des Vertrags für eine Hostanwendung verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="b29b0-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="b29b0-137">Auf ähnliche Weise wird eine für Add-Ins spezifische *Ansicht* des Vertrags für das Add-In verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="b29b0-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="b29b0-138">Ein *Adapter* ermöglicht es einer Hostanwendung und einem Add-In, zwischen ihren jeweiligen Ansichten des Vertrags miteinander zu kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="b29b0-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="b29b0-139">Verträge, Ansichten und Adapter werden als Segmente bezeichnet, und mehrere miteinander verbundene Segmente stellen eine *Pipeline* dar.</span><span class="sxs-lookup"><span data-stu-id="b29b0-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="b29b0-140">Pipelines sind die Grundlage, auf der das .NET Framework-Add-in-Modell Ermittlung, Aktivierung, Sicherheits Isolation, Ausführungs Isolation (unter Verwendung von Anwendungs Domänen und Prozessen), Kommunikation, Verwaltung von Lebensdauer und Versionsverwaltung unterstützt.</span><span class="sxs-lookup"><span data-stu-id="b29b0-140">Pipelines are the foundation upon which the .NET Framework add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>

<span data-ttu-id="b29b0-141">Mit dieser Unterstützung können Entwickler Add-Ins erstellen, die mit den Funktionen einer Hostanwendung integriert werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="b29b0-142">Einige Szenarien erfordern jedoch, dass Host Anwendungen Benutzeroberflächen anzeigen, die von Add-ins bereitgestellt werden. Da jede Präsentationstechnologie in der .NET Framework über ein eigenes Modell zum Implementieren von Benutzeroberflächen verfügt, unterstützt das .NET Framework Add-in-Modell keine bestimmte Präsentationstechnologie.</span><span class="sxs-lookup"><span data-stu-id="b29b0-142">However, some scenarios require host applications to display user interfaces provided by add-ins. Because each presentation technology in the .NET Framework has its own model for implementing user interfaces, the .NET Framework add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="b29b0-143">Stattdessen erweitert WPF das .NET Framework Add-in-Modell mit UI-Unterstützung für Add-Ins.</span><span class="sxs-lookup"><span data-stu-id="b29b0-143">Instead, WPF extends the .NET Framework add-in model with UI support for add-ins.</span></span>

<a name="WPFAddInModel"></a>

## <a name="wpf-add-ins"></a><span data-ttu-id="b29b0-144">WPF-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="b29b0-144">WPF Add-Ins</span></span>

<span data-ttu-id="b29b0-145">WPF ermöglicht es Ihnen in Verbindung mit dem .NET Framework-Add-in-Modell, eine Vielzahl von Szenarien zu adressieren, die es erfordern, dass Host Anwendungen Benutzeroberflächen von Add-Ins anzeigen. Insbesondere werden diese Szenarien von WPF mit den folgenden zwei Programmier Modellen adressiert:</span><span class="sxs-lookup"><span data-stu-id="b29b0-145">WPF, in conjunction with the .NET Framework add-in model, allows you to address a wide variety of scenarios that require host applications to display user interfaces from add-ins. In particular, these scenarios are addressed by WPF with the following two programming models:</span></span>

1. <span data-ttu-id="b29b0-146">**Das Add-In gibt eine Benutzeroberfläche zurück**.</span><span class="sxs-lookup"><span data-stu-id="b29b0-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="b29b0-147">Ein Add-in gibt eine Benutzeroberfläche an die Host Anwendung über einen Methoden Befehl zurück, wie vom Vertrag definiert.</span><span class="sxs-lookup"><span data-stu-id="b29b0-147">An add-in returns a UI to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="b29b0-148">Das Szenario wird in den folgenden Fällen verwendet:</span><span class="sxs-lookup"><span data-stu-id="b29b0-148">This scenario is used in the following cases:</span></span>

    - <span data-ttu-id="b29b0-149">Die Darstellung einer Benutzeroberfläche, die von einem Add-in zurückgegeben wird, hängt entweder von Daten oder von Bedingungen ab, die nur zur Laufzeit (z. b. dynamisch generierte Berichte) vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="b29b0-149">The appearance of a UI that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>

    - <span data-ttu-id="b29b0-150">Die Benutzeroberfläche für Dienste, die von einem Add-in bereitgestellt werden, unterscheidet sich von der Benutzeroberfläche der Host Anwendungen, die das Add-in verwenden können.</span><span class="sxs-lookup"><span data-stu-id="b29b0-150">The UI for services provided by an add-in differs from the UI of the host applications that can use the add-in.</span></span>

    - <span data-ttu-id="b29b0-151">Das Add-in führt hauptsächlich einen Dienst für die Host Anwendung aus und meldet den Status an die Host Anwendung mit einer Benutzeroberfläche.</span><span class="sxs-lookup"><span data-stu-id="b29b0-151">The add-in primarily performs a service for the host application, and reports status to the host application with a UI.</span></span>

2. <span data-ttu-id="b29b0-152">**Das Add-In ist eine Benutzeroberfläche**.</span><span class="sxs-lookup"><span data-stu-id="b29b0-152">**The add-in is a UI**.</span></span> <span data-ttu-id="b29b0-153">Ein Add-in ist eine Benutzeroberfläche, wie vom Vertrag definiert.</span><span class="sxs-lookup"><span data-stu-id="b29b0-153">An add-in is a UI, as defined by the contract.</span></span> <span data-ttu-id="b29b0-154">Das Szenario wird in den folgenden Fällen verwendet:</span><span class="sxs-lookup"><span data-stu-id="b29b0-154">This scenario is used in the following cases:</span></span>

    - <span data-ttu-id="b29b0-155">Ein Add-In stellt ausschließlich die angezeigten Dienste bereit, z. B. eine Werbung.</span><span class="sxs-lookup"><span data-stu-id="b29b0-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>

    - <span data-ttu-id="b29b0-156">Die Benutzeroberfläche für Dienste, die von einem Add-in bereitgestellt werden, ist für alle Host Anwendungen üblich, die das Add-in verwenden können, z. b. einen Rechner oder eine Farbauswahl.</span><span class="sxs-lookup"><span data-stu-id="b29b0-156">The UI for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>

<span data-ttu-id="b29b0-157">Diese Szenarien erfordern, dass UI-Objekte zwischen der Host Anwendung und den Add-in-Anwendungs Domänen übermittelt werden können.</span><span class="sxs-lookup"><span data-stu-id="b29b0-157">These scenarios require that UI objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="b29b0-158">Da das .NET Framework-Add-in-Modell für die Kommunikation zwischen Anwendungs Domänen Remoting benötigt, müssen die zwischen Ihnen weiter gegebenen Objekte Remote fähig sein.</span><span class="sxs-lookup"><span data-stu-id="b29b0-158">Since the .NET Framework add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>

<span data-ttu-id="b29b0-159">Ein remotefähiges Objekt stellt die Instanz einer Klasse dar, für die eine oder mehrere der folgenden Aussagen gelten:</span><span class="sxs-lookup"><span data-stu-id="b29b0-159">A remotable object is an instance of a class that does one or more of the following:</span></span>

- <span data-ttu-id="b29b0-160">Wird von der <xref:System.MarshalByRefObject> -Klasse abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="b29b0-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>

- <span data-ttu-id="b29b0-161">Implementiert die <xref:System.Runtime.Serialization.ISerializable>-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="b29b0-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>

- <span data-ttu-id="b29b0-162">Hat das <xref:System.SerializableAttribute> -Attribut angewendet.</span><span class="sxs-lookup"><span data-stu-id="b29b0-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>

> [!NOTE]
> <span data-ttu-id="b29b0-163">Weitere Informationen zum Erstellen von Remote fähigen-.NET Framework Objekten finden Sie unter [Erstellen von Objekten Remote fähigen](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100))Objekten.</span><span class="sxs-lookup"><span data-stu-id="b29b0-163">For more information regarding the creation of remotable .NET Framework objects, see [Making Objects Remotable](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100)).</span></span>

<span data-ttu-id="b29b0-164">Die WPF-Benutzeroberflächen Typen sind nicht Remote fähig.</span><span class="sxs-lookup"><span data-stu-id="b29b0-164">The WPF UI types are not remotable.</span></span> <span data-ttu-id="b29b0-165">Um das Problem zu beheben, erweitert WPF das .NET Framework Add-in-Modell, um zu ermöglichen, dass die von Add-Ins erstellte WPF-Benutzeroberfläche von Host Anwendungen aus angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="b29b0-165">To solve the problem, WPF extends the .NET Framework add-in model to enable WPF UI created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="b29b0-166">Diese Unterstützung wird von WPF durch zwei Arten bereitgestellt <xref:System.AddIn.Contract.INativeHandleContract> : die-Schnittstelle und zwei statische <xref:System.AddIn.Pipeline.FrameworkElementAdapters> Methoden, die <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>von der-Klasse implementiert werden: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> und.</span><span class="sxs-lookup"><span data-stu-id="b29b0-166">This support is provided by WPF by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="b29b0-167">Im Allgemeinen werden diese Typen und Methoden wie folgt verwendet:</span><span class="sxs-lookup"><span data-stu-id="b29b0-167">At a high level, these types and methods are used in the following manner:</span></span>

1. <span data-ttu-id="b29b0-168">WPF erfordert, dass von Add-Ins bereitgestellte Benutzeroberflächen Klassen sind, die direkt oder <xref:System.Windows.FrameworkElement>indirekt von abgeleitet werden, z. b. Formen, Steuerelemente, Benutzer Steuerelemente, Layoutpanels und Seiten.</span><span class="sxs-lookup"><span data-stu-id="b29b0-168">WPF requires that user interfaces provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>

2. <span data-ttu-id="b29b0-169">Überall dort, wo der Vertrag deklariert, dass eine Benutzeroberfläche zwischen dem Add-in und der Host Anwendung übermittelt wird, muss <xref:System.AddIn.Contract.INativeHandleContract> Sie als ( <xref:System.Windows.FrameworkElement>kein) deklariert werden. <xref:System.AddIn.Contract.INativeHandleContract> ist eine Remote fähige Darstellung der Add-in-Benutzeroberfläche, die über Isolations Grenzen hinweg übermittelt werden kann.</span><span class="sxs-lookup"><span data-stu-id="b29b0-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in UI that can be passed across isolation boundaries.</span></span>

3. <span data-ttu-id="b29b0-170">Vor der Übergabe von der Anwendungsdomäne des Add-Ins wird eine <xref:System.Windows.FrameworkElement> verpackt <xref:System.AddIn.Contract.INativeHandleContract> , indem aufgerufen <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>wird.</span><span class="sxs-lookup"><span data-stu-id="b29b0-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>

4. <span data-ttu-id="b29b0-171">Nachdem Sie an die Anwendungsdomäne der Host Anwendung weitergeleitet wurde <xref:System.AddIn.Contract.INativeHandleContract> , muss der <xref:System.Windows.FrameworkElement> durch Aufrufen <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>von neu verpackt werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>

<span data-ttu-id="b29b0-172">Wie <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> und<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> verwendet werden, hängt vom jeweiligen Szenario ab.</span><span class="sxs-lookup"><span data-stu-id="b29b0-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="b29b0-173">Die folgenden Abschnitte bieten ausführliche Informationen zu den Programmiermodellen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-173">The following sections provide details for each programming model.</span></span>

<a name="ReturnUIFromAddInContract"></a>

## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="b29b0-174">Add-In gibt eine Benutzeroberfläche zurück</span><span class="sxs-lookup"><span data-stu-id="b29b0-174">Add-In Returns a User Interface</span></span>

<span data-ttu-id="b29b0-175">Damit ein Add-in eine Benutzeroberfläche an eine Host Anwendung zurückgibt, sind folgende Schritte erforderlich:</span><span class="sxs-lookup"><span data-stu-id="b29b0-175">For an add-in to return a UI to a host application, the following are required:</span></span>

1. <span data-ttu-id="b29b0-176">Die Host Anwendung, das Add-in und die Pipeline müssen erstellt werden, wie in den .NET Framework [-Add-Ins und der Erweiterbarkeits](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) Dokumentation beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b29b0-176">The host application, add-in, and pipeline must be created, as described by the .NET Framework [Add-ins and Extensibility](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) documentation.</span></span>

2. <span data-ttu-id="b29b0-177">Der Vertrag muss implementieren <xref:System.AddIn.Contract.IContract> und, um eine Benutzeroberfläche zurückzugeben. der Vertrag muss eine Methode mit einem Rückgabewert vom <xref:System.AddIn.Contract.INativeHandleContract>Typ deklarieren.</span><span class="sxs-lookup"><span data-stu-id="b29b0-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a UI, the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>

3. <span data-ttu-id="b29b0-178">Die Benutzeroberfläche, die zwischen dem Add-in und der Host Anwendung übermittelt wird, muss direkt <xref:System.Windows.FrameworkElement>oder indirekt von abgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-178">The UI that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>

4. <span data-ttu-id="b29b0-179">Die Benutzeroberfläche, die vom-Add-in zurückgegeben wird, muss <xref:System.Windows.FrameworkElement> <xref:System.AddIn.Contract.INativeHandleContract> vor dem Überschreiten der Isolations Grenze von einem in ein konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-179">The UI that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>

5. <span data-ttu-id="b29b0-180">Die zurückgegebene Benutzeroberfläche muss nach dem überschreiten <xref:System.AddIn.Contract.INativeHandleContract> der Isolations Grenze von einem in ein <xref:System.Windows.FrameworkElement> konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-180">The UI that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>

6. <span data-ttu-id="b29b0-181">Die Host Anwendung zeigt die zurück <xref:System.Windows.FrameworkElement>gegebene an.</span><span class="sxs-lookup"><span data-stu-id="b29b0-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>

<span data-ttu-id="b29b0-182">Ein Beispiel für das Implementieren eines Add-Ins, das eine Benutzeroberfläche zurückgibt, finden [Sie unter Erstellen eines Add-Ins, das eine Benutzeroberfläche zurückgibt](how-to-create-an-add-in-that-returns-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="b29b0-182">For an example that demonstrates how to implement an add-in that returns a UI, see [Create an Add-In That Returns a UI](how-to-create-an-add-in-that-returns-a-ui.md).</span></span>

<a name="AddInIsAUI"></a>

## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="b29b0-183">Add-In ist eine Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="b29b0-183">Add-In Is a User Interface</span></span>

<span data-ttu-id="b29b0-184">Wenn ein Add-in eine Benutzeroberfläche ist, ist Folgendes erforderlich:</span><span class="sxs-lookup"><span data-stu-id="b29b0-184">When an add-in is a UI, the following are required:</span></span>

1. <span data-ttu-id="b29b0-185">Die Host Anwendung, das Add-in und die Pipeline müssen erstellt werden, wie in den .NET Framework [-Add-Ins und der Erweiterbarkeits](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) Dokumentation beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b29b0-185">The host application, add-in, and pipeline must be created, as described by the .NET Framework [Add-ins and Extensibility](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100)) documentation.</span></span>

2. <span data-ttu-id="b29b0-186">Die Vertrags Schnittstelle für das Add-in muss implementieren <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="b29b0-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>

3. <span data-ttu-id="b29b0-187">Das Add-in, das an die Host Anwendung übermittelt wird, muss direkt oder <xref:System.Windows.FrameworkElement>indirekt von abgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>

4. <span data-ttu-id="b29b0-188">Das-Add-in muss vor dem über <xref:System.Windows.FrameworkElement> schreiten der <xref:System.AddIn.Contract.INativeHandleContract> Isolations Grenze von einem in ein konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>

5. <span data-ttu-id="b29b0-189">Das Add-in muss nach dem überschreiten <xref:System.AddIn.Contract.INativeHandleContract> der Isolations Grenze von einem in ein <xref:System.Windows.FrameworkElement> konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>

6. <span data-ttu-id="b29b0-190">Die Host Anwendung zeigt die zurück <xref:System.Windows.FrameworkElement>gegebene an.</span><span class="sxs-lookup"><span data-stu-id="b29b0-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>

<span data-ttu-id="b29b0-191">Ein Beispiel für das Implementieren eines Add-Ins, das eine Benutzeroberfläche ist, finden [Sie unter Erstellen eines Add-Ins, das eine Benutzeroberfläche ist](how-to-create-an-add-in-that-is-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="b29b0-191">For an example that demonstrates how to implement an add-in that is a UI, see [Create an Add-In That Is a UI](how-to-create-an-add-in-that-is-a-ui.md).</span></span>

<a name="ReturningMultipleUIsFromAnAddIn"></a>

## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="b29b0-192">Zurückgeben mehrerer Benutzeroberflächen durch ein Add-In</span><span class="sxs-lookup"><span data-stu-id="b29b0-192">Returning Multiple UIs from an Add-In</span></span>

<span data-ttu-id="b29b0-193">Add-Ins stellen häufig mehrere Benutzeroberflächen bereit, damit Host Anwendungen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-193">Add-ins often provide multiple user interfaces for host applications to display.</span></span> <span data-ttu-id="b29b0-194">Angenommen, es handelt sich um ein Add-in, bei dem es sich um eine Benutzeroberfläche handelt, die auch Statusinformationen für die Host Anwendung als Benutzeroberfläche bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="b29b0-194">For example, consider an add-in that is a UI that also provides status information to the host application, also as a UI.</span></span> <span data-ttu-id="b29b0-195">Sie können ein Add-In dieser Art implementieren, indem Sie eine Kombination der Verfahren aus den Modellen [Add-In gibt eine Benutzeroberfläche zurück](#ReturnUIFromAddInContract) und [Add-In ist eine Benutzeroberfläche](#AddInIsAUI) verwenden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>

<a name="AddInsAndXBAPs"></a>

## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="b29b0-196">Add-Ins und XAML-Browseranwendungen</span><span class="sxs-lookup"><span data-stu-id="b29b0-196">Add-Ins and XAML Browser Applications</span></span>

<span data-ttu-id="b29b0-197">In den bisherigen Beispielen wurde die Hostanwendung als eigenständige Anwendung installiert.</span><span class="sxs-lookup"><span data-stu-id="b29b0-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="b29b0-198">[!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)]-Browseranwendungen können jedoch auch Add-Ins hosten, wobei allerdings die folgenden zusätzlichen Erstellungs- und Implementierungsanforderungen gelten:</span><span class="sxs-lookup"><span data-stu-id="b29b0-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>

- <span data-ttu-id="b29b0-199">Das [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Anwendungs Manifest muss speziell für das Herunterladen der Pipeline (Ordner und Assemblys) und der Add-in-Assembly in den ClickOnce-Anwendungscache auf dem Client Computer im selben [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]Ordner wie der konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the ClickOnce application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>

- <span data-ttu-id="b29b0-200">Der [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Code zum Ermitteln und laden [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] von Add-Ins muss den ClickOnce-Anwendungscache für als Pipeline-und Add-in-Speicherort verwenden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the ClickOnce application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>

- <span data-ttu-id="b29b0-201">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] muss das Add-In in einen speziellen Sicherheitskontext laden, wenn das Add-In auf lose Dateien verweist, die sich auf der Ursprungssite befinden. Wenn sie von [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]s gehostet werden, können Add-Ins nur auf lose Dateien verweisen, die auf der Ursprungssite der Hostanwendung gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="b29b0-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>

<span data-ttu-id="b29b0-202">In den folgenden Unterabschnitten werden diese Aufgaben ausführlich beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b29b0-202">These tasks are described in detail in the following subsections.</span></span>

### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="b29b0-203">Konfigurieren der Pipeline und des Add-Ins für die ClickOnce-Bereitstellung</span><span class="sxs-lookup"><span data-stu-id="b29b0-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>

[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]<span data-ttu-id="b29b0-204">Sie werden in einen sicheren Ordner im ClickOnce-Bereitstellungs Cache heruntergeladen und dort ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="b29b0-204">are downloaded to and run from a safe folder in the ClickOnce deployment cache.</span></span> <span data-ttu-id="b29b0-205">Damit eine [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] ein Add-In hosten kann, müssen auch Pipeline- und Add-In-Assembly in den sicheren Ordner heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="b29b0-206">Um dies zu erreichen, müssen Sie das Anwendungsmanifest so konfigurieren, dass sowohl die Pipeline- als auch die Add-In-Assembly heruntergeladen wird.</span><span class="sxs-lookup"><span data-stu-id="b29b0-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="b29b0-207">Diese Aufgabe lässt sich am einfachsten in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] ausführen, obwohl Pipeline- und Add-In-Assembly im Stammordner des [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Hostprojekts gespeichert sein müssen, damit [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] die Pipelineassemblys ermitteln kann.</span><span class="sxs-lookup"><span data-stu-id="b29b0-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>

<span data-ttu-id="b29b0-208">Folglich muss der erste Schritt darin bestehen, die Pipeline- und Add-In-Assembly im Stammverzeichnis des [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Projekts zu erstellen. Dazu wird die Buildausgabe der einzelnen Pipelineassembly- und Add-In-Assemblyprojekte festgelegt.</span><span class="sxs-lookup"><span data-stu-id="b29b0-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="b29b0-209">Die folgende Tabelle zeigt die Buildausgabepfade für die Pipelineassemblyprojekte und das Add-In-Assemblyprojekt, die sich in demselben Projektmappen- und Stammordner befinden wie das [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Hostprojekt.</span><span class="sxs-lookup"><span data-stu-id="b29b0-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>

<span data-ttu-id="b29b0-210">Tabelle 1: Buildausgabepfade für die von einer XBAP gehosteten Pipelineassemblys</span><span class="sxs-lookup"><span data-stu-id="b29b0-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>

|<span data-ttu-id="b29b0-211">Pipelineassemblyprojekt</span><span class="sxs-lookup"><span data-stu-id="b29b0-211">Pipeline assembly project</span></span>|<span data-ttu-id="b29b0-212">Ausgabepfad erstellen</span><span class="sxs-lookup"><span data-stu-id="b29b0-212">Build output path</span></span>|
|-------------------------------|-----------------------|
|<span data-ttu-id="b29b0-213">Vertrag</span><span class="sxs-lookup"><span data-stu-id="b29b0-213">Contract</span></span>|`..\HostXBAP\Contracts\`|
|<span data-ttu-id="b29b0-214">Add-In-Ansicht</span><span class="sxs-lookup"><span data-stu-id="b29b0-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|
|<span data-ttu-id="b29b0-215">Add-In-seitiger Adapter</span><span class="sxs-lookup"><span data-stu-id="b29b0-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|
|<span data-ttu-id="b29b0-216">Hostseitiger Adapter</span><span class="sxs-lookup"><span data-stu-id="b29b0-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|
|<span data-ttu-id="b29b0-217">Add-In</span><span class="sxs-lookup"><span data-stu-id="b29b0-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|

<span data-ttu-id="b29b0-218">Der nächste Schritt besteht darin, die Pipelineassemblys und die Add-In-Assembly als die Inhaltsdateien der [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]s in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] anzugeben. Dazu werden folgende Schritte ausgeführt:</span><span class="sxs-lookup"><span data-stu-id="b29b0-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>

1. <span data-ttu-id="b29b0-219">Hinzufügen der Pipeline- und Add-In-Assembly zum Projekt, indem Sie im Projektmappen-Explorer mit der rechten Maustaste auf die einzelnen Pipelineordner klicken und die Option **Zu Projekt hinzufügen** auswählen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>

2. <span data-ttu-id="b29b0-220">Festlegen des **Buildvorgangs** jeder Pipelineassembly und jeder Add-In-Assembly im **Eigenschaftenfenster** auf **Inhalt**.</span><span class="sxs-lookup"><span data-stu-id="b29b0-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>

<span data-ttu-id="b29b0-221">Im letzten Schritt muss das Anwendungsmanifest so konfiguriert werden, dass sowohl die Pipelineassemblydateien als auch die Add-In-Assemblydatei heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="b29b0-222">Die Dateien sollten sich in Ordnern befinden, die sich im Stammverzeichnis des Ordners im ClickOnce- [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Cache befinden, der von der Anwendung belegt wird.</span><span class="sxs-lookup"><span data-stu-id="b29b0-222">The files should be located in folders at the root of the folder in the ClickOnce cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="b29b0-223">Die Konfiguration richten Sie in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] durch folgende Schritte ein:</span><span class="sxs-lookup"><span data-stu-id="b29b0-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>

1. <span data-ttu-id="b29b0-224">Klicken Sie mit der rechten Maustaste auf das [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Projekt, klicken Sie auf **Eigenschaften**, auf **Veröffentlichen** und dann auf die Schaltfläche **Anwendungsdateien**.</span><span class="sxs-lookup"><span data-stu-id="b29b0-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>

2. <span data-ttu-id="b29b0-225">Legen Sie im Dialogfeld **Anwendungsdateien** den **Veröffentlichungsstatus** der einzelnen Pipeline- und Add-In-DLLs auf **Einschließen (Auto)** und die **Downloadgruppe** für die Pipeline- und Add-In-DLLs auf **(Erforderlich)** fest.</span><span class="sxs-lookup"><span data-stu-id="b29b0-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>

### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="b29b0-226">Verwenden der Pipeline und des Add-Ins von der Anwendungsbasis</span><span class="sxs-lookup"><span data-stu-id="b29b0-226">Using the Pipeline and Add-In from the Application Base</span></span>

<span data-ttu-id="b29b0-227">Wenn die Pipeline und das Add-in für die ClickOnce-Bereitstellung konfiguriert sind, werden Sie in denselben ClickOnce-Cache [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]Ordner wie das heruntergeladen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-227">When the pipeline and add-in are configured for ClickOnce deployment, they are downloaded to the same ClickOnce cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="b29b0-228">Damit Pipeline und Add-In aus der [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] verwendet werden können, müssen sie vom [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Code aus der Anwendungsbasis abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="b29b0-229">Die verschiedenen Typen und Member des .NET Framework Add-in-Modells für die Verwendung von Pipelines und Add-Ins bieten besondere Unterstützung für dieses Szenario.</span><span class="sxs-lookup"><span data-stu-id="b29b0-229">The various types and members of the .NET Framework add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="b29b0-230">Zuerst wird der Pfad durch den <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> -Enumerationswert identifiziert.</span><span class="sxs-lookup"><span data-stu-id="b29b0-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="b29b0-231">Diesen Wert verwenden Sie mit Überladungen der relevanten Add-In-Member, wenn Pipelines verwendet werden sollen, die Folgendes enthalten:</span><span class="sxs-lookup"><span data-stu-id="b29b0-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>

- <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>

- <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>

- <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>

- <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>

### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="b29b0-232">Zugreifen auf die Ursprungssite des Hosts</span><span class="sxs-lookup"><span data-stu-id="b29b0-232">Accessing the Host's Site of Origin</span></span>

<span data-ttu-id="b29b0-233">Damit ein Add-In auf Dateien von der Ursprungssite verweisen kann, muss das Add-In mit einer Sicherheitsisolation geladen werden, die der Hostanwendung entspricht.</span><span class="sxs-lookup"><span data-stu-id="b29b0-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="b29b0-234">Diese Sicherheitsstufe wird durch den <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> -Enumerationswert identifiziert und an die <xref:System.AddIn.Hosting.AddInToken.Activate%2A> -Methode beim Aktivieren eines Add-ins übermittelt.</span><span class="sxs-lookup"><span data-stu-id="b29b0-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>

<a name="WPFAddInModelArchitecture"></a>

## <a name="wpf-add-in-architecture"></a><span data-ttu-id="b29b0-235">Architektur des WPF-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="b29b0-235">WPF Add-In Architecture</span></span>

<span data-ttu-id="b29b0-236">Auf der höchsten Ebene, wie wir gesehen haben, ermöglicht WPF .NET Framework-Add-Ins, Benutzeroberflächen (die direkt oder indirekt von <xref:System.Windows.FrameworkElement>abgeleitet werden) mithilfe <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> <xref:System.AddIn.Contract.INativeHandleContract>von <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, und zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="b29b0-236">At the highest level, as we've seen, WPF enables .NET Framework add-ins to implement user interfaces (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="b29b0-237">Das Ergebnis ist, dass die Host Anwendung einen <xref:System.Windows.FrameworkElement> zurückgibt, der von der Benutzeroberfläche in der Host Anwendung angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="b29b0-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from UI in the host application.</span></span>

<span data-ttu-id="b29b0-238">Für einfache Benutzeroberflächen-Add-in-Szenarios ist dies so ausführlich wie Entwickler Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-238">For simple UI add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="b29b0-239">Für komplexere Szenarien, insbesondere solche, die versuchen, zusätzliche WPF-Dienste wie Layout, Ressourcen und Datenbindung zu verwenden, sind ausführlichere Informationen dazu erforderlich, wie WPF das .NET Framework Add-in-Modell mit UI-Unterstützung erweitert. und Einschränkungen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-239">For more complex scenarios, particularly those that try to utilize additional WPF services such as layout, resources, and data binding, more detailed knowledge of how WPF extends the .NET Framework add-in model with UI support is required to understand its benefits and limitations.</span></span>

<span data-ttu-id="b29b0-240">Im Grunde übergibt WPF keine Benutzeroberfläche von einem Add-in an eine Host Anwendung. Stattdessen übergibt WPF das Win32-Fenster Handle für die Benutzeroberfläche mithilfe der WPF-Interoperabilität.</span><span class="sxs-lookup"><span data-stu-id="b29b0-240">Fundamentally, WPF doesn't pass a UI from an add-in to a host application; instead, WPF passes the Win32 window handle for the UI by using WPF interoperability.</span></span> <span data-ttu-id="b29b0-241">Wenn eine Benutzeroberfläche aus einem Add-in an eine Host Anwendung übermittelt wird, geschieht Folgendes:</span><span class="sxs-lookup"><span data-stu-id="b29b0-241">As such, when a UI from an add-in is passed to a host application, the following occurs:</span></span>

- <span data-ttu-id="b29b0-242">Auf der Add-in-Seite erhält WPF ein Fenster Handle für die Benutzeroberfläche, die von der Host Anwendung angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="b29b0-242">On the add-in side, WPF acquires a window handle for the UI that will be displayed by the host application.</span></span> <span data-ttu-id="b29b0-243">Das Fenster Handle wird von einer internen WPF-Klasse gekapselt <xref:System.Windows.Interop.HwndSource> , die <xref:System.AddIn.Contract.INativeHandleContract>von abgeleitet wird und implementiert.</span><span class="sxs-lookup"><span data-stu-id="b29b0-243">The window handle is encapsulated by an internal WPF class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="b29b0-244">Eine Instanz dieser Klasse wird von <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> zurückgegeben und von der Anwendungsdomäne des Add-Ins an die Anwendungsdomäne der Host Anwendung gemarshallt.</span><span class="sxs-lookup"><span data-stu-id="b29b0-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>

- <span data-ttu-id="b29b0-245">Auf der Host Anwendungsseite wird von WPF das als <xref:System.Windows.Interop.HwndSource> interne WPF-Klasse erneut verpackt, die <xref:System.Windows.Interop.HwndHost> von abgeleitet <xref:System.AddIn.Contract.INativeHandleContract>wird und die verwendet.</span><span class="sxs-lookup"><span data-stu-id="b29b0-245">On the host application side, WPF repackages the <xref:System.Windows.Interop.HwndSource> as an internal WPF class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="b29b0-246">Eine Instanz dieser Klasse wird von <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> an die Host Anwendung zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="b29b0-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>

<span data-ttu-id="b29b0-247"><xref:System.Windows.Interop.HwndHost>Gibt an, dass Benutzeroberflächen, die durch Fenster Handles identifiziert werden, von WPF-Benutzeroberflächen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-247"><xref:System.Windows.Interop.HwndHost> exists to display user interfaces, identified by window handles, from WPF user interfaces.</span></span> <span data-ttu-id="b29b0-248">Weitere Informationen finden Sie unter [Interaktion zwischen WPF und Win32](../advanced/wpf-and-win32-interoperation.md).</span><span class="sxs-lookup"><span data-stu-id="b29b0-248">For more information, see [WPF and Win32 Interoperation](../advanced/wpf-and-win32-interoperation.md).</span></span>

<span data-ttu-id="b29b0-249"><xref:System.AddIn.Contract.INativeHandleContract>Zusammenfassend <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>ist,, und <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> vorhanden, damit das Fenster Handle für eine WPF-Benutzeroberfläche von einem Add-in an eine Host Anwendung übermittelt werden kann, wo Sie von <xref:System.Windows.Interop.HwndHost> einem gekapselt und die Benutzeroberfläche der Host Anwendung angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="b29b0-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a WPF UI to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's UI.</span></span>

> [!NOTE]
> <span data-ttu-id="b29b0-250">Da die Host Anwendung einen <xref:System.Windows.Interop.HwndHost>abruft, kann die Host Anwendung das Objekt, das von <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> zurückgegeben wird, nicht in den Typ konvertieren, den Sie durch das Add-in implementiert <xref:System.Windows.Controls.UserControl>hat (z. b.).</span><span class="sxs-lookup"><span data-stu-id="b29b0-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>

<span data-ttu-id="b29b0-251">Naturgemäß <xref:System.Windows.Interop.HwndHost> weist bestimmte Einschränkungen auf, die sich darauf auswirken, wie Host Anwendungen Sie verwenden können.</span><span class="sxs-lookup"><span data-stu-id="b29b0-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="b29b0-252">WPF erweitert <xref:System.Windows.Interop.HwndHost> jedoch mehrere Funktionen für Add-in-Szenarien.</span><span class="sxs-lookup"><span data-stu-id="b29b0-252">However, WPF extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="b29b0-253">Diese Vorteile und die Einschränkungen werden nachstehend beschrieben.</span><span class="sxs-lookup"><span data-stu-id="b29b0-253">These benefits and limitations are described below.</span></span>

<a name="WPFAddInModelBenefits"></a>

## <a name="wpf-add-in-benefits"></a><span data-ttu-id="b29b0-254">Vorteile des WPF-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="b29b0-254">WPF Add-In Benefits</span></span>

<span data-ttu-id="b29b0-255">Da WPF-Add-in-Benutzeroberflächen von Host Anwendungen mithilfe einer internen Klasse angezeigt werden, <xref:System.Windows.Interop.HwndHost>die von abgeleitet wird, werden diese Benutzeroberflächen durch <xref:System.Windows.Interop.HwndHost> die Funktionen von in Bezug auf WPF-UI-Dienste wie Layout eingeschränkt. Rendering, Datenbindung, Stile, Vorlagen und Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-255">Because WPF add-in user interfaces are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those user interfaces are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to WPF UI services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="b29b0-256">WPF erweitert jedoch seine interne <xref:System.Windows.Interop.HwndHost> Unterklasse mit zusätzlichen Funktionen, die Folgendes umfassen:</span><span class="sxs-lookup"><span data-stu-id="b29b0-256">However, WPF augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>

- <span data-ttu-id="b29b0-257">Tabstopps zwischen der Benutzeroberfläche einer Host Anwendung und der Benutzeroberfläche eines Add-Ins.</span><span class="sxs-lookup"><span data-stu-id="b29b0-257">Tabbing between a host application's UI and an add-in's UI.</span></span> <span data-ttu-id="b29b0-258">Beachten Sie, dass das Programmiermodell "Add-in ist eine Benutzeroberfläche" erfordert, dass der Add-in <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> -Side-Adapter überschrieben wird, um Tab zu aktivieren, unabhängig davon, ob das Add-in voll vertrauenswürdig oder teilweise vertrauenswürdig ist</span><span class="sxs-lookup"><span data-stu-id="b29b0-258">Note that the "add-in is a UI" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>

- <span data-ttu-id="b29b0-259">Berücksichtigen der Barrierefreiheits Anforderungen für Add-in-Benutzeroberflächen, die von den Benutzeroberflächen von Host Anwendungen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-259">Honoring accessibility requirements for add-in user interfaces that are displayed from host application user interfaces.</span></span>

- <span data-ttu-id="b29b0-260">Das sichere Ausführen von WPF-Anwendungen in Szenarien mit mehreren Anwendungs Domänen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-260">Enabling WPF applications to run safely in multiple application domain scenarios.</span></span>

- <span data-ttu-id="b29b0-261">Verhindern von unzulässigem Zugriff auf Add-in-Benutzeroberflächen Fenster Handles, wenn Add-Ins mit Sicherheits Isolation ausgeführt werden (d. h. eine teilweise vertrauenswürdige Sicherheits Sandbox).</span><span class="sxs-lookup"><span data-stu-id="b29b0-261">Preventing illegal access to add-in UI window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="b29b0-262">Durch <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> Aufrufen von wird diese Sicherheit sichergestellt</span><span class="sxs-lookup"><span data-stu-id="b29b0-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>

  - <span data-ttu-id="b29b0-263">Für das Programmiermodell "Add-in gibt eine Benutzeroberfläche" zurück, besteht die einzige Möglichkeit, das Fenster Handle für eine Add-in-Benutzeroberfläche über die Isolations Grenze zu übergeben, darin, aufzurufen <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="b29b0-263">For the "add-in returns a UI" programming model, the only way to pass the window handle for an add-in UI across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>

  - <span data-ttu-id="b29b0-264">Das Programmiermodell "Add-in ist eine Benutzeroberfläche", <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> das Überschreiben auf dem Add-in-seitigen Adapter und das Aufrufen <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> von (wie in den obigen Beispielen gezeigt) erforderlich ist, wie das Aufrufen der `QueryContract` Implementierung des Add-in-seitigen Adapters aus dem Host seitiger Adapter.</span><span class="sxs-lookup"><span data-stu-id="b29b0-264">For the "add-in is a UI" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>

- <span data-ttu-id="b29b0-265">Bereitstellen von Ausführungsschutz für mehrere Anwendungsdomänen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="b29b0-266">Aufgrund von Einschränkungen bei Anwendungsdomänen führen unbehandelte Ausnahmen, die in Add-In-Anwendungsdomänen ausgelöst werden, zum Absturz der gesamten Anwendung, auch wenn eine Isolationsgrenze eingerichtet ist.</span><span class="sxs-lookup"><span data-stu-id="b29b0-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="b29b0-267">WPF und das .NET Framework-Add-in-Modell bieten jedoch eine einfache Möglichkeit, dieses Problem zu umgehen und die Anwendungs Stabilität zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="b29b0-267">However, WPF and the .NET Framework add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="b29b0-268">Ein WPF-Add-in, das eine Benutzeroberfläche <xref:System.Windows.Threading.Dispatcher> anzeigt, erstellt einen für den Thread, auf dem die Anwendungsdomäne ausgeführt wird, wenn es sich bei der Host Anwendung um eine WPF-Anwendung handelt.</span><span class="sxs-lookup"><span data-stu-id="b29b0-268">A WPF add-in that displays a UI creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a WPF application.</span></span> <span data-ttu-id="b29b0-269">Sie können alle nicht behandelten Ausnahmen erkennen, die in der Anwendungsdomäne auftreten, indem <xref:System.Windows.Threading.Dispatcher.UnhandledException> Sie das- <xref:System.Windows.Threading.Dispatcher>Ereignis der WPF-Add-Ins behandeln.</span><span class="sxs-lookup"><span data-stu-id="b29b0-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the WPF add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="b29b0-270">Sie können den <xref:System.Windows.Threading.Dispatcher> aus der <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> -Eigenschaft erhalten.</span><span class="sxs-lookup"><span data-stu-id="b29b0-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>

<a name="WPFAddInModelLimitations"></a>

## <a name="wpf-add-in-limitations"></a><span data-ttu-id="b29b0-271">Einschränkungen des WPF-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="b29b0-271">WPF Add-In Limitations</span></span>

<span data-ttu-id="b29b0-272">Zusätzlich zu den Vorteilen, die WPF den Standardverhalten hinzufügt, <xref:System.Windows.Interop.HwndSource>die <xref:System.Windows.Interop.HwndHost>von den Fenster Handles, und bereitgestellt werden, gibt es auch Einschränkungen für Add-in-Benutzeroberflächen, die von Host Anwendungen angezeigt werden:</span><span class="sxs-lookup"><span data-stu-id="b29b0-272">Beyond the benefits that WPF adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in user interfaces that are displayed from host applications:</span></span>

- <span data-ttu-id="b29b0-273">Von einer Host Anwendung angezeigte Add-in-Benutzeroberflächen beachten das clippingverhalten der Host Anwendung nicht.</span><span class="sxs-lookup"><span data-stu-id="b29b0-273">Add-in user interfaces displayed from a host application do not respect the host application's clipping behavior.</span></span>

- <span data-ttu-id="b29b0-274">Der Begriff *Airspace* in Interoperabilitätsszenarien gilt auch für Add-Ins (siehe [Übersicht über die Technologieregionen](../advanced/technology-regions-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="b29b0-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../advanced/technology-regions-overview.md)).</span></span>

- <span data-ttu-id="b29b0-275">Die UI-Dienste einer Host Anwendung, z. b. Ressourcen Vererbung, Datenbindung und Befehls Folge, sind nicht automatisch für Add-in-Benutzeroberflächen verfügbar.</span><span class="sxs-lookup"><span data-stu-id="b29b0-275">A host application's UI services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in user interfaces.</span></span> <span data-ttu-id="b29b0-276">Um diese Dienste für das Add-In bereitzustellen, müssen Sie die Pipeline aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="b29b0-276">To provide these services to the add-in, you need to update the pipeline.</span></span>

- <span data-ttu-id="b29b0-277">Eine Add-in-Benutzeroberfläche kann nicht gedreht, skaliert, verzerrt oder anderweitig von einer Transformation beeinflusst werden (siehe [Übersicht über Transformationen](../graphics-multimedia/transforms-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="b29b0-277">An add-in UI cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../graphics-multimedia/transforms-overview.md)).</span></span>

- <span data-ttu-id="b29b0-278">Inhalte innerhalb von Add-in-Benutzeroberflächen, die von Zeichnungs Vorgängen <xref:System.Drawing> aus dem-Namespace gerendert werden, können Alpha Blending enthalten.</span><span class="sxs-lookup"><span data-stu-id="b29b0-278">Content inside add-in user interfaces that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="b29b0-279">Eine Add-in-Benutzeroberfläche und die Benutzeroberfläche der Host Anwendung, die die Benutzeroberfläche enthält, muss jedoch 100% nicht transparent sein. Anders ausgedrückt, muss die `Opacity` -Eigenschaft für beide auf 1 festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-279">However, both an add-in UI and the host application UI that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>

- <span data-ttu-id="b29b0-280">Wenn die <xref:System.Windows.Window.AllowsTransparency%2A> -Eigenschaft eines Fensters in der Host Anwendung, die eine Add-in-Benutzeroberfläche enthält `true`, auf festgelegt ist, ist das Add-in nicht sichtbar.</span><span class="sxs-lookup"><span data-stu-id="b29b0-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in UI is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="b29b0-281">Dies gilt auch, wenn die Add-in-Benutzeroberfläche 100% deckend ist (d. `Opacity` h., die-Eigenschaft hat den Wert 1).</span><span class="sxs-lookup"><span data-stu-id="b29b0-281">This is true even if the add-in UI is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>

- <span data-ttu-id="b29b0-282">Eine Add-in-Benutzeroberfläche muss auf anderen WPF-Elementen in demselben Fenster auf oberster Ebene angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-282">An add-in UI must appear on top of other WPF elements in the same top-level window.</span></span>

- <span data-ttu-id="b29b0-283">Ein <xref:System.Windows.Media.VisualBrush>Teil der Benutzeroberfläche eines Add-Ins kann nicht mithilfe von gerendert werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-283">No portion of an add-in's UI can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="b29b0-284">Stattdessen kann das Add-in eine Momentaufnahme der generierten Benutzeroberfläche erstellen, um eine Bitmap zu erstellen, die mithilfe von Methoden, die durch den Vertrag definiert werden, an die Host Anwendung übergeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="b29b0-284">Instead, the add-in may take a snapshot of the generated UI to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>

- <span data-ttu-id="b29b0-285">Mediendateien können nicht von einem <xref:System.Windows.Controls.MediaElement> in einer Add-in-Benutzeroberfläche abgespielt werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in UI.</span></span>

- <span data-ttu-id="b29b0-286">Mausereignisse, die für die Add-in-Benutzeroberfläche generiert werden, werden von der Host Anwendung weder `IsMouseOver` empfangen noch ausgelöst, und die-Eigenschaft für `false`die Benutzeroberfläche der Host Anwendung hat den Wert.</span><span class="sxs-lookup"><span data-stu-id="b29b0-286">Mouse events generated for the add-in UI are neither received nor raised by the host application, and the `IsMouseOver` property for host application UI has a value of `false`.</span></span>

- <span data-ttu-id="b29b0-287">Wenn sich der Fokus zwischen Steuerelementen in einer Add-in- `GotFocus` Benutzer `LostFocus` Oberfläche verschiebt, werden das-Ereignis und das-Ereignis weder von der Host Anwendung empfangen noch ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="b29b0-287">When focus shifts between controls in an add-in UI, the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>

- <span data-ttu-id="b29b0-288">Der Teil einer Host Anwendung, die eine Add-in-Benutzeroberfläche enthält, wird beim Drucken weiß angezeigt.</span><span class="sxs-lookup"><span data-stu-id="b29b0-288">The portion of a host application that contains an add-in UI appears white when printed.</span></span>

- <span data-ttu-id="b29b0-289">Alle Verteiler (siehe <xref:System.Windows.Threading.Dispatcher>), die von der Add-in-Benutzeroberfläche erstellt wurden, müssen manuell heruntergefahren werden, bevor das Besitzer-Add-in entladen wird, wenn die Host Anwendung die Ausführung fortsetzt.</span><span class="sxs-lookup"><span data-stu-id="b29b0-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in UI must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="b29b0-290">Mit dem Vertrag können Methoden implementiert werden, die es der Host Anwendung ermöglichen, das Add-in zu signalisieren, bevor das Add-in entladen wird. Dadurch kann die Add-in-Benutzeroberfläche ihre Verteiler beenden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in UI to shut down its dispatchers.</span></span>

- <span data-ttu-id="b29b0-291">Wenn eine Add-in-Benutzeroberfläche <xref:System.Windows.Controls.InkCanvas> ein ist oder <xref:System.Windows.Controls.InkCanvas>ein enthält, können Sie das Add-in nicht entladen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-291">If an add-in UI is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>

<a name="PerformanceOptimization"></a>

## <a name="performance-optimization"></a><span data-ttu-id="b29b0-292">Leistungsoptimierung</span><span class="sxs-lookup"><span data-stu-id="b29b0-292">Performance Optimization</span></span>

<span data-ttu-id="b29b0-293">Wenn mehrere Anwendungs Domänen verwendet werden, werden standardmäßig die verschiedenen .NET Framework Assemblys, die von jeder Anwendung benötigt werden, in die Domäne dieser Anwendung geladen.</span><span class="sxs-lookup"><span data-stu-id="b29b0-293">By default, when multiple application domains are used, the various .NET Framework assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="b29b0-294">Aufgrund der Zeit, die zum Erstellen neuer Anwendungsdomänen und für das Starten der darin enthaltenen Anwendungen erforderlich ist, kann die Leistung beeinträchtigt werden.</span><span class="sxs-lookup"><span data-stu-id="b29b0-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="b29b0-295">Die .NET Framework bietet jedoch die Möglichkeit, die Startzeiten zu verkürzen, indem Anwendungen angewiesen werden, Assemblys über Anwendungs Domänen hinweg freizugeben, wenn Sie bereits geladen sind.</span><span class="sxs-lookup"><span data-stu-id="b29b0-295">However, the .NET Framework provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="b29b0-296">Verwenden Sie hierzu das <xref:System.LoaderOptimizationAttribute> -Attribut, das auf die Einstiegspunkt Methode (`Main`) angewendet werden muss.</span><span class="sxs-lookup"><span data-stu-id="b29b0-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="b29b0-297">In diesem Fall müssen Sie lediglich zum Implementieren Ihrer Anwendungsdefinition Code verwenden (siehe [Übersicht über die Anwendungsverwaltung](application-management-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="b29b0-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](application-management-overview.md)).</span></span>

## <a name="see-also"></a><span data-ttu-id="b29b0-298">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="b29b0-298">See also</span></span>

- <xref:System.LoaderOptimizationAttribute>
- <span data-ttu-id="b29b0-299">[Add-Ins und Erweiterbarkeit](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100))</span><span class="sxs-lookup"><span data-stu-id="b29b0-299">[Add-ins and Extensibility](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bb384200(v%3dvs.100))</span></span>
- [<span data-ttu-id="b29b0-300">Anwendungsdomänen</span><span class="sxs-lookup"><span data-stu-id="b29b0-300">Application Domains</span></span>](../../app-domains/application-domains.md)
- <span data-ttu-id="b29b0-301">[Übersicht über .NET Framework Remoting](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/kwdt6w2k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="b29b0-301">[.NET Framework Remoting Overview](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/kwdt6w2k(v=vs.100))</span></span>
- <span data-ttu-id="b29b0-302">[Erstellen von Objekten als remotable](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="b29b0-302">[Making Objects Remotable](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/wcf3swha(v=vs.100))</span></span>
- [<span data-ttu-id="b29b0-303">Themen zu Vorgehensweisen</span><span class="sxs-lookup"><span data-stu-id="b29b0-303">How-to Topics</span></span>](how-to-topics.md)
