---
title: Abrufen von Benutzeroberflächenautomatisierungs-Elementen
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, obtaining elements
- elements, UI Automation, obtaining
ms.assetid: c2caaf45-e59c-42a1-bc9b-77a6de520171
ms.openlocfilehash: 89c9397ba579f04d81eee7af6363f8fee3abfe1d
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "62033195"
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="41e4a-102">Abrufen von Benutzeroberflächenautomatisierungs-Elementen</span><span class="sxs-lookup"><span data-stu-id="41e4a-102">Obtaining UI Automation Elements</span></span>
> [!NOTE]
>  <span data-ttu-id="41e4a-103">Diese Dokumentation ist für .NET Framework-Entwickler vorgesehen, die die verwalteten [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]-Klassen verwenden möchten, die im <xref:System.Windows.Automation>-Namespace definiert sind.</span><span class="sxs-lookup"><span data-stu-id="41e4a-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="41e4a-104">Die neuesten Informationen zu [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], finden Sie unter [Windows-Automatisierungs-API: Benutzeroberflächenautomatisierung](https://go.microsoft.com/fwlink/?LinkID=156746).</span><span class="sxs-lookup"><span data-stu-id="41e4a-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).</span></span>  
  
 <span data-ttu-id="41e4a-105">In diesem Thema werden die verschiedenen Möglichkeiten zum Abrufen von <xref:System.Windows.Automation.AutomationElement> -Objekten für [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] -Elemente beschrieben.</span><span class="sxs-lookup"><span data-stu-id="41e4a-105">This topic describes the various ways of obtaining <xref:System.Windows.Automation.AutomationElement> objects for [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] elements.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="41e4a-106">Wenn Ihre Clientanwendung nach Elementen in ihrer eigenen Benutzeroberfläche suchen kann, müssen alle [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Aufrufe in einem separaten Thread ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="41e4a-106">If your client application might attempt to find elements in its own user interface, you must make all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls on a separate thread.</span></span> <span data-ttu-id="41e4a-107">Weitere Informationen finden Sie unter [UI Automation Threading Issues](../../../docs/framework/ui-automation/ui-automation-threading-issues.md).</span><span class="sxs-lookup"><span data-stu-id="41e4a-107">For more information, see [UI Automation Threading Issues](../../../docs/framework/ui-automation/ui-automation-threading-issues.md).</span></span>  
  
<a name="The_Root_Element"></a>   
## <a name="root-element"></a><span data-ttu-id="41e4a-108">Stammelement</span><span class="sxs-lookup"><span data-stu-id="41e4a-108">Root Element</span></span>  
 <span data-ttu-id="41e4a-109">Für jede Suche nach <xref:System.Windows.Automation.AutomationElement> -Objekten ist ein Ausgangspunkt erforderlich.</span><span class="sxs-lookup"><span data-stu-id="41e4a-109">All searches for <xref:System.Windows.Automation.AutomationElement> objects must have a starting-place.</span></span> <span data-ttu-id="41e4a-110">Dies kann ein beliebiges Element sein, z. B. der Desktop, ein Anwendungsfenster oder ein Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="41e4a-110">This can be any element, including the desktop, an application window, or a control.</span></span>  
  
 <span data-ttu-id="41e4a-111">Das Stammelement für den Desktop, aus dem alle Elemente abgeleitet werden, wird aus der statischen <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=nameWithType> -Eigenschaft abgerufen.</span><span class="sxs-lookup"><span data-stu-id="41e4a-111">The root element for the desktop, from which all elements are descended, is obtained from the static <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=nameWithType> property.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="41e4a-112">Grundsätzlich sollten Sie nur versuchen, direkt untergeordnete Elemente des Elements abzurufen, das von der <xref:System.Windows.Automation.AutomationElement.RootElement%2A>-Eigenschaft angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="41e4a-112">In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span></span> <span data-ttu-id="41e4a-113">Eine Suche nach Nachfolgerelementen kann hunderte oder sogar tausende Elemente durchlaufen und möglicherweise einen Stapelüberlauf verursachen.</span><span class="sxs-lookup"><span data-stu-id="41e4a-113">A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow.</span></span> <span data-ttu-id="41e4a-114">Wenn Sie versuchen, ein bestimmtes Element auf einer niedrigeren Ebene abzurufen, sollten Sie die Suche aus dem Anwendungsfenster oder aus einem Container auf niedrigerer Ebene starten.</span><span class="sxs-lookup"><span data-stu-id="41e4a-114">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>  
  
<a name="Using_Conditions"></a>   
## <a name="conditions"></a><span data-ttu-id="41e4a-115">Bedingungen</span><span class="sxs-lookup"><span data-stu-id="41e4a-115">Conditions</span></span>  
 <span data-ttu-id="41e4a-116">In den meisten Verfahren, die zum Abrufen von [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Elementen verwendet werden können, müssen Sie eine <xref:System.Windows.Automation.Condition>angeben, die ein Satz von Kriterien ist, mit denen definiert wird, welche Elemente abgerufen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="41e4a-116">For most techniques you can use to retrieve [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements, you must specify a <xref:System.Windows.Automation.Condition>, which is a set of criteria defining what elements you want to retrieve.</span></span>  
  
 <span data-ttu-id="41e4a-117">Die einfachste Bedingung ist <xref:System.Windows.Automation.Condition.TrueCondition>. Dies ist ein vordefiniertes Objekt, das angibt, dass alle im Suchbereich befindlichen Elemente zurückgegeben werden sollen.</span><span class="sxs-lookup"><span data-stu-id="41e4a-117">The simplest condition is <xref:System.Windows.Automation.Condition.TrueCondition>, a predefined object specifying that all elements within the search scope are to be returned.</span></span> <span data-ttu-id="41e4a-118"><xref:System.Windows.Automation.Condition.FalseCondition>(das Gegenteil von <xref:System.Windows.Automation.Condition.TrueCondition>) ist weniger nützlich, da diese Bedingung verhindert, dass irgendein Element gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="41e4a-118"><xref:System.Windows.Automation.Condition.FalseCondition>, the converse of <xref:System.Windows.Automation.Condition.TrueCondition>, is less useful, as it would prevent any elements from being found.</span></span>  
  
 <span data-ttu-id="41e4a-119">Sie können drei weitere vordefinierte Bedingungen jeweils eigenständig oder in Kombination mit anderen Bedingungen verwenden: <xref:System.Windows.Automation.Automation.ContentViewCondition>, <xref:System.Windows.Automation.Automation.ControlViewCondition>und <xref:System.Windows.Automation.Automation.RawViewCondition>.</span><span class="sxs-lookup"><span data-stu-id="41e4a-119">Three other predefined conditions can be used alone or in combination with other conditions: <xref:System.Windows.Automation.Automation.ContentViewCondition>, <xref:System.Windows.Automation.Automation.ControlViewCondition>, and <xref:System.Windows.Automation.Automation.RawViewCondition>.</span></span> <span data-ttu-id="41e4a-120">Eigenständig verwendet entspricht<xref:System.Windows.Automation.Automation.RawViewCondition>der Bedingung <xref:System.Windows.Automation.Condition.TrueCondition>, da Elemente hierbei nicht nach ihrer <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> -Eigenschaft oder <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> -Eigenschaft gefiltert werden.</span><span class="sxs-lookup"><span data-stu-id="41e4a-120"><xref:System.Windows.Automation.Automation.RawViewCondition>, used by itself, is equivalent to <xref:System.Windows.Automation.Condition.TrueCondition>, because it does not filter elements by their <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> or <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> properties.</span></span>  
  
 <span data-ttu-id="41e4a-121">Andere Bedingungen werden aus <xref:System.Windows.Automation.PropertyCondition> -Objekten erstellt, von denen jedes einen Eigenschaftswert angibt.</span><span class="sxs-lookup"><span data-stu-id="41e4a-121">Other conditions are built up from one or more <xref:System.Windows.Automation.PropertyCondition> objects, each of which specifies a property value.</span></span> <span data-ttu-id="41e4a-122">Beispielsweise kann ein <xref:System.Windows.Automation.PropertyCondition> -Objekt angeben, dass das Element aktiviert ist oder dass es bestimmtes Steuerelementmuster unterstützt.</span><span class="sxs-lookup"><span data-stu-id="41e4a-122">For example, a <xref:System.Windows.Automation.PropertyCondition> might specify that the element is enabled, or that it supports a certain control pattern.</span></span>  
  
 <span data-ttu-id="41e4a-123">Bedingungen können über boolesche Logik kombiniert werden, indem Objekte des Typs <xref:System.Windows.Automation.AndCondition>, <xref:System.Windows.Automation.OrCondition>oder <xref:System.Windows.Automation.NotCondition>erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="41e4a-123">Conditions can be combined using Boolean logic by constructing objects of types <xref:System.Windows.Automation.AndCondition>, <xref:System.Windows.Automation.OrCondition>, and <xref:System.Windows.Automation.NotCondition>.</span></span>  
  
<a name="Search_Scope"></a>   
## <a name="search-scope"></a><span data-ttu-id="41e4a-124">Suchbereich</span><span class="sxs-lookup"><span data-stu-id="41e4a-124">Search Scope</span></span>  
 <span data-ttu-id="41e4a-125">Für Suchvorgänge, die mit <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> oder <xref:System.Windows.Automation.AutomationElement.FindAll%2A> ausgeführt werden, sind sowohl ein Bereich als auch ein Ausgangspunkt erforderlich.</span><span class="sxs-lookup"><span data-stu-id="41e4a-125">Searches done by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A> must have a scope as well as a starting-place.</span></span>  
  
 <span data-ttu-id="41e4a-126">Der Bereich definiert den zu durchsuchenden Raum um den Ausgangspunkt.</span><span class="sxs-lookup"><span data-stu-id="41e4a-126">The scope defines the space around the starting-place that is to be searched.</span></span> <span data-ttu-id="41e4a-127">Beispiele sind das Element selbst sowie die gleichgeordneten Elemente, das übergeordnete Element, die Vorgängerelemente, die direkt untergeordneten Elemente und die Nachfolgerelemente des Elements.</span><span class="sxs-lookup"><span data-stu-id="41e4a-127">This might include the element itself, its siblings, its parent, its ancestors, its immediate children, and its descendants.</span></span>  
  
 <span data-ttu-id="41e4a-128">Der Bereich einer Suche wird durch eine bitweise Kombination von Werten aus der <xref:System.Windows.Automation.TreeScope> -Enumeration definiert.</span><span class="sxs-lookup"><span data-stu-id="41e4a-128">The scope of a search is defined by a bitwise combination of values from the <xref:System.Windows.Automation.TreeScope> enumeration.</span></span>  
  
<a name="Finding_a_Known_Element"></a>   
## <a name="finding-a-known-element"></a><span data-ttu-id="41e4a-129">Suchen nach einem bekannten Element</span><span class="sxs-lookup"><span data-stu-id="41e4a-129">Finding a Known Element</span></span>  
 <span data-ttu-id="41e4a-130">Ein bekanntes Element, das durch seine <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>-, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>- oder eine andere Eigenschaft bzw. ein Kombination von Eigenschaften gekennzeichnet ist, lässt sich am einfachsten mit der <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> -Methode finden.</span><span class="sxs-lookup"><span data-stu-id="41e4a-130">To find a known element, identified by its <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>, or some other property or combination of properties, it is easiest to use the <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> method.</span></span> <span data-ttu-id="41e4a-131">Wenn das gesuchte Element ein Anwendungsfenster ist, kann der Ausgangspunkt der Suche die <xref:System.Windows.Automation.AutomationElement.RootElement%2A>-Eigenschaft sein.</span><span class="sxs-lookup"><span data-stu-id="41e4a-131">If the element sought is an application window, the starting-point of the search can be the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span></span>  
  
 <span data-ttu-id="41e4a-132">Dieses Verfahren zum Suchen nach [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Elementen ist in Szenarios für automatisierte Tests am nützlichsten.</span><span class="sxs-lookup"><span data-stu-id="41e4a-132">This way of finding [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements is most useful in automated testing scenarios.</span></span>  
  
<a name="Finding_Elements_in_a_Subtree"></a>   
## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="41e4a-133">Suchen nach Elementen in einer Unterstruktur</span><span class="sxs-lookup"><span data-stu-id="41e4a-133">Finding Elements in a Subtree</span></span>  
 <span data-ttu-id="41e4a-134">Um alle Elemente zu finden, die bestimmten Kriterien in Bezug auf ein bekanntes Element entsprechen, können Sie <xref:System.Windows.Automation.AutomationElement.FindAll%2A>verwenden.</span><span class="sxs-lookup"><span data-stu-id="41e4a-134">To find all elements meeting specific criteria that are related to a known element, you can use <xref:System.Windows.Automation.AutomationElement.FindAll%2A>.</span></span> <span data-ttu-id="41e4a-135">Beispielsweise könnten Sie diese Methode verwenden, um Listenelemente oder Menüelemente aus einer Liste bzw. einem Menü abzurufen oder alle Steuerelemente in einem Dialogfeld zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="41e4a-135">For example, you could use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>  
  
<a name="Walking_a_Subtree"></a>   
## <a name="walking-a-subtree"></a><span data-ttu-id="41e4a-136">Durchlaufen einer Unterstruktur</span><span class="sxs-lookup"><span data-stu-id="41e4a-136">Walking a Subtree</span></span>  
 <span data-ttu-id="41e4a-137">Wenn Sie nichts über die Anwendungen wissen, mit denen Ihr Client möglicherweise verwendet wird, können Sie über die <xref:System.Windows.Automation.TreeWalker> -Klasse eine Unterstruktur aller relevanten Elemente erstellen.</span><span class="sxs-lookup"><span data-stu-id="41e4a-137">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using the <xref:System.Windows.Automation.TreeWalker> class.</span></span> <span data-ttu-id="41e4a-138">Dies kann in Ihrer Anwendung als Reaktion auf ein Ereignis erfolgen, das durch eine Fokusänderung ausgelöst wurde. Das heißt, wenn eine Anwendung oder ein Steuerelement den Eingabefokus erhält, überprüft der Benutzeroberflächenautomatisierungs-Client die untergeordneten Elemente und möglicherweise alle Nachfolgerelemente des Elements mit Fokus.</span><span class="sxs-lookup"><span data-stu-id="41e4a-138">Your application might do this in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>  
  
 <span data-ttu-id="41e4a-139">Eine weitere Verwendungsmöglichkeit für <xref:System.Windows.Automation.TreeWalker> besteht darin, die Vorgänger eines Elements zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="41e4a-139">Another way in which <xref:System.Windows.Automation.TreeWalker> can be used is to identify the ancestors of an element.</span></span> <span data-ttu-id="41e4a-140">Beispielsweise können Sie das übergeordnete Fenster eines Steuerelements ermitteln, indem Sie die Struktur nach oben durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="41e4a-140">For example, by walking up the tree you can identify the parent window of a control.</span></span>  
  
 <span data-ttu-id="41e4a-141">Sie können <xref:System.Windows.Automation.TreeWalker> verwenden, indem Sie entweder ein Objekt der Klasse erstellen (und dabei die relevanten Elemente durch Übergeben eines <xref:System.Windows.Automation.Condition>-Objekts definieren) oder eines der folgenden vordefinierten Objekte verwenden, die als Felder von <xref:System.Windows.Automation.TreeWalker>definiert sind.</span><span class="sxs-lookup"><span data-stu-id="41e4a-141">You can use <xref:System.Windows.Automation.TreeWalker> either by creating an object of the class (defining the elements of interest by passing a <xref:System.Windows.Automation.Condition>), or by using one of the following predefined objects that are defined as fields of <xref:System.Windows.Automation.TreeWalker>.</span></span>  
  
|||  
|-|-|  
|<xref:System.Windows.Automation.TreeWalker.ContentViewWalker>|<span data-ttu-id="41e4a-142">Sucht nur nach Elementen, deren <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> -Eigenschaft gleich `true`ist.</span><span class="sxs-lookup"><span data-stu-id="41e4a-142">Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Automation.TreeWalker.ControlViewWalker>|<span data-ttu-id="41e4a-143">Sucht nur nach Elementen, deren <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> -Eigenschaft gleich `true`ist.</span><span class="sxs-lookup"><span data-stu-id="41e4a-143">Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Automation.TreeWalker.RawViewWalker>|<span data-ttu-id="41e4a-144">Sucht nach allen Elementen.</span><span class="sxs-lookup"><span data-stu-id="41e4a-144">Finds all elements.</span></span>|  
  
 <span data-ttu-id="41e4a-145">Nachdem Sie ein <xref:System.Windows.Automation.TreeWalker>-Objekt abgerufen haben, ist dessen Verwendung unkompliziert.</span><span class="sxs-lookup"><span data-stu-id="41e4a-145">After you have obtained a <xref:System.Windows.Automation.TreeWalker>, using it is straightforward.</span></span> <span data-ttu-id="41e4a-146">Rufen Sie einfach die `Get` -Methoden auf, um durch die Elemente der Unterstruktur zu navigieren.</span><span class="sxs-lookup"><span data-stu-id="41e4a-146">Simply call the `Get` methods to navigate among elements of the subtree.</span></span>  
  
 <span data-ttu-id="41e4a-147">Die <xref:System.Windows.Automation.TreeWalker.Normalize%2A> -Methode kann verwendet werden, um von einem Element, das nicht Teil der Ansicht ist, zu einem Element in der Unterstruktur zu navigieren.</span><span class="sxs-lookup"><span data-stu-id="41e4a-147">The <xref:System.Windows.Automation.TreeWalker.Normalize%2A> method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="41e4a-148">Nehmen Sie beispielsweise an, dass Sie mit <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>eine Ansicht einer Unterstruktur erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="41e4a-148">For example, suppose you have created a view of a subtree by using <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>.</span></span> <span data-ttu-id="41e4a-149">Ihre Anwendung empfängt dann eine Benachrichtigung, dass eine Scrollleiste den Eingabefokus erhalten hat.</span><span class="sxs-lookup"><span data-stu-id="41e4a-149">Your application then receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="41e4a-150">Weil eine Scrolllaufleiste aber kein Inhaltselement ist, fehlt sie in Ihrer Ansicht der Unterstruktur.</span><span class="sxs-lookup"><span data-stu-id="41e4a-150">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="41e4a-151">Sie können das <xref:System.Windows.Automation.AutomationElement> , das die Scrolllaufleiste darstellt, jedoch an <xref:System.Windows.Automation.TreeWalker.Normalize%2A> übergeben und den unmittelbaren Vorgänger in der Inhaltsansicht abrufen.</span><span class="sxs-lookup"><span data-stu-id="41e4a-151">However, you can pass the <xref:System.Windows.Automation.AutomationElement> representing the scroll bar to <xref:System.Windows.Automation.TreeWalker.Normalize%2A> and retrieve the nearest ancestor that is in the content view.</span></span>  
  
<a name="Other_Ways_to_Retrieve_an_Element"></a>   
## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="41e4a-152">Weitere Möglichkeiten zum Abrufen eines Elements</span><span class="sxs-lookup"><span data-stu-id="41e4a-152">Other Ways to Retrieve an Element</span></span>  
 <span data-ttu-id="41e4a-153">Zusätzlich zu Suchvorgängen und Navigation kann ein <xref:System.Windows.Automation.AutomationElement> folgendermaßen abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="41e4a-153">In addition to searches and navigation, you can retrieve an <xref:System.Windows.Automation.AutomationElement> in the following ways.</span></span>  
  
### <a name="from-an-event"></a><span data-ttu-id="41e4a-154">Über ein Ereignis</span><span class="sxs-lookup"><span data-stu-id="41e4a-154">From an Event</span></span>  
 <span data-ttu-id="41e4a-155">Wenn Ihre Anwendung ein [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Ereignis empfängt, ist das an Ihren Ereignishandler übergebene Quellobjekt ein <xref:System.Windows.Automation.AutomationElement>.</span><span class="sxs-lookup"><span data-stu-id="41e4a-155">When your application receives a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] event, the source object passed to your event handler is an <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="41e4a-156">Wenn Sie beispielsweise Ereignisse abonniert haben, die durch Fokusänderung ausgelöst werden, wird das Element, das den Fokus erhalten hat, als Quelle an Ihren <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> übergeben.</span><span class="sxs-lookup"><span data-stu-id="41e4a-156">For example, if you have subscribed to focus-changed events, the source passed to your <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> is the element that received the focus.</span></span>  
  
 <span data-ttu-id="41e4a-157">Weitere Informationen finden Sie unter [Subscribe to UI Automation Events](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md).</span><span class="sxs-lookup"><span data-stu-id="41e4a-157">For more information, see [Subscribe to UI Automation Events](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md).</span></span>  
  
### <a name="from-a-point"></a><span data-ttu-id="41e4a-158">Über einen Punkt</span><span class="sxs-lookup"><span data-stu-id="41e4a-158">From a Point</span></span>  
 <span data-ttu-id="41e4a-159">Wenn Sie über Bildschirmkoordinaten (beispielsweise die Cursorposition) verfügen, können Sie ein <xref:System.Windows.Automation.AutomationElement> abrufen, indem Sie die statische <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> -Methode verwenden.</span><span class="sxs-lookup"><span data-stu-id="41e4a-159">If you have screen coordinates (for example, a cursor position), you can retrieve an <xref:System.Windows.Automation.AutomationElement> by using the static <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> method.</span></span>  
  
### <a name="from-a-window-handle"></a><span data-ttu-id="41e4a-160">Über ein Fensterhandle</span><span class="sxs-lookup"><span data-stu-id="41e4a-160">From a Window Handle</span></span>  
 <span data-ttu-id="41e4a-161">Um ein <xref:System.Windows.Automation.AutomationElement> aus einem HWND abzurufen, verwenden Sie die statische <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> -Methode.</span><span class="sxs-lookup"><span data-stu-id="41e4a-161">To retrieve an <xref:System.Windows.Automation.AutomationElement> from an HWND, use the static <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> method.</span></span>  
  
### <a name="from-the-focused-control"></a><span data-ttu-id="41e4a-162">Über das Steuerelement mit Fokus</span><span class="sxs-lookup"><span data-stu-id="41e4a-162">From the Focused Control</span></span>  
 <span data-ttu-id="41e4a-163">Sie können ein <xref:System.Windows.Automation.AutomationElement> , das das Steuerelement mit Fokus darstellt, aus der statischen <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> -Eigenschaft abrufen.</span><span class="sxs-lookup"><span data-stu-id="41e4a-163">You can retrieve an <xref:System.Windows.Automation.AutomationElement> that represents the focused control from the static <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="41e4a-164">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="41e4a-164">See also</span></span>

- [<span data-ttu-id="41e4a-165">Suchen eines Benutzeroberflächenautomatisierungs-Elements anhand einer Eigenschaftenbedingung</span><span class="sxs-lookup"><span data-stu-id="41e4a-165">Find a UI Automation Element Based on a Property Condition</span></span>](../../../docs/framework/ui-automation/find-a-ui-automation-element-based-on-a-property-condition.md)
- [<span data-ttu-id="41e4a-166">Navigieren zwischen Benutzeroberflächenautomatisierungs-Elementen mit TreeWalker</span><span class="sxs-lookup"><span data-stu-id="41e4a-166">Navigate Among UI Automation Elements with TreeWalker</span></span>](../../../docs/framework/ui-automation/navigate-among-ui-automation-elements-with-treewalker.md)
- [<span data-ttu-id="41e4a-167">Übersicht über die Benutzeroberflächenautomatisierungs-Struktur</span><span class="sxs-lookup"><span data-stu-id="41e4a-167">UI Automation Tree Overview</span></span>](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)
