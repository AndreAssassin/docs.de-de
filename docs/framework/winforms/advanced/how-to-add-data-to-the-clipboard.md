---
title: 'Vorgehensweise: Hinzufügen von Daten zur Zwischenablage'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Clipboard [Windows Forms], copying data to
- data [Windows Forms], copying to Clipboard
ms.assetid: 25152454-0e78-40a9-8a9e-a2a5a274e517
ms.openlocfilehash: 03d3a0c6026761fcdbc45472f2bbb7ac593f4394
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/18/2019
ms.locfileid: "59325682"
---
# <a name="how-to-add-data-to-the-clipboard"></a><span data-ttu-id="a32ef-102">Vorgehensweise: Hinzufügen von Daten zur Zwischenablage</span><span class="sxs-lookup"><span data-stu-id="a32ef-102">How to: Add Data to the Clipboard</span></span>
<span data-ttu-id="a32ef-103">Die <xref:System.Windows.Forms.Clipboard> -Klasse bietet Methoden, die Sie für die Interaktion mit der Windows-Betriebssystem-Zwischenablage-Funktion verwenden können.</span><span class="sxs-lookup"><span data-stu-id="a32ef-103">The <xref:System.Windows.Forms.Clipboard> class provides methods that you can use to interact with the Windows operating system Clipboard feature.</span></span> <span data-ttu-id="a32ef-104">Viele Anwendungen verwenden die Zwischenablage als temporäre Repository für Daten.</span><span class="sxs-lookup"><span data-stu-id="a32ef-104">Many applications use the Clipboard as a temporary repository for data.</span></span> <span data-ttu-id="a32ef-105">Beispielsweise werden die Zwischenablage von Textverarbeitungsprogrammen während Ausschneiden und Einfügen-Vorgänge verwenden.</span><span class="sxs-lookup"><span data-stu-id="a32ef-105">For example, word processors use the Clipboard during cut-and-paste operations.</span></span> <span data-ttu-id="a32ef-106">Die Zwischenablage eignet sich auch zum Übertragen von Daten aus einer Anwendung in eine andere.</span><span class="sxs-lookup"><span data-stu-id="a32ef-106">The Clipboard is also useful for transferring data from one application to another.</span></span>  
  
 <span data-ttu-id="a32ef-107">Wenn Sie Daten in die Zwischenablage hinzufügen, können Sie das Format der Daten, die angeben, damit andere Anwendungen die Daten erkennen können, wenn sie dieses Format verwenden können.</span><span class="sxs-lookup"><span data-stu-id="a32ef-107">When you add data to the Clipboard, you can indicate the data format so that other applications can recognize the data if they can use that format.</span></span> <span data-ttu-id="a32ef-108">Sie können auch Daten hinzufügen, in die Zwischenablage in mehreren verschiedenen Formaten, um die Anzahl von anderen Anwendungen zu erhöhen, die möglicherweise die Daten verwenden können.</span><span class="sxs-lookup"><span data-stu-id="a32ef-108">You can also add data to the Clipboard in multiple different formats to increase the number of other applications that can potentially use the data.</span></span>  
  
 <span data-ttu-id="a32ef-109">Ein Zwischenablageformat ist eine Zeichenfolge, die das Format identifiziert, so dass eine Anwendung, die dieses Format wird verwendet, die zugehörigen Daten abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="a32ef-109">A Clipboard format is a string that identifies the format so that an application that uses that format can retrieve the associated data.</span></span> <span data-ttu-id="a32ef-110">Die <xref:System.Windows.Forms.DataFormats> Klasse stellt vordefinierte Formatnamen für Ihre Verwendung.</span><span class="sxs-lookup"><span data-stu-id="a32ef-110">The <xref:System.Windows.Forms.DataFormats> class provides predefined format names for your use.</span></span> <span data-ttu-id="a32ef-111">Sie können auch eigene Formatnamen verwenden oder den Typ eines Objekts als Format.</span><span class="sxs-lookup"><span data-stu-id="a32ef-111">You can also use your own format names or use the type of an object as its format.</span></span>  
  
 <span data-ttu-id="a32ef-112">Verwenden Sie zum Hinzufügen von Daten in einem oder mehreren Formaten in die Zwischenablage die <xref:System.Windows.Forms.Clipboard.SetDataObject%2A> Methode.</span><span class="sxs-lookup"><span data-stu-id="a32ef-112">To add data to the Clipboard in one or multiple formats, use the <xref:System.Windows.Forms.Clipboard.SetDataObject%2A> method.</span></span> <span data-ttu-id="a32ef-113">Sie können jedes beliebige Objekt an diese Methode übergeben, aber um die Daten in mehreren Formaten hinzufügen, müssen Sie zunächst die Daten hinzufügen, um ein separates Objekt mit mehreren Formaten funktionieren.</span><span class="sxs-lookup"><span data-stu-id="a32ef-113">You can pass any object to this method, but to add data in multiple formats, you must first add the data to a separate object designed to work with multiple formats.</span></span> <span data-ttu-id="a32ef-114">In der Regel fügen Sie Ihre Daten in eine <xref:System.Windows.Forms.DataObject>, aber Sie können alle Typen, implementieren die <xref:System.Windows.Forms.IDataObject> Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="a32ef-114">Typically, you will add your data to a <xref:System.Windows.Forms.DataObject>, but you can use any type that implements the <xref:System.Windows.Forms.IDataObject> interface.</span></span>  
  
 <span data-ttu-id="a32ef-115">In [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)], Sie können Daten direkt in die Zwischenablage hinzufügen, mit der neuen Methoden entwickelt, um grundlegende Aufgaben der Zwischenablage zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="a32ef-115">In [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)], you can add data directly to the Clipboard by using new methods designed to make basic Clipboard tasks easier.</span></span> <span data-ttu-id="a32ef-116">Verwenden Sie diese Methoden, bei der Arbeit mit Daten in einem einzelnen, gemeinsamen Format z. B. Text.</span><span class="sxs-lookup"><span data-stu-id="a32ef-116">Use these methods when you work with data in a single, common format such as text.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a32ef-117">Alle Teilen Windows-basierten Anwendungen sich die Zwischenablage.</span><span class="sxs-lookup"><span data-stu-id="a32ef-117">All Windows-based applications share the Clipboard.</span></span> <span data-ttu-id="a32ef-118">Aus diesem Grund werden die Inhalte können geändert werden, wenn Sie in einer anderen Anwendung wechseln.</span><span class="sxs-lookup"><span data-stu-id="a32ef-118">Therefore, the contents are subject to change when you switch to another application.</span></span>  
>   
>  <span data-ttu-id="a32ef-119">Die <xref:System.Windows.Forms.Clipboard> Klasse kann nur in Threads auf Singlethread-Apartment (STA) Modus verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="a32ef-119">The <xref:System.Windows.Forms.Clipboard> class can only be used in threads set to single thread apartment (STA) mode.</span></span> <span data-ttu-id="a32ef-120">Um diese Klasse verwenden zu können, stellen sicher, dass Ihre `Main` Methode ist mit markiert die <xref:System.STAThreadAttribute> Attribut.</span><span class="sxs-lookup"><span data-stu-id="a32ef-120">To use this class, ensure that your `Main` method is marked with the <xref:System.STAThreadAttribute> attribute.</span></span>  
>   
>  <span data-ttu-id="a32ef-121">Ein Objekt müssen Sie in der Zwischenablage abgelegt werden serialisierbar sein.</span><span class="sxs-lookup"><span data-stu-id="a32ef-121">An object must be serializable for it to be put on the Clipboard.</span></span> <span data-ttu-id="a32ef-122">Um einen Typ serialisierbar zu machen, markieren Sie sie mit der <xref:System.SerializableAttribute> Attribut.</span><span class="sxs-lookup"><span data-stu-id="a32ef-122">To make a type serializable, mark it with the <xref:System.SerializableAttribute> attribute.</span></span> <span data-ttu-id="a32ef-123">Wenn Sie ein nicht serialisierbares Objekt an eine Zwischenablage-Methode übergeben, wird die Methode fehlschlagen, ohne eine Ausnahme auszulösen.</span><span class="sxs-lookup"><span data-stu-id="a32ef-123">If you pass a non-serializable object to a Clipboard method, the method will fail without throwing an exception.</span></span> <span data-ttu-id="a32ef-124">Weitere Informationen zur Serialisierung finden Sie unter <xref:System.Runtime.Serialization>.</span><span class="sxs-lookup"><span data-stu-id="a32ef-124">For more information about serialization, see <xref:System.Runtime.Serialization>.</span></span>  
  
### <a name="to-add-data-to-the-clipboard-in-a-single-common-format"></a><span data-ttu-id="a32ef-125">Zum Hinzufügen von Daten in einem einzelnen, gemeinsamen Format in die Zwischenablage</span><span class="sxs-lookup"><span data-stu-id="a32ef-125">To add data to the Clipboard in a single, common format</span></span>  
  
1. <span data-ttu-id="a32ef-126">Verwenden der <xref:System.Windows.Forms.Clipboard.SetAudio%2A>, <xref:System.Windows.Forms.Clipboard.SetFileDropList%2A>, <xref:System.Windows.Forms.Clipboard.SetImage%2A>, oder <xref:System.Windows.Forms.Clipboard.SetText%2A> Methode.</span><span class="sxs-lookup"><span data-stu-id="a32ef-126">Use the <xref:System.Windows.Forms.Clipboard.SetAudio%2A>, <xref:System.Windows.Forms.Clipboard.SetFileDropList%2A>, <xref:System.Windows.Forms.Clipboard.SetImage%2A>, or <xref:System.Windows.Forms.Clipboard.SetText%2A> method.</span></span> <span data-ttu-id="a32ef-127">Diese Methoden stehen nur in [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a32ef-127">These methods are available only in [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)].</span></span>  
  
     [!code-csharp[System.Windows.Forms.Clipboard#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#2)]
     [!code-vb[System.Windows.Forms.Clipboard#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#2)]  
  
### <a name="to-add-data-to-the-clipboard-in-a-custom-format"></a><span data-ttu-id="a32ef-128">Zum Hinzufügen von Daten in einem benutzerdefinierten Format in die Zwischenablage</span><span class="sxs-lookup"><span data-stu-id="a32ef-128">To add data to the Clipboard in a custom format</span></span>  
  
1. <span data-ttu-id="a32ef-129">Verwenden der <xref:System.Windows.Forms.Clipboard.SetData%2A> Methode mit einem benutzerdefinierten Format-Namen.</span><span class="sxs-lookup"><span data-stu-id="a32ef-129">Use the <xref:System.Windows.Forms.Clipboard.SetData%2A> method with a custom format name.</span></span> <span data-ttu-id="a32ef-130">Diese Methode ist nur in verfügbar [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a32ef-130">This method is available only in [!INCLUDE[dnprdnext](../../../../includes/dnprdnext-md.md)].</span></span>  
  
     <span data-ttu-id="a32ef-131">Sie können auch die Namen von vordefinierten Format mit der <xref:System.Windows.Forms.Clipboard.SetData%2A> Methode.</span><span class="sxs-lookup"><span data-stu-id="a32ef-131">You can also use predefined format names with the <xref:System.Windows.Forms.Clipboard.SetData%2A> method.</span></span> <span data-ttu-id="a32ef-132">Weitere Informationen finden Sie unter <xref:System.Windows.Forms.DataFormats>.</span><span class="sxs-lookup"><span data-stu-id="a32ef-132">For more information, see <xref:System.Windows.Forms.DataFormats>.</span></span>  
  
     [!code-csharp[System.Windows.Forms.Clipboard#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#3)]
     [!code-vb[System.Windows.Forms.Clipboard#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#3)]  
    [!code-csharp[System.Windows.Forms.Clipboard#100](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#100)]
    [!code-vb[System.Windows.Forms.Clipboard#100](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#100)]  
  
### <a name="to-add-data-to-the-clipboard-in-multiple-formats"></a><span data-ttu-id="a32ef-133">Zum Hinzufügen von Daten in die Zwischenablage in mehreren Formaten</span><span class="sxs-lookup"><span data-stu-id="a32ef-133">To add data to the Clipboard in multiple formats</span></span>  
  
1. <span data-ttu-id="a32ef-134">Verwenden der <xref:System.Windows.Forms.Clipboard.SetDataObject%2A> -Methode und übergeben Sie einen <xref:System.Windows.Forms.DataObject> , die Ihre Daten enthält.</span><span class="sxs-lookup"><span data-stu-id="a32ef-134">Use the <xref:System.Windows.Forms.Clipboard.SetDataObject%2A> method and pass in a <xref:System.Windows.Forms.DataObject> that contains your data.</span></span> <span data-ttu-id="a32ef-135">Sie müssen diese Methode verwenden, zum Hinzufügen von Daten in die Zwischenablage auf Versionen vor [!INCLUDE[dnprdnlong](../../../../includes/dnprdnlong-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a32ef-135">You must use this method to add data to the Clipboard on versions earlier than [!INCLUDE[dnprdnlong](../../../../includes/dnprdnlong-md.md)].</span></span>  
  
     [!code-csharp[System.Windows.Forms.Clipboard#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#4)]
     [!code-vb[System.Windows.Forms.Clipboard#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#4)]  
    [!code-csharp[System.Windows.Forms.Clipboard#100](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/CS/form1.cs#100)]
    [!code-vb[System.Windows.Forms.Clipboard#100](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Clipboard/vb/form1.vb#100)]  
  
## <a name="see-also"></a><span data-ttu-id="a32ef-136">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="a32ef-136">See also</span></span>

- [<span data-ttu-id="a32ef-137">Drag & Drop-Vorgänge und Unterstützung der Zwischenablage</span><span class="sxs-lookup"><span data-stu-id="a32ef-137">Drag-and-Drop Operations and Clipboard Support</span></span>](drag-and-drop-operations-and-clipboard-support.md)
- [<span data-ttu-id="a32ef-138">Vorgehensweise: Abrufen von Daten aus der Zwischenablage</span><span class="sxs-lookup"><span data-stu-id="a32ef-138">How to: Retrieve Data from the Clipboard</span></span>](how-to-retrieve-data-from-the-clipboard.md)
