---
title: Architektur der Anwendungseinstellungen
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- application settings [Windows Forms], architecture
ms.assetid: c8eb2ad0-fac6-4ea2-9140-675a4a44d562
ms.openlocfilehash: 078b5f3fc1cd4273af282580f41e68ca9bd8ff51
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/12/2020
ms.locfileid: "79182629"
---
# <a name="application-settings-architecture"></a><span data-ttu-id="64478-102">Architektur der Anwendungseinstellungen</span><span class="sxs-lookup"><span data-stu-id="64478-102">Application Settings Architecture</span></span>
<span data-ttu-id="64478-103">In diesem Thema wird beschrieben, wie die Architektur der Anwendungseinstellungen funktioniert. Außerdem werden erweiterte Funktionen der Architektur erläutert, z.B. gruppierte Einstellungen und Einstellungsschlüssel.</span><span class="sxs-lookup"><span data-stu-id="64478-103">This topic describes how the Application Settings architecture works, and explores advanced features of the architecture, such as grouped settings and settings keys.</span></span>

 <span data-ttu-id="64478-104">Die Architektur der Anwendungseinstellungen unterstützt definierende, stark typisierte Einstellungen mit Geltungsbereich Anwendung oder Benutzer sowie die Beibehaltung der Einstellungen zwischen Anwendungssitzungen.</span><span class="sxs-lookup"><span data-stu-id="64478-104">The application settings architecture supports defining strongly typed settings with either application or user scope, and persisting the settings between application sessions.</span></span> <span data-ttu-id="64478-105">Die Architektur bietet eine Standardpersistenz-Engine zum Speichern von Einstellungen und Laden aus dem lokalen Dateisystem.</span><span class="sxs-lookup"><span data-stu-id="64478-105">The architecture provides a default persistence engine for saving settings to and loading them from the local file system.</span></span> <span data-ttu-id="64478-106">Die Architektur definiert auch Schnittstellen zur Bereitstellung einer benutzerdefinierten Persistenz-Engine.</span><span class="sxs-lookup"><span data-stu-id="64478-106">The architecture also defines interfaces for supplying a custom persistence engine.</span></span>

 <span data-ttu-id="64478-107">Schnittstellen werden bereitgestellt, die benutzerdefinierten Komponenten ermöglichen, ihre eigenen Einstellungen beizubehalten, wenn sie in einer Anwendung gehostet werden können.</span><span class="sxs-lookup"><span data-stu-id="64478-107">Interfaces are provided that enable custom components to persist their own settings when they are hosted in an application.</span></span> <span data-ttu-id="64478-108">Mithilfe von Einstellungsschlüsseln können Komponenten Einstellungen für mehrere Instanzen der Komponente getrennt halten.</span><span class="sxs-lookup"><span data-stu-id="64478-108">By using settings keys, components can keep settings for multiple instances of the component separate.</span></span>

## <a name="defining-settings"></a><span data-ttu-id="64478-109">Definieren von Einstellungen</span><span class="sxs-lookup"><span data-stu-id="64478-109">Defining Settings</span></span>
 <span data-ttu-id="64478-110">Die Architektur der Anwendungseinstellungen wird sowohl in ASP.NET als auch in Windows Forms verwendet und enthält eine Reihe von Basisklassen, die in beiden Umgebungen gemeinsam genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="64478-110">The application settings architecture is used within both ASP.NET and Windows Forms, and it contains a number of base classes that are shared across both environments.</span></span> <span data-ttu-id="64478-111">Die wichtigste <xref:System.Configuration.SettingsBase>ist , die Zugriff auf Einstellungen über eine Auflistung bietet und Low-Level-Methoden zum Laden und Speichern von Einstellungen bietet.</span><span class="sxs-lookup"><span data-stu-id="64478-111">The most important is <xref:System.Configuration.SettingsBase>, which provides access to settings through a collection, and provides low-level methods for loading and saving settings.</span></span> <span data-ttu-id="64478-112">Jede Umgebung implementiert eine eigene <xref:System.Configuration.SettingsBase> Klasse, von der abgeleitet wird, um zusätzliche Einstellungsfunktionen für diese Umgebung bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="64478-112">Each environment implements its own class derived from <xref:System.Configuration.SettingsBase> to provide additional settings functionality for that environment.</span></span> <span data-ttu-id="64478-113">In einer Windows Forms-basierten Anwendung müssen alle Anwendungseinstellungen für <xref:System.Configuration.ApplicationSettingsBase> eine von der Klasse abgeleitete Klasse definiert werden, wodurch der Basisklasse die folgenden Funktionen hinzugefügt werden:</span><span class="sxs-lookup"><span data-stu-id="64478-113">In a Windows Forms-based application, all application settings must be defined on a class derived from the <xref:System.Configuration.ApplicationSettingsBase> class, which adds the following functionality to the base class:</span></span>

- <span data-ttu-id="64478-114">Lade- und Speichervorgänge auf höherer Ebene</span><span class="sxs-lookup"><span data-stu-id="64478-114">Higher-level loading and saving operations</span></span>

- <span data-ttu-id="64478-115">Unterstützung für benutzerspezifische Einstellungen</span><span class="sxs-lookup"><span data-stu-id="64478-115">Support for user-scoped settings</span></span>

- <span data-ttu-id="64478-116">Wiederherstellen der vordefinierten Standardeinstellungen eines Benutzers</span><span class="sxs-lookup"><span data-stu-id="64478-116">Reverting a user's settings to the predefined defaults</span></span>

- <span data-ttu-id="64478-117">Aktualisieren von Einstellungen aus einer früheren Anwendungsversion</span><span class="sxs-lookup"><span data-stu-id="64478-117">Upgrading settings from a previous application version</span></span>

- <span data-ttu-id="64478-118">Überprüfen von Einstellungen, bevor sie geändert oder bevor sie gespeichert werden</span><span class="sxs-lookup"><span data-stu-id="64478-118">Validating settings, either before they are changed or before they are saved</span></span>

 <span data-ttu-id="64478-119">Die Einstellungen können mit einer Reihe von <xref:System.Configuration> Attributen beschrieben werden, die im Namespace definiert sind. Diese werden unter [Anwendungseinstellungsattribute](application-settings-attributes.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="64478-119">The settings can be described using a number of attributes defined within the <xref:System.Configuration> namespace; these are described in [Application Settings Attributes](application-settings-attributes.md).</span></span> <span data-ttu-id="64478-120">Wenn Sie eine Einstellung definieren, müssen <xref:System.Configuration.ApplicationScopedSettingAttribute> <xref:System.Configuration.UserScopedSettingAttribute>Sie sie mit einer oder anwenden, die beschreibt, ob die Einstellung für die gesamte Anwendung oder nur für den aktuellen Benutzer gilt.</span><span class="sxs-lookup"><span data-stu-id="64478-120">When you define a setting, you must apply it with either <xref:System.Configuration.ApplicationScopedSettingAttribute> or <xref:System.Configuration.UserScopedSettingAttribute>, which describes whether the setting applies to the entire application or just to the current user.</span></span>

 <span data-ttu-id="64478-121">Das folgende Codebeispiel definiert eine benutzerdefinierte Einstellungsklasse mit einer Einstellung: `BackgroundColor`.</span><span class="sxs-lookup"><span data-stu-id="64478-121">The following code example defines a custom settings class with a single setting, `BackgroundColor`.</span></span>

 [!code-csharp[ApplicationSettings.Create#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Create/CS/MyAppSettings.cs#1)]
 [!code-vb[ApplicationSettings.Create#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Create/VB/MyAppSettings.vb#1)]

## <a name="settings-persistence"></a><span data-ttu-id="64478-122">Beibehaltung von Einstellungen</span><span class="sxs-lookup"><span data-stu-id="64478-122">Settings Persistence</span></span>
 <span data-ttu-id="64478-123">Die <xref:System.Configuration.ApplicationSettingsBase> Klasse selbst besteht nicht oder lädt die Einstellungen nicht. Dieser Auftrag fällt an den Einstellungsanbieter, <xref:System.Configuration.SettingsProvider>eine Klasse, die von ableitet.</span><span class="sxs-lookup"><span data-stu-id="64478-123">The <xref:System.Configuration.ApplicationSettingsBase> class does not itself persist or load settings; this job falls to the settings provider, a class that derives from <xref:System.Configuration.SettingsProvider>.</span></span> <span data-ttu-id="64478-124">Wenn eine abgeleitete Klasse von <xref:System.Configuration.ApplicationSettingsBase> keinen <xref:System.Configuration.SettingsProviderAttribute>Einstellungsanbieter über <xref:System.Configuration.LocalFileSettingsProvider>die angibt, wird der Standardanbieter , verwendet.</span><span class="sxs-lookup"><span data-stu-id="64478-124">If a derived class of <xref:System.Configuration.ApplicationSettingsBase> does not specify a settings provider through the <xref:System.Configuration.SettingsProviderAttribute>, then the default provider, <xref:System.Configuration.LocalFileSettingsProvider>, is used.</span></span>

 <span data-ttu-id="64478-125">Das Konfigurationssystem, das ursprünglich mit .NET Framework veröffentlicht wurde, unterstützt die Bereitstellung statischer Anwendungskonfigurationsdaten entweder über die Computer.config-Datei des lokalen Computers oder in einer `app.`exe.config-Datei, die Sie mit Ihrer Anwendung bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="64478-125">The configuration system that was originally released with the .NET Framework supports providing static application configuration data through either the local computer's machine.config file or within an `app.`exe.config file that you deploy with your application.</span></span> <span data-ttu-id="64478-126">Die <xref:System.Configuration.LocalFileSettingsProvider> Klasse erweitert diese systemeigene Unterstützung auf folgende Weise:</span><span class="sxs-lookup"><span data-stu-id="64478-126">The <xref:System.Configuration.LocalFileSettingsProvider> class expands this native support in the following ways:</span></span>

- <span data-ttu-id="64478-127">Anwendungsspezifische Einstellungen können in der Datei machine.config oder `app.`exe.config gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="64478-127">Application-scoped settings can be stored in either the machine.config or `app.`exe.config files.</span></span> <span data-ttu-id="64478-128">Die Datei machine.config ist immer schreibgeschützt, während `app`. exe.config aufgrund von Sicherheitsüberlegungen für die meisten Anwendungen schreibgeschützt ist.</span><span class="sxs-lookup"><span data-stu-id="64478-128">Machine.config is always read-only, while `app`.exe.config is restricted by security considerations to read-only for most applications.</span></span>

- <span data-ttu-id="64478-129">Benutzerspezifische Einstellungen können in `app`. exe.config-Dateien gespeichert werden und werden dann als statische Standardwerte behandelt.</span><span class="sxs-lookup"><span data-stu-id="64478-129">User-scoped settings can be stored in `app`.exe.config files, in which case they are treated as static defaults.</span></span>

- <span data-ttu-id="64478-130">Nicht standardmäßige benutzerspezifische Einstellungen werden in einer neuen Datei, *benutzer*.config gespeichert, wobei *benutzer* der Benutzername der Person ist, die aktuell die Anwendung ausführt.</span><span class="sxs-lookup"><span data-stu-id="64478-130">Non-default user-scoped settings are stored in a new file, *user*.config, where *user* is the user name of the person currently executing the application.</span></span> <span data-ttu-id="64478-131">Sie können einen Standardwert für eine <xref:System.Configuration.DefaultSettingValueAttribute>benutzerbezogene Einstellung mit angeben.</span><span class="sxs-lookup"><span data-stu-id="64478-131">You can specify a default for a user-scoped setting with <xref:System.Configuration.DefaultSettingValueAttribute>.</span></span> <span data-ttu-id="64478-132">Da sich benutzerspezifische Einstellungen häufig während der Ausführung der Anwendung ändern, hat `user`config Lese-/Schreibzugriff.</span><span class="sxs-lookup"><span data-stu-id="64478-132">Because user-scoped settings often change during application execution, `user`.config is always read/write.</span></span>

 <span data-ttu-id="64478-133">Alle drei Konfigurationsdateien speichern Einstellungen im XML-Format.</span><span class="sxs-lookup"><span data-stu-id="64478-133">All three configuration files store settings in XML format.</span></span> <span data-ttu-id="64478-134">Das XML-Element der obersten Ebene für anwendungsspezifische Einstellungen ist `<appSettings>`, während `<userSettings>` für die benutzerspezifischen Einstellungen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="64478-134">The top-level XML element for application-scoped settings is `<appSettings>`, while `<userSettings>` is used for user-scoped settings.</span></span> <span data-ttu-id="64478-135">Eine `app`. exe.config-Datei mit anwendungsspezifischen Einstellungen und Standardwerten für benutzerspezifische Einstellungen sieht wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="64478-135">An `app`.exe.config file which contains both application-scoped settings and defaults for user-scoped settings would look like this:</span></span>

```xml
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <configSections>
        <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
            <section name="WindowsApplication1.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
        </sectionGroup>
        <sectionGroup name="userSettings" type="System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
            <section name="WindowsApplication1.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" />
        </sectionGroup>
    </configSections>
    <applicationSettings>
        <WindowsApplication1.Properties.Settings>
            <setting name="Cursor" serializeAs="String">
                <value>Default</value>
            </setting>
            <setting name="DoubleBuffering" serializeAs="String">
                <value>False</value>
            </setting>
        </WindowsApplication1.Properties.Settings>
    </applicationSettings>
    <userSettings>
        <WindowsApplication1.Properties.Settings>
            <setting name="FormTitle" serializeAs="String">
                <value>Form1</value>
            </setting>
            <setting name="FormSize" serializeAs="String">
                <value>595, 536</value>
            </setting>
        </WindowsApplication1.Properties.Settings>
    </userSettings>
</configuration>
```

 <span data-ttu-id="64478-136">Eine Definition der Elemente im Abschnitt Anwendungseinstellungen einer Konfigurationsdatei finden Sie unter [Schema für Anwendungseinstellungen](../../configure-apps/file-schema/application-settings-schema.md).</span><span class="sxs-lookup"><span data-stu-id="64478-136">For a definition of the elements within the application settings section of a configuration file, see [Application Settings Schema](../../configure-apps/file-schema/application-settings-schema.md).</span></span>

### <a name="settings-bindings"></a><span data-ttu-id="64478-137">Einstellungen für Bindungen</span><span class="sxs-lookup"><span data-stu-id="64478-137">Settings Bindings</span></span>
 <span data-ttu-id="64478-138">Anwendungseinstellungen verwenden die Datenbindungsarchitektur von Windows Forms, um die bidirektionale Kommunikation von Einstellungsaktualisierungen zwischen dem Einstellungsobjekt und den Komponenten bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="64478-138">Application settings uses the Windows Forms data binding architecture to provide two-way communication of settings updates between the settings object and components.</span></span> <span data-ttu-id="64478-139">Wenn Sie mit Visual Studio Anwendungseinstellungen erstellen und diese Komponenteneigenschaften zuordnen, werden die Bindungen automatisch generiert.</span><span class="sxs-lookup"><span data-stu-id="64478-139">If you use Visual Studio to create application settings and assign them to component properties, these bindings are generated automatically.</span></span>

 <span data-ttu-id="64478-140">Sie können eine Anwendungseinstellung nur an <xref:System.Windows.Forms.IBindableComponent> eine Komponente binden, die die Schnittstelle unterstützt.</span><span class="sxs-lookup"><span data-stu-id="64478-140">You can only bind an application setting to a component that supports the <xref:System.Windows.Forms.IBindableComponent> interface.</span></span> <span data-ttu-id="64478-141">Außerdem muss die Komponente ein Änderungsereignis für eine bestimmte gebundene Eigenschaft implementieren <xref:System.ComponentModel.INotifyPropertyChanged> oder Anwendungseinstellungen benachrichtigen, dass sich die Eigenschaft über die Schnittstelle geändert hat.</span><span class="sxs-lookup"><span data-stu-id="64478-141">Also, the component must implement a change event for a specific bound property, or notify application settings that the property has changed through the <xref:System.ComponentModel.INotifyPropertyChanged> interface.</span></span> <span data-ttu-id="64478-142">Wenn die Komponente <xref:System.Windows.Forms.IBindableComponent> nicht implementiert wird und Sie über Visual Studio binden, werden die gebundenen Eigenschaften beim ersten Mal festgelegt, aber nicht aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="64478-142">If the component does not implement <xref:System.Windows.Forms.IBindableComponent> and you are binding through Visual Studio, the bound properties will be set the first time, but will not update.</span></span> <span data-ttu-id="64478-143">Wenn die Komponente <xref:System.Windows.Forms.IBindableComponent> Benachrichtigungen über Eigenschaftenänderungen implementiert, aber nicht unterstützt, wird die Bindung in der Einstellungsdatei nicht aktualisiert, wenn die Eigenschaft geändert wird.</span><span class="sxs-lookup"><span data-stu-id="64478-143">If the component implements <xref:System.Windows.Forms.IBindableComponent> but does not support property change notifications, the binding will not update in the settings file when the property is changed.</span></span>

 <span data-ttu-id="64478-144">Einige Windows Forms-Komponenten, z. <xref:System.Windows.Forms.ToolStripItem>B. , unterstützen keine Einstellungsbindungen.</span><span class="sxs-lookup"><span data-stu-id="64478-144">Some Windows Forms components, such as <xref:System.Windows.Forms.ToolStripItem>, do not support settings bindings.</span></span>

### <a name="settings-serialization"></a><span data-ttu-id="64478-145">Serialisierung von Einstellungen</span><span class="sxs-lookup"><span data-stu-id="64478-145">Settings Serialization</span></span>
 <span data-ttu-id="64478-146">Wenn <xref:System.Configuration.LocalFileSettingsProvider> Einstellungen auf dem Datenträger gespeichert werden müssen, führt es die folgenden Aktionen aus:</span><span class="sxs-lookup"><span data-stu-id="64478-146">When <xref:System.Configuration.LocalFileSettingsProvider> must save settings to disk, it performs the following actions:</span></span>

1. <span data-ttu-id="64478-147">Verwendet Reflektion, um alle Eigenschaften <xref:System.Configuration.ApplicationSettingsBase> zu untersuchen, die für <xref:System.Configuration.ApplicationScopedSettingAttribute> die <xref:System.Configuration.UserScopedSettingAttribute>abgeleitete Klasse definiert sind, und findet diejenigen, die mit entweder oder angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="64478-147">Uses reflection to examine all of the properties defined on your <xref:System.Configuration.ApplicationSettingsBase> derived class, finding those that are applied with either <xref:System.Configuration.ApplicationScopedSettingAttribute> or <xref:System.Configuration.UserScopedSettingAttribute>.</span></span>

2. <span data-ttu-id="64478-148">Serialisieren der Eigenschaft auf den Datenträger.</span><span class="sxs-lookup"><span data-stu-id="64478-148">Serializes the property to disk.</span></span> <span data-ttu-id="64478-149">Es wird zunächst <xref:System.ComponentModel.TypeConverter.ConvertToString%2A> versucht, den oder <xref:System.ComponentModel.TypeConverter.ConvertFromString%2A> <xref:System.ComponentModel.TypeConverter>auf dem zugeordneten Typ aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="64478-149">It first attempts to call the <xref:System.ComponentModel.TypeConverter.ConvertToString%2A> or <xref:System.ComponentModel.TypeConverter.ConvertFromString%2A> on the type's associated <xref:System.ComponentModel.TypeConverter>.</span></span> <span data-ttu-id="64478-150">Schlägt der Versuch fehl, wird stattdessen die XML-Serialisierung angewendet.</span><span class="sxs-lookup"><span data-stu-id="64478-150">If this does not succeed, it uses XML serialization instead.</span></span>

3. <span data-ttu-id="64478-151">Bestimmen, welche Einstellungen in welche Datei übergehen, basierend auf dem Attribut der Einstellung.</span><span class="sxs-lookup"><span data-stu-id="64478-151">Determines which settings go in which files, based on the setting's attribute.</span></span>

 <span data-ttu-id="64478-152">Wenn Sie eine eigene Einstellungsklasse <xref:System.Configuration.SettingsSerializeAsAttribute> implementieren, können Sie die verwenden, um <xref:System.Configuration.SettingsSerializeAs> eine Einstellung für die binäre oder benutzerdefinierte Serialisierung mithilfe der Enumeration zu markieren.</span><span class="sxs-lookup"><span data-stu-id="64478-152">If you implement your own settings class, you can use the <xref:System.Configuration.SettingsSerializeAsAttribute> to mark a setting for either binary or custom serialization using the <xref:System.Configuration.SettingsSerializeAs> enumeration.</span></span> <span data-ttu-id="64478-153">Weitere Informationen zum Erstellen eigener Einstellungen finden Sie unter [Vorgehensweise: Erstellen von Anwendungseinstellungen](how-to-create-application-settings.md).</span><span class="sxs-lookup"><span data-stu-id="64478-153">For more information on creating your own settings class in code, see [How to: Create Application Settings](how-to-create-application-settings.md).</span></span>

### <a name="settings-file-locations"></a><span data-ttu-id="64478-154">Speicherorte für Einstellungsdateien</span><span class="sxs-lookup"><span data-stu-id="64478-154">Settings File Locations</span></span>
 <span data-ttu-id="64478-155">Der Speicherort der Dateien `app`. exe.config und *benutzer*.config hängt davon ab, wie die Anwendung installiert ist.</span><span class="sxs-lookup"><span data-stu-id="64478-155">The location of the `app`.exe.config and *user*.config files will differ based on how the application is installed.</span></span> <span data-ttu-id="64478-156">Bei einer Windows Forms-basierten Anwendung, die `app`auf den lokalen Computer kopiert wird, befindet sich .exe.config im selben Verzeichnis wie das Basisverzeichnis der <xref:System.Windows.Forms.Application.LocalUserAppDataPath%2A?displayProperty=nameWithType> Hauptdatei der ausführbaren Datei der Anwendung, und *Benutzer*.config befindet sich an dem von der Eigenschaft angegebenen Speicherort.</span><span class="sxs-lookup"><span data-stu-id="64478-156">For a Windows Forms-based application copied onto the local computer, `app`.exe.config will reside in the same directory as the base directory of the application's main executable file, and *user*.config will reside in the location specified by the <xref:System.Windows.Forms.Application.LocalUserAppDataPath%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="64478-157">Für eine Anwendung, die mit ClickOnce installiert wird, befinden sich beide Dateien im ClickOnce-Datenverzeichnis unter %InstallRoot%-Documents und\\*Settings-Benutzernamen*.</span><span class="sxs-lookup"><span data-stu-id="64478-157">For an application installed by means of ClickOnce, both of these files will reside in the ClickOnce Data Directory underneath %InstallRoot%\Documents and Settings\\*username*\Local Settings.</span></span>

 <span data-ttu-id="64478-158">Der Speicherort dieser Dateien unterscheidet sich geringfügig, wenn ein Benutzer Roamingprofile aktiviert hat, wodurch ein Benutzer verschiedene Windows- und Anwendungseinstellungen definieren kann, wenn er andere Computer innerhalb einer Domäne verwendet.</span><span class="sxs-lookup"><span data-stu-id="64478-158">The storage location of these files is slightly different if a user has enabled roaming profiles, which enables a user to define different Windows and application settings when they are using other computers within a domain.</span></span> <span data-ttu-id="64478-159">In diesem Fall werden sowohl ClickOnce-Anwendungen als `app`auch Nicht-ClickOnce-Anwendungen ihre .exe.config- und *Benutzer*-Konfigurationsdateien unter %InstallRoot%-Dokumente und\\*Einstellungen-Benutzernamen*.Application Data gespeichert.</span><span class="sxs-lookup"><span data-stu-id="64478-159">In that case, both ClickOnce applications and non-ClickOnce applications will have their `app`.exe.config and *user*.config files stored under %InstallRoot%\Documents and Settings\\*username*\Application Data.</span></span>

 <span data-ttu-id="64478-160">Weitere Informationen zur Funktionsweise der Anwendungseinstellungen mit der neuen Bereitstellungstechnologie finden Sie unter [ClickOnce und Anwendungseinstellungen](/visualstudio/deployment/clickonce-and-application-settings).</span><span class="sxs-lookup"><span data-stu-id="64478-160">For more information about how the Application Settings feature works with the new deployment technology, see [ClickOnce and Application Settings](/visualstudio/deployment/clickonce-and-application-settings).</span></span> <span data-ttu-id="64478-161">Weitere Informationen zum ClickOnce-Datenverzeichnis finden Sie [unter Zugriff auf lokale und Remotedaten in ClickOnce-Anwendungen](/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications).</span><span class="sxs-lookup"><span data-stu-id="64478-161">For more information about the ClickOnce Data Directory, see [Accessing Local and Remote Data in ClickOnce Applications](/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications).</span></span>

## <a name="application-settings-and-security"></a><span data-ttu-id="64478-162">Einstellungen und Sicherheit von Anwendungen</span><span class="sxs-lookup"><span data-stu-id="64478-162">Application Settings and Security</span></span>
 <span data-ttu-id="64478-163">Anwendungseinstellungen sollen in teilweiser Vertrauenswürdigkeit, einer eingeschränkten Umgebung, funktionieren, die der Standard für über das Internet oder ein Intranet gehostete Windows Forms-Anwendungen ist.</span><span class="sxs-lookup"><span data-stu-id="64478-163">Application settings are designed to work in partial trust, a restricted environment that is the default for Windows Forms applications hosted over the Internet or an intranet.</span></span> <span data-ttu-id="64478-164">Außer teilweiser Vertrauenswürdigkeit sind keine besonderen Berechtigungen erforderlich, um Anwendungseinstellungen mit dem Standardeinstellungsanbieter zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="64478-164">No special permissions beyond partial trust are needed to use application settings with the default settings provider.</span></span>

 <span data-ttu-id="64478-165">Wenn Anwendungseinstellungen in einer ClickOnce-Anwendung verwendet werden, wird die `user`.config-Datei im Datenverzeichnis ClickOnce gespeichert.</span><span class="sxs-lookup"><span data-stu-id="64478-165">When application settings are used in a ClickOnce application, the `user`.config file is stored in the ClickOnce data directory.</span></span> <span data-ttu-id="64478-166">Die Größe der `user`.config-Datei der Anwendung darf das von ClickOnce festgelegte Datenverzeichniskontingent nicht überschreiten.</span><span class="sxs-lookup"><span data-stu-id="64478-166">The size of the application's `user`.config file cannot exceed the data directory quota set by ClickOnce.</span></span> <span data-ttu-id="64478-167">Weitere Informationen finden Sie unter [ClickOnce und Anwendungseinstellungen](/visualstudio/deployment/clickonce-and-application-settings).</span><span class="sxs-lookup"><span data-stu-id="64478-167">For more information, see [ClickOnce and Application Settings](/visualstudio/deployment/clickonce-and-application-settings).</span></span>

## <a name="custom-settings-providers"></a><span data-ttu-id="64478-168">Benutzerdefinierte Einstellungsanbieter</span><span class="sxs-lookup"><span data-stu-id="64478-168">Custom Settings Providers</span></span>
 <span data-ttu-id="64478-169">In der Architektur der Anwendungseinstellungen gibt es eine lose Kopplung <xref:System.Configuration.ApplicationSettingsBase>zwischen der Wrapperklasse der Anwendungseinstellungen, abgeleitet von , und dem zugehörigen Einstellungsanbieter oder -anbieter, abgeleitet von <xref:System.Configuration.SettingsProvider>.</span><span class="sxs-lookup"><span data-stu-id="64478-169">In the Application Settings architecture, there is a loose coupling between the applications settings wrapper class, derived from <xref:System.Configuration.ApplicationSettingsBase>, and the associated settings provider or providers, derived from <xref:System.Configuration.SettingsProvider>.</span></span> <span data-ttu-id="64478-170">Diese Zuordnung wird nur <xref:System.Configuration.SettingsProviderAttribute> durch die auf die Wrapperklasse oder ihre einzelnen Eigenschaften angewendete Zuordnung definiert.</span><span class="sxs-lookup"><span data-stu-id="64478-170">This association is defined only by the <xref:System.Configuration.SettingsProviderAttribute> applied to the wrapper class or its individual properties.</span></span> <span data-ttu-id="64478-171">Wenn ein Einstellungsanbieter nicht explizit angegeben <xref:System.Configuration.LocalFileSettingsProvider>ist, wird der Standardanbieter , verwendet.</span><span class="sxs-lookup"><span data-stu-id="64478-171">If a settings provider is not explicitly specified, the default provider, <xref:System.Configuration.LocalFileSettingsProvider>, is used.</span></span> <span data-ttu-id="64478-172">Daher unterstützt diese Architektur das Erstellen und Verwenden von benutzerdefinierten Einstellungsanbietern.</span><span class="sxs-lookup"><span data-stu-id="64478-172">As a result, this architecture supports creating and using custom settings providers.</span></span>

 <span data-ttu-id="64478-173">Nehmen wir beispielsweise an, dass Sie `SqlSettingsProvider`, entwickeln und verwenden möchten, einen Anbieter, der sämtliche Einstellungsdaten in einer Microsoft SQL Server-Datenbank speichert.</span><span class="sxs-lookup"><span data-stu-id="64478-173">For example, suppose that you want to develop and use `SqlSettingsProvider`, a provider that will store all settings data in a Microsoft SQL Server database.</span></span> <span data-ttu-id="64478-174">Ihre <xref:System.Configuration.SettingsProvider>-derived-Klasse würde diese `Initialize` Informationen in ihrer <xref:System.Collections.Specialized.NameValueCollection?displayProperty=nameWithType>Methode als Parameter vom Typ erhalten.</span><span class="sxs-lookup"><span data-stu-id="64478-174">Your <xref:System.Configuration.SettingsProvider>-derived class would receive this information in its `Initialize` method as a parameter of type <xref:System.Collections.Specialized.NameValueCollection?displayProperty=nameWithType>.</span></span> <span data-ttu-id="64478-175">Anschließend implementieren Sie <xref:System.Configuration.SettingsProvider.GetPropertyValues%2A> die Methode, um Ihre Einstellungen <xref:System.Configuration.SettingsProvider.SetPropertyValues%2A> aus dem Datenspeicher abzurufen und zu speichern.</span><span class="sxs-lookup"><span data-stu-id="64478-175">You would then implement the <xref:System.Configuration.SettingsProvider.GetPropertyValues%2A> method to retrieve your settings from the data store, and <xref:System.Configuration.SettingsProvider.SetPropertyValues%2A> to save them.</span></span> <span data-ttu-id="64478-176">Ihr Anbieter kann <xref:System.Configuration.SettingsPropertyCollection> die <xref:System.Configuration.SettingsProvider.GetPropertyValues%2A> angegebene verwenden, um den Namen, typ und den Bereich der Eigenschaft sowie alle anderen für diese Eigenschaft definierten Einstellungsattribute zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="64478-176">Your provider can use the <xref:System.Configuration.SettingsPropertyCollection> supplied to <xref:System.Configuration.SettingsProvider.GetPropertyValues%2A> to determine the property's name, type, and scope, as well as any other settings attributes defined for that property.</span></span>

 <span data-ttu-id="64478-177">Der Anbieter muss eine Eigenschaft und eine Methode implementieren, deren Implementierungen möglicherweise nicht offensichtlich sind.</span><span class="sxs-lookup"><span data-stu-id="64478-177">Your provider will need to implement one property and one method whose implementations may not be obvious.</span></span> <span data-ttu-id="64478-178">Die <xref:System.Configuration.SettingsProvider.ApplicationName%2A> Eigenschaft ist eine <xref:System.Configuration.SettingsProvider>abstrakte Eigenschaft von ; Sie sollten es programmieren, um Folgendes zurückzugeben:</span><span class="sxs-lookup"><span data-stu-id="64478-178">The <xref:System.Configuration.SettingsProvider.ApplicationName%2A> property is an abstract property of <xref:System.Configuration.SettingsProvider>; you should program it to return the following:</span></span>

 [!code-csharp[ApplicationSettings.Architecture#2](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Architecture/CS/DummyClass.cs#2)]
 [!code-vb[ApplicationSettings.Architecture#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Architecture/VB/DummyProviderClass.vb#2)]

 <span data-ttu-id="64478-179">Die abgeleitete Klasse muss außerdem eine `Initialize`-Methode implementieren, die keine Argumente akzeptiert und keinen Wert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="64478-179">Your derived class must also implement an `Initialize` method that takes no arguments and returns no value.</span></span> <span data-ttu-id="64478-180">Diese Methode ist <xref:System.Configuration.SettingsProvider>nicht durch definiert.</span><span class="sxs-lookup"><span data-stu-id="64478-180">This method is not defined by <xref:System.Configuration.SettingsProvider>.</span></span>

 <span data-ttu-id="64478-181">Schließlich implementieren <xref:System.Configuration.IApplicationSettingsProvider> Sie auf Ihrem Provider, um Unterstützung für Aktualisierungseinstellungen bereitzustellen, Einstellungen auf ihre Standardeinstellungen zurücksetzen und Einstellungen von einer Anwendungsversion auf eine andere aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="64478-181">Finally, you implement <xref:System.Configuration.IApplicationSettingsProvider> on your provider to provide support for refreshing settings, reverting settings to their defaults, and upgrading settings from one application version to another.</span></span>

 <span data-ttu-id="64478-182">Nachdem Sie Ihren Anbieter implementiert und kompiliert haben, müssen Sie Ihre Einstellungenklasse anweisen, diesen Anbieter anstelle des standardmäßigen Anbieters zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="64478-182">Once you have implemented and compiled your provider, you need to instruct your settings class to use this provider instead of the default.</span></span> <span data-ttu-id="64478-183">Sie erreichen dies durch die <xref:System.Configuration.SettingsProviderAttribute>.</span><span class="sxs-lookup"><span data-stu-id="64478-183">You accomplish this through the <xref:System.Configuration.SettingsProviderAttribute>.</span></span> <span data-ttu-id="64478-184">Wenn er auf eine gesamte Einstellungsklasse angewendet wird, wird der Anbieter für jede Einstellung verwendet, die von der Klasse definiert wird. Wenn die Architektur für Anwendungseinstellungen auf einzelne Einstellungen angewendet <xref:System.Configuration.LocalFileSettingsProvider> wird, wird dieser Anbieter nur für diese Einstellungen verwendet, und für den Rest.</span><span class="sxs-lookup"><span data-stu-id="64478-184">If applied to an entire settings class, the provider is used for each setting that the class defines; if applied to individual settings, Application Settings architecture uses that provider for those settings only, and uses <xref:System.Configuration.LocalFileSettingsProvider> for the rest.</span></span> <span data-ttu-id="64478-185">Das folgende Codebeispiel veranschaulicht, wie die Einstellungenklasse angewiesen wird, den benutzerdefinierten Anbieter zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="64478-185">The following code example shows how to instruct the settings class to use your custom provider.</span></span>

 [!code-csharp[ApplicationSettings.Architecture#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Architecture/CS/DummyClass.cs#1)]
 [!code-vb[ApplicationSettings.Architecture#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Architecture/VB/DummyProviderClass.vb#1)]

 <span data-ttu-id="64478-186">Ein Anbieter kann von mehreren Threads gleichzeitig aufgerufen werden, schreibt jedoch immer in den gleichen Speicherort. Aus diesem Grund instanziiert die Architektur für Anwendungseinstellungen immer nur eine einzelne Instanz der Anbieterklasse.</span><span class="sxs-lookup"><span data-stu-id="64478-186">A provider may be called from multiple threads simultaneously, but it will always write to the same storage location; therefore, the Application Settings architecture will only ever instantiate a single instance of your provider class.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="64478-187">Sie sollten sicherstellen, dass der Anbieter threadsicher ist und jeweils nur einem Thread gestattet, in die Konfigurationsdateien zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="64478-187">You should ensure that your provider is thread-safe, and only allows one thread at a time to write to the configuration files.</span></span>

 <span data-ttu-id="64478-188">Ihr Anbieter muss nicht alle <xref:System.Configuration?displayProperty=nameWithType> im Namespace definierten Einstellungsattribute unterstützen, obwohl <xref:System.Configuration.ApplicationScopedSettingAttribute> er <xref:System.Configuration.UserScopedSettingAttribute>mindestens unterstützt <xref:System.Configuration.DefaultSettingValueAttribute>und unterstützt werden muss.</span><span class="sxs-lookup"><span data-stu-id="64478-188">Your provider does not need to support all of the settings attributes defined in the <xref:System.Configuration?displayProperty=nameWithType> namespace, though it must at a minimum support <xref:System.Configuration.ApplicationScopedSettingAttribute> and <xref:System.Configuration.UserScopedSettingAttribute>, and should also support <xref:System.Configuration.DefaultSettingValueAttribute>.</span></span> <span data-ttu-id="64478-189">Für die Attribute, die nicht unterstützt werden, sollte der Anbieter ohne Benachrichtigung fehlschlagen und keine Ausnahme auslösen.</span><span class="sxs-lookup"><span data-stu-id="64478-189">For those attributes that it does not support, your provider should just fail without notification; it should not throw an exception.</span></span> <span data-ttu-id="64478-190">Wenn die Einstellungsklasse jedoch eine ungültige Kombination von <xref:System.Configuration.ApplicationScopedSettingAttribute> <xref:System.Configuration.UserScopedSettingAttribute> Attributen verwendet, z. B. anwenden und auf dieselbe Einstellung, sollte Ihr Anbieter eine Ausnahme auslösen und den Betrieb beenden.</span><span class="sxs-lookup"><span data-stu-id="64478-190">If the settings class uses an invalid combination of attributes, however — such as applying <xref:System.Configuration.ApplicationScopedSettingAttribute> and <xref:System.Configuration.UserScopedSettingAttribute> to the same setting — your provider should throw an exception and cease operation.</span></span>

## <a name="see-also"></a><span data-ttu-id="64478-191">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="64478-191">See also</span></span>

- <xref:System.Configuration.ApplicationSettingsBase>
- <xref:System.Configuration.SettingsProvider>
- <xref:System.Configuration.LocalFileSettingsProvider>
- [<span data-ttu-id="64478-192">Übersicht über Anwendungseinstellungen</span><span class="sxs-lookup"><span data-stu-id="64478-192">Application Settings Overview</span></span>](application-settings-overview.md)
- [<span data-ttu-id="64478-193">Application Settings for Custom Controls</span><span class="sxs-lookup"><span data-stu-id="64478-193">Application Settings for Custom Controls</span></span>](application-settings-for-custom-controls.md)
- [<span data-ttu-id="64478-194">ClickOnce und Anwendungseinstellungen</span><span class="sxs-lookup"><span data-stu-id="64478-194">ClickOnce and Application Settings</span></span>](/visualstudio/deployment/clickonce-and-application-settings)
- [<span data-ttu-id="64478-195">Schema für Anwendungseinstellungen</span><span class="sxs-lookup"><span data-stu-id="64478-195">Application Settings Schema</span></span>](../../configure-apps/file-schema/application-settings-schema.md)
