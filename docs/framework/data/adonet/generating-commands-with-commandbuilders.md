---
title: Generieren von Befehlen mit CommandBuilder-Objekten
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 6e3fb8b5-373b-4f9e-ab03-a22693df8e91
ms.openlocfilehash: 42463249a6636e625729f90fc31fa7589ef7ef74
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/18/2019
ms.locfileid: "59120028"
---
# <a name="generating-commands-with-commandbuilders"></a><span data-ttu-id="0b99b-102">Generieren von Befehlen mit CommandBuilder-Objekten</span><span class="sxs-lookup"><span data-stu-id="0b99b-102">Generating Commands with CommandBuilders</span></span>
<span data-ttu-id="0b99b-103">Wenn die `SelectCommand`-Eigenschaft dynamisch zur Laufzeit angegeben wird, z. B. mit einem Abfragetool, in dem der Benutzer einen Textbefehl eingibt, sind Sie zur Entwurfszeit u. U. nicht in der Lage, den entsprechenden `InsertCommand`, `UpdateCommand` oder `DeleteCommand` anzugeben.</span><span class="sxs-lookup"><span data-stu-id="0b99b-103">When the `SelectCommand` property is dynamically specified at run time, such as through a query tool that takes a textual command from the user, you may not be able to specify the appropriate `InsertCommand`, `UpdateCommand`, or `DeleteCommand` at design time.</span></span> <span data-ttu-id="0b99b-104">Wenn Ihre <xref:System.Data.DataTable> einer einzelnen Datenbanktabelle zugeordnet ist oder aus einer solchen generiert wurde, können Sie mithilfe des <xref:System.Data.Common.DbCommandBuilder>-Objekts automatisch den `DeleteCommand`, den `InsertCommand` und den `UpdateCommand` des <xref:System.Data.Common.DbDataAdapter> generieren.</span><span class="sxs-lookup"><span data-stu-id="0b99b-104">If your <xref:System.Data.DataTable> maps to or is generated from a single database table, you can take advantage of the <xref:System.Data.Common.DbCommandBuilder> object to automatically generate the `DeleteCommand`, `InsertCommand`, and `UpdateCommand` of the <xref:System.Data.Common.DbDataAdapter>.</span></span>  
  
 <span data-ttu-id="0b99b-105">Damit die automatische Befehlsgenerierung funktioniert, muss mindestens die `SelectCommand`-Eigenschaft festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="0b99b-105">As a minimum requirement, you must set the `SelectCommand` property in order for automatic command generation to work.</span></span> <span data-ttu-id="0b99b-106">Das durch die `SelectCommand`-Eigenschaft abgerufene Tabellenschema bestimmt die Syntax der automatisch generierten INSERT-, UPDATE- und DELETE-Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="0b99b-106">The table schema retrieved by the `SelectCommand` property determines the syntax of the automatically generated INSERT, UPDATE, and DELETE statements.</span></span>  
  
 <span data-ttu-id="0b99b-107">Der <xref:System.Data.Common.DbCommandBuilder> muss `SelectCommand` ausführen, damit die zum Konstruieren der SQL-Befehle INSERT, UPDATE und DELETE erforderlichen Metadaten zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="0b99b-107">The <xref:System.Data.Common.DbCommandBuilder> must execute the `SelectCommand` in order to return the metadata necessary to construct the INSERT, UPDATE, and DELETE SQL commands.</span></span> <span data-ttu-id="0b99b-108">Daher ist ein erneutes Lesen der Datenquelle erforderlich, was die Leistung herabsetzen kann.</span><span class="sxs-lookup"><span data-stu-id="0b99b-108">As a result, an extra trip to the data source is necessary, and this can hinder performance.</span></span> <span data-ttu-id="0b99b-109">Eine optimale Leistung lässt sich erzielen, indem Sie die Befehle direkt angeben, anstatt den <xref:System.Data.Common.DbCommandBuilder> zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="0b99b-109">To achieve optimal performance, specify your commands explicitly rather than using the <xref:System.Data.Common.DbCommandBuilder>.</span></span>  
  
 <span data-ttu-id="0b99b-110">Der `SelectCommand` muss außerdem mindestens einen Primärschlüssel oder eine eindeutige Spalte zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="0b99b-110">The `SelectCommand` must also return at least one primary key or unique column.</span></span> <span data-ttu-id="0b99b-111">Wenn weder das eine noch das andere vorhanden ist, wird eine `InvalidOperation`-Ausnahme ausgelöst, und die Befehle werden nicht generiert.</span><span class="sxs-lookup"><span data-stu-id="0b99b-111">If none are present, an `InvalidOperation` exception is generated, and the commands are not generated.</span></span>  
  
 <span data-ttu-id="0b99b-112">Bei einer Zuordnung zu einem `DataAdapter` generiert der <xref:System.Data.Common.DbCommandBuilder> automatisch die Eigenschaften `InsertCommand`, `UpdateCommand` und `DeleteCommand` des `DataAdapter`, sofern es sich um NULL-Verweise handelt.</span><span class="sxs-lookup"><span data-stu-id="0b99b-112">When associated with a `DataAdapter`, the <xref:System.Data.Common.DbCommandBuilder> automatically generates the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties of the `DataAdapter` if they are null references.</span></span> <span data-ttu-id="0b99b-113">Wenn für eine Eigenschaft bereits ein `Command` vorhanden ist, wird der vorhandene `Command` verwendet.</span><span class="sxs-lookup"><span data-stu-id="0b99b-113">If a `Command` already exists for a property, the existing `Command` is used.</span></span>  
  
 <span data-ttu-id="0b99b-114">Datenbankansichten, die durch das Verknüpfen von zwei oder mehr Datenbanken erstellt wurden, werden nicht als eine einzelne Datenbanktabelle betrachtet.</span><span class="sxs-lookup"><span data-stu-id="0b99b-114">Database views that are created by joining two or more tables together are not considered a single database table.</span></span> <span data-ttu-id="0b99b-115">In dieser Instanz können Sie den <xref:System.Data.Common.DbCommandBuilder> nicht zum automatischen Generieren von Befehlen verwenden; Sie müssen die Befehle explizit angeben.</span><span class="sxs-lookup"><span data-stu-id="0b99b-115">In this instance you cannot use the <xref:System.Data.Common.DbCommandBuilder> to automatically generate commands; you must specify your commands explicitly.</span></span> <span data-ttu-id="0b99b-116">Informationen zum expliziten Festlegen von Befehlen zum Aktualisieren einer `DataSet` zurück an die Datenquelle finden Sie unter [Aktualisieren von Datenquellen mit "DataAdapters"](../../../../docs/framework/data/adonet/updating-data-sources-with-dataadapters.md).</span><span class="sxs-lookup"><span data-stu-id="0b99b-116">For information about explicitly setting commands to resolve updates to a `DataSet` back to the data source, see [Updating Data Sources with DataAdapters](../../../../docs/framework/data/adonet/updating-data-sources-with-dataadapters.md).</span></span>  
  
 <span data-ttu-id="0b99b-117">Unter Umständen möchten Sie der aktualisierten Zeile eines `DataSet` erneut Ausgabeparameter zuordnen.</span><span class="sxs-lookup"><span data-stu-id="0b99b-117">You might want to map output parameters back to the updated row of a `DataSet`.</span></span> <span data-ttu-id="0b99b-118">Eine allgemeine Aufgabe wäre das Abrufen des Werts eines automatisch generierten Identitätsfelds oder Timestamps aus der Datenquelle.</span><span class="sxs-lookup"><span data-stu-id="0b99b-118">One common task would be retrieving the value of an automatically generated identity field or time stamp from the data source.</span></span> <span data-ttu-id="0b99b-119">Standardmäßig werden den Spalten in einer aktualisierten Zeile vom <xref:System.Data.Common.DbCommandBuilder> keine Ausgabeparameter zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="0b99b-119">The <xref:System.Data.Common.DbCommandBuilder> will not map output parameters to columns in an updated row by default.</span></span> <span data-ttu-id="0b99b-120">In diesem Fall müssen Sie den Befehl explizit angeben.</span><span class="sxs-lookup"><span data-stu-id="0b99b-120">In this instance you must specify your command explicitly.</span></span> <span data-ttu-id="0b99b-121">Ein Beispiel für die Zuordnung eines automatisch generierten Identitätsfelds zu einer Spalte einer eingefügten Zeile, finden Sie unter [Abrufen von Identity- oder Autonumber-Werten](../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span><span class="sxs-lookup"><span data-stu-id="0b99b-121">For an example of mapping an automatically generated identity field back to a column of an inserted row, see [Retrieving Identity or Autonumber Values](../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span></span>  
  
## <a name="rules-for-automatically-generated-commands"></a><span data-ttu-id="0b99b-122">Regeln für automatisch generierte Befehle</span><span class="sxs-lookup"><span data-stu-id="0b99b-122">Rules for Automatically Generated Commands</span></span>  
 <span data-ttu-id="0b99b-123">Die folgende Tabelle enthält die Regeln für das Generieren von automatisch generierten Befehlen.</span><span class="sxs-lookup"><span data-stu-id="0b99b-123">The following table shows the rules for how automatically generated commands are generated.</span></span>  
  
|<span data-ttu-id="0b99b-124">Befehl</span><span class="sxs-lookup"><span data-stu-id="0b99b-124">Command</span></span>|<span data-ttu-id="0b99b-125">Regel</span><span class="sxs-lookup"><span data-stu-id="0b99b-125">Rule</span></span>|  
|-------------|----------|  
|`InsertCommand`|<span data-ttu-id="0b99b-126">Fügt in der Datenquelle für alle Zeilen in der Tabelle, die den <xref:System.Data.DataRow.RowState%2A><xref:System.Data.DataRowState.Added> aufweisen, eine Zeile ein.</span><span class="sxs-lookup"><span data-stu-id="0b99b-126">Inserts a row at the data source for all rows in the table with a <xref:System.Data.DataRow.RowState%2A> of <xref:System.Data.DataRowState.Added>.</span></span> <span data-ttu-id="0b99b-127">Fügt Werte für alle Spalten ein, die aktualisiert werden können (jedoch nicht für Spalten wie Identitäten, Ausdrücke oder Timestamps).</span><span class="sxs-lookup"><span data-stu-id="0b99b-127">Inserts values for all columns that are updateable (but not columns such as identities, expressions, or timestamps).</span></span>|  
|`UpdateCommand`|<span data-ttu-id="0b99b-128">Aktualisiert Zeilen in der Datenquelle für alle Zeilen in der Tabelle, die den `RowState`-Wert <xref:System.Data.DataRowState.Modified> aufweisen.</span><span class="sxs-lookup"><span data-stu-id="0b99b-128">Updates rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="0b99b-129">Aktualisiert die Werte aller Spalten mit Ausnahme von Spalten, die nicht aktualisiert werden können, z. B. Identitäten oder Ausdrücke.</span><span class="sxs-lookup"><span data-stu-id="0b99b-129">Updates the values of all columns except for columns that are not updateable, such as identities or expressions.</span></span> <span data-ttu-id="0b99b-130">Aktualisiert alle Zeilen, deren Spaltenwerte in der Datenquelle den Primärschlüssel-Spaltenwerten der Zeile entsprechen und bei denen die übrigen Spalten in der Datenquelle den ursprünglichen Werten der Zeile entsprechen.</span><span class="sxs-lookup"><span data-stu-id="0b99b-130">Updates all rows where the column values at the data source match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="0b99b-131">Weitere Informationen finden Sie unter "Vollständiges Parallelitätsmodell für Updates und Löschvorgänge" weiter unten in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="0b99b-131">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
|`DeleteCommand`|<span data-ttu-id="0b99b-132">Löscht Zeilen in der Datenquelle für alle Zeilen in der Tabelle, die den `RowState`-Wert <xref:System.Data.DataRowState.Deleted> aufweisen.</span><span class="sxs-lookup"><span data-stu-id="0b99b-132">Deletes rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Deleted>.</span></span> <span data-ttu-id="0b99b-133">Löscht alle Zeilen, deren Spaltenwerte den Primärschlüssel-Spaltenwerten der Zeile entsprechen und bei denen die übrigen Spalten in der Datenquelle den ursprünglichen Werten der Zeile entsprechen.</span><span class="sxs-lookup"><span data-stu-id="0b99b-133">Deletes all rows where the column values match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="0b99b-134">Weitere Informationen finden Sie unter "Vollständiges Parallelitätsmodell für Updates und Löschvorgänge" weiter unten in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="0b99b-134">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
  
## <a name="optimistic-concurrency-model-for-updates-and-deletes"></a><span data-ttu-id="0b99b-135">Vollständiges Parallelitätsmodell für Updates und Löschvorgänge</span><span class="sxs-lookup"><span data-stu-id="0b99b-135">Optimistic Concurrency Model for Updates and Deletes</span></span>  
 <span data-ttu-id="0b99b-136">Die Logik für das Generieren von Befehlen für Update- und DELETE-Anweisungen automatisch basiert auf *optimistische Parallelität*–, also die Datensätze werden nicht für die Bearbeitung gesperrt und kann von anderen Benutzern oder Prozessen jederzeit geändert werden.</span><span class="sxs-lookup"><span data-stu-id="0b99b-136">The logic for generating commands automatically for UPDATE and DELETE statements is based on *optimistic concurrency*--that is, records are not locked for editing and can be modified by other users or processes at any time.</span></span> <span data-ttu-id="0b99b-137">Da ein Datensatz nach der Rückgabe aus der SELECT-Anweisung und vor der Ausführung der UPDATE- oder DELETE-Anweisung ggf. geändert wurde, enthält die automatisch generierte UPDATE- oder DELETE-Anweisung eine WHERE-Klausel, die angibt, dass eine Zeile nur dann aktualisiert wird, wenn sie alle ursprünglichen Werte enthält und nicht aus der Datenquelle gelöscht wurde.</span><span class="sxs-lookup"><span data-stu-id="0b99b-137">Because a record could have been modified after it was returned from the SELECT statement, but before the UPDATE or DELETE statement is issued, the automatically generated UPDATE or DELETE statement contains a WHERE clause, specifying that a row is only updated if it contains all original values and has not been deleted from the data source.</span></span> <span data-ttu-id="0b99b-138">Hierdurch wird vermieden, dass neue Daten überschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="0b99b-138">This is done to avoid overwriting new data.</span></span> <span data-ttu-id="0b99b-139">In Fällen, in denen ein automatisch generierter Updatebefehl versucht, eine Zeile zu aktualisieren, die gelöscht wurde oder nicht die ursprünglichen Werte im <xref:System.Data.DataSet> enthält, hat der Befehl keine Auswirkungen auf Datensätze, und es wird eine <xref:System.Data.DBConcurrencyException> ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="0b99b-139">Where an automatically generated update attempts to update a row that has been deleted or that does not contain the original values found in the <xref:System.Data.DataSet>, the command does not affect any records, and a <xref:System.Data.DBConcurrencyException> is thrown.</span></span>  
  
 <span data-ttu-id="0b99b-140">Wenn UPDATE oder DELETE unabhängig von den ursprünglichen Werten ausgeführt werden sollen, muss der `UpdateCommand` für den `DataAdapter` explizit festgelegt und die automatische Befehlsgenerierung damit außer Kraft gesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="0b99b-140">If you want the UPDATE or DELETE to complete regardless of original values, you must explicitly set the `UpdateCommand` for the `DataAdapter` and not rely on automatic command generation.</span></span>  
  
## <a name="limitations-of-automatic-command-generation-logic"></a><span data-ttu-id="0b99b-141">Einschränkungen der Logik für die automatische Generierung von Befehlen</span><span class="sxs-lookup"><span data-stu-id="0b99b-141">Limitations of Automatic Command Generation Logic</span></span>  
 <span data-ttu-id="0b99b-142">Folgende Einschränkungen gelten für die automatische Generierung von Befehlen.</span><span class="sxs-lookup"><span data-stu-id="0b99b-142">The following limitations apply to automatic command generation.</span></span>  
  
### <a name="unrelated-tables-only"></a><span data-ttu-id="0b99b-143">Nur nicht verknüpfte Tabellen</span><span class="sxs-lookup"><span data-stu-id="0b99b-143">Unrelated Tables Only</span></span>  
 <span data-ttu-id="0b99b-144">Die Logik für die automatische Generierung von Befehlen generiert INSERT-, UPDATE- oder DELETE-Befehle für eigenständige Tabellen, wobei Verknüpfungen mit anderen Tabellen in der Datenquelle unberücksichtigt bleiben.</span><span class="sxs-lookup"><span data-stu-id="0b99b-144">The automatic command generation logic generates INSERT, UPDATE, or DELETE statements for stand-alone tables without taking into account any relationships to other tables at the data source.</span></span> <span data-ttu-id="0b99b-145">Daher kann ein Fehler auftreten, wenn Sie `Update` aufrufen, um Änderungen an einer Spalte zu übermitteln, die in der Datenbank Fremdschlüsseleinschränkungen unterworfen ist.</span><span class="sxs-lookup"><span data-stu-id="0b99b-145">As a result, you may encounter a failure when calling `Update` to submit changes for a column that participates in a foreign key constraint in the database.</span></span> <span data-ttu-id="0b99b-146">Sie können diese Ausnahme vermeiden, indem Sie zum Aktualisieren von Spalten, die einer Einschränkung eines Fremdschlüssels unterworfen sind, nicht den <xref:System.Data.Common.DbCommandBuilder> verwenden, sondern die Anweisungen zur Durchführung der Operation explizit angeben.</span><span class="sxs-lookup"><span data-stu-id="0b99b-146">To avoid this exception, do not use the <xref:System.Data.Common.DbCommandBuilder> for updating columns involved in a foreign key constraint; instead, explicitly specify the statements used to perform the operation.</span></span>  
  
### <a name="table-and-column-names"></a><span data-ttu-id="0b99b-147">Tabellennamen und Spaltennamen</span><span class="sxs-lookup"><span data-stu-id="0b99b-147">Table and Column Names</span></span>  
 <span data-ttu-id="0b99b-148">Die Logik für die automatische Befehlsgenerierung kann fehlschlagen, wenn Spalten- oder Tabellennamen Sonderzeichen wie Leerzeichen, Punkte, Anführungszeichen oder andere nicht alphanumerische Zeichen enthalten, selbst wenn diese durch Klammern getrennt sind.</span><span class="sxs-lookup"><span data-stu-id="0b99b-148">Automatic command generation logic may fail if column names or table names contain any special characters, such as spaces, periods, quotation marks, or other nonalphanumeric characters, even if delimited by brackets.</span></span> <span data-ttu-id="0b99b-149">Leerzeichen können je nach Anbieter von der Generierungslogik durch Festlegen des QuotePrefix-Parameters und QuoteSuffix-Parameters möglicherweise verarbeitet werden, Sonderzeichen können jedoch nicht mit Escapezeichen versehen werden.</span><span class="sxs-lookup"><span data-stu-id="0b99b-149">Depending on the provider, setting the QuotePrefix and QuoteSuffix parameters may allow the generation logic to process spaces, but it cannot escape special characters.</span></span> <span data-ttu-id="0b99b-150">Vollqualifizierte Tabellennamen in Form von *catalog.schema.table* werden unterstützt.</span><span class="sxs-lookup"><span data-stu-id="0b99b-150">Fully qualified table names in the form of *catalog.schema.table* are supported.</span></span>  
  
## <a name="using-the-commandbuilder-to-automatically-generate-an-sql-statement"></a><span data-ttu-id="0b99b-151">Verwenden des CommandBuilder-Objekts zum automatischen Generieren einer SQL-Anweisung</span><span class="sxs-lookup"><span data-stu-id="0b99b-151">Using the CommandBuilder to Automatically Generate an SQL Statement</span></span>  
 <span data-ttu-id="0b99b-152">Legen Sie zum automatischen Generieren von SQL-Anweisungen für einen `DataAdapter` zuerst die `SelectCommand`-Eigenschaft des `DataAdapter` fest. Erstellen Sie dann ein `CommandBuilder`-Objekt, und geben Sie als Argument den `DataAdapter` an, für den der `CommandBuilder` automatisch SQL-Anweisungen generieren soll.</span><span class="sxs-lookup"><span data-stu-id="0b99b-152">To automatically generate SQL statements for a `DataAdapter`, first set the `SelectCommand` property of the `DataAdapter`, then create a `CommandBuilder` object, and specify as an argument the `DataAdapter` for which the `CommandBuilder` will automatically generate SQL statements.</span></span>  
  
```vb  
' Assumes that connection is a valid SqlConnection object   
' inside of a Using block.  
Dim adapter As SqlDataAdapter = New SqlDataAdapter( _  
  "SELECT * FROM dbo.Customers", connection)  
Dim builder As SqlCommandBuilder = New SqlCommandBuilder(adapter)  
builder.QuotePrefix = "["  
builder.QuoteSuffix = "]"  
```  
  
```csharp  
// Assumes that connection is a valid SqlConnection object  
// inside of a using block.  
SqlDataAdapter adapter = new SqlDataAdapter(  
  "SELECT * FROM dbo.Customers", connection);  
SqlCommandBuilder builder = new SqlCommandBuilder(adapter);  
builder.QuotePrefix = "[";  
builder.QuoteSuffix = "]";  
```  
  
## <a name="modifying-the-selectcommand"></a><span data-ttu-id="0b99b-153">Ändern von SelectCommand</span><span class="sxs-lookup"><span data-stu-id="0b99b-153">Modifying the SelectCommand</span></span>  
 <span data-ttu-id="0b99b-154">Wenn Sie den `CommandText` von `SelectCommand` ändern, nachdem die Befehle INSERT, UPDATE oder DELETE automatisch generiert wurden, kann eine Ausnahme auftreten.</span><span class="sxs-lookup"><span data-stu-id="0b99b-154">If you modify the `CommandText` of the `SelectCommand` after the INSERT, UPDATE, or DELETE commands have been automatically generated, an exception may occur.</span></span> <span data-ttu-id="0b99b-155">Wenn der geänderte `SelectCommand.CommandText` Schemainformationen enthält, die nicht mit dem `SelectCommand.CommandText` zum Zeitpunkt der automatischen Generierung der Befehle INSERT, UPDATE oder DELETE konsistent sind, wird bei späteren Aufrufen der `DataAdapter.Update`-Methode möglicherweise versucht, auf Spalten zuzugreifen, die nicht mehr in der aktuellen Tabelle vorhanden sind, auf die `SelectCommand` verweist. In diesem Fall wird eine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="0b99b-155">If the modified `SelectCommand.CommandText` contains schema information that is inconsistent with the `SelectCommand.CommandText` used when the insert, update, or delete commands were automatically generated, future calls to the `DataAdapter.Update` method may attempt to access columns that no longer exist in the current table referenced by the `SelectCommand`, and an exception will be thrown.</span></span>  
  
 <span data-ttu-id="0b99b-156">Sie können die vom `CommandBuilder` zum automatischen Generieren von Befehlen verwendeten Schemainformationen aktualisieren, indem Sie die `RefreshSchema`-Methode des `CommandBuilder` aufrufen.</span><span class="sxs-lookup"><span data-stu-id="0b99b-156">You can refresh the schema information used by the `CommandBuilder` to automatically generate commands by calling the `RefreshSchema` method of the `CommandBuilder`.</span></span>  
  
 <span data-ttu-id="0b99b-157">Wenn Sie wissen möchten, welcher Befehl automatisch generiert wurde, können Sie mit den Methoden `GetInsertCommand`, `GetUpdateCommand` und `GetDeleteCommand` des `CommandBuilder`-Objekts Verweise auf die Befehle abrufen und die `CommandText`-Eigenschaft des zugeordneten Befehls überprüfen.</span><span class="sxs-lookup"><span data-stu-id="0b99b-157">If you want to know what command was automatically generated, you can obtain a reference to the automatically generated commands by using the `GetInsertCommand`, `GetUpdateCommand`, and `GetDeleteCommand` methods of the `CommandBuilder` object and checking the `CommandText` property of the associated command.</span></span>  
  
 <span data-ttu-id="0b99b-158">Im folgenden Codebeispiel wird der automatisch generierte UPDATE-Befehl in die Konsole geschrieben.</span><span class="sxs-lookup"><span data-stu-id="0b99b-158">The following code example writes to the console the update command that was automatically generated.</span></span>  
  
```vb
Console.WriteLine(builder.GetUpdateCommand().CommandText)  
```

```csharp
Console.WriteLine(builder.GetUpdateCommand().CommandText);
```
  
 <span data-ttu-id="0b99b-159">Das folgende Beispiel erstellt die `Customers`-Tabelle im `custDS`-Dataset neu.</span><span class="sxs-lookup"><span data-stu-id="0b99b-159">The following example recreates the `Customers` table in the `custDS` dataset.</span></span> <span data-ttu-id="0b99b-160">Die **RefreshSchema** Methode wird aufgerufen, um die automatisch generierten Befehle mit den neuen Spalteninformationen zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="0b99b-160">The **RefreshSchema** method is called to refresh the automatically generated commands with this new column information.</span></span>  
  
```vb  
' Assumes an open SqlConnection and SqlDataAdapter inside of a Using block.  
adapter.SelectCommand.CommandText = _  
  "SELECT CustomerID, ContactName FROM dbo.Customers"  
builder.RefreshSchema()  
  
custDS.Tables.Remove(custDS.Tables("Customers"))  
adapter.Fill(custDS, "Customers")  
```  
  
```csharp  
// Assumes an open SqlConnection and SqlDataAdapter inside of a using block.  
adapter.SelectCommand.CommandText =   
  "SELECT CustomerID, ContactName FROM dbo.Customers";  
builder.RefreshSchema();  
  
custDS.Tables.Remove(custDS.Tables["Customers"]);  
adapter.Fill(custDS, "Customers");  
```  
  
## <a name="see-also"></a><span data-ttu-id="0b99b-161">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="0b99b-161">See also</span></span>

- [<span data-ttu-id="0b99b-162">Befehle und Parameter</span><span class="sxs-lookup"><span data-stu-id="0b99b-162">Commands and Parameters</span></span>](../../../../docs/framework/data/adonet/commands-and-parameters.md)
- [<span data-ttu-id="0b99b-163">Ausführen eines Befehls</span><span class="sxs-lookup"><span data-stu-id="0b99b-163">Executing a Command</span></span>](../../../../docs/framework/data/adonet/executing-a-command.md)
- [<span data-ttu-id="0b99b-164">DbConnection, DbCommand und DbException</span><span class="sxs-lookup"><span data-stu-id="0b99b-164">DbConnection, DbCommand and DbException</span></span>](../../../../docs/framework/data/adonet/dbconnection-dbcommand-and-dbexception.md)
- [<span data-ttu-id="0b99b-165">ADO.NET Managed Provider und DataSet Developer Center</span><span class="sxs-lookup"><span data-stu-id="0b99b-165">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)
