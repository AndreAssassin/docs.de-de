---
title: SQL Server Express-Benutzerinstanzen
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 00c12376-cb26-4317-86ad-e6e9c089be57
ms.openlocfilehash: fabd9b94b8c0a3f0e0db220e84d6c2eca3537c50
ms.sourcegitcommit: 5ae5a1a9520b8b8b6164ad728d396717f30edafc
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/11/2019
ms.locfileid: "70894420"
---
# <a name="sql-server-express-user-instances"></a><span data-ttu-id="4cc30-102">SQL Server Express-Benutzerinstanzen</span><span class="sxs-lookup"><span data-stu-id="4cc30-102">SQL Server Express User Instances</span></span>
<span data-ttu-id="4cc30-103">Microsoft SQL Server Express Edition (SQL Server Express) unterstützt die Benutzerinstanzfunktion, die die Verwendung des .NET Framework-Datenanbieters für SQL Server (`SqlClient`) voraussetzt.</span><span class="sxs-lookup"><span data-stu-id="4cc30-103">Microsoft SQL Server Express Edition (SQL Server Express) supports the user instance feature, which is only available when using the .NET Framework Data Provider for SQL Server (`SqlClient`).</span></span> <span data-ttu-id="4cc30-104">Eine Benutzerinstanz ist eine separate Instanz der SQL Server Express-Datenbank-Engine, die von einer übergeordneten Instanz generiert wird.</span><span class="sxs-lookup"><span data-stu-id="4cc30-104">A user instance is a separate instance of the SQL Server Express Database Engine that is generated by a parent instance.</span></span> <span data-ttu-id="4cc30-105">Mit Benutzerinstanzen können Benutzer, die auf ihrem lokalen Computer nicht mit Administratorrechten arbeiten, eine Verbindung zu SQL Server Express-Datenbanken herstellen.</span><span class="sxs-lookup"><span data-stu-id="4cc30-105">User instances allow users who are not administrators on their local computers to attach and connect to SQL Server Express databases.</span></span> <span data-ttu-id="4cc30-106">Jede Instanz wird im Sicherheitskontext des jeweiligen Benutzers ausgeführt, wobei für jeden Benutzer genau eine Instanz erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="4cc30-106">Each instance runs under the security context of the individual user, on a one-instance-per-user basis.</span></span>  
  
## <a name="user-instance-capabilities"></a><span data-ttu-id="4cc30-107">Was können Benutzerinstanzen?</span><span class="sxs-lookup"><span data-stu-id="4cc30-107">User Instance Capabilities</span></span>  
 <span data-ttu-id="4cc30-108">Benutzerinstanzen eignen sich für Benutzer, die Windows in einem Konto der untersten Berechtigungsebene (Least-Priviledged User Account, LUA) ausführen, da jeder Benutzer über SQL Server-Systemadministratorberechtigungen (`sysadmin`) für die Instanz verfügt, die auf seinem Computer ausgeführt wird, ohne dass dazu auch Windows mit Administratorrechten ausgeführt werden muss.</span><span class="sxs-lookup"><span data-stu-id="4cc30-108">User instances are useful for users who are running Windows under a least-privilege user account (LUA) because each user has SQL Server system administrator (`sysadmin`) privileges over the instance running on her computer without needing to run as a Windows administrator as well.</span></span> <span data-ttu-id="4cc30-109">Software, die in einer Benutzerinstanz mit eingeschränkten Berechtigungen ausgeführt wird, kann keine systemweiten Änderungen vornehmen, da die SQL Server Express-Instanz beim Benutzer über das Windows-Konto ohne Administratorberechtigung und nicht als Dienst ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4cc30-109">Software executing on a user instance with limited permissions cannot make system-wide changes because the instance of SQL Server Express is running under the non-administrator Windows account of the user, not as a service.</span></span> <span data-ttu-id="4cc30-110">Jede Benutzerinstanz ist von ihrer übergeordneten Instanz und von allen anderen Benutzerinstanzen isoliert, die auf demselben Computer ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="4cc30-110">Each user instance is isolated from its parent instance and from any other user instances running on the same computer.</span></span> <span data-ttu-id="4cc30-111">Auf einer Benutzerinstanz installierte Datenbanken werden nur im Einzelbenutzermodus geöffnet. Es ist ausgeschlossen, dass mehrere Benutzer eine Verbindung mit einer Datenbank herstellen können, die auf einer Benutzerinstanz ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4cc30-111">Databases running on a user instance are opened in single-user mode only, and it is not possible for multiple users to connect to databases running on a user instance.</span></span> <span data-ttu-id="4cc30-112">Replikation und verteilte Abfragen sind für Benutzerinstanzen ebenfalls deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="4cc30-112">Replication and distributed queries are also disabled for user instances.</span></span>  
  
 <span data-ttu-id="4cc30-113">Weitere Informationen dazu finden Sie im Abschnitt zu Benutzerinstanzen in der SQL Server-Onlinedokumentation.</span><span class="sxs-lookup"><span data-stu-id="4cc30-113">For more information, see "User Instances" in SQL Server Books Online.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4cc30-114">Benutzer, die auf ihrem Computer bereits mit Administratorberechtigungen arbeiten, benötigen keine Benutzerinstanzen. Auch in Szenarien mit mehreren Datenbankbenutzern sind Benutzerinstanzen nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="4cc30-114">User instances are not needed for users who are already administrators on their own computers, or for scenarios involving multiple database users.</span></span>  
  
## <a name="enabling-user-instances"></a><span data-ttu-id="4cc30-115">Aktivieren von Benutzerinstanzen</span><span class="sxs-lookup"><span data-stu-id="4cc30-115">Enabling User Instances</span></span>  
 <span data-ttu-id="4cc30-116">Zum Generieren von Benutzerinstanzen muss eine übergeordnete Instanz von SQL Server Express ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="4cc30-116">To generate user instances, a parent instance of SQL Server Express must be running.</span></span> <span data-ttu-id="4cc30-117">Benutzer Instanzen werden standardmäßig aktiviert, wenn SQL Server Express installiert ist. Sie können von einem Systemadministrator, der die gespeicherte System Prozedur **sp_configure** auf der übergeordneten Instanz ausführt, explizit aktiviert oder deaktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="4cc30-117">User instances are enabled by default when SQL Server Express is installed, and they can be explicitly enabled or disabled by a system administrator executing the **sp_configure** system stored procedure on the parent instance.</span></span>  
  
```sql  
-- Enable user instances.  
sp_configure 'user instances enabled','1'
  
-- Disable user instances.  
sp_configure 'user instances enabled','0'  
```  
  
 <span data-ttu-id="4cc30-118">Als Netzwerkprotokoll für Benutzerinstanzen kommen lokale Named Pipes zum Einsatz.</span><span class="sxs-lookup"><span data-stu-id="4cc30-118">The network protocol for user instances must be local Named Pipes.</span></span> <span data-ttu-id="4cc30-119">Benutzerinstanzen können nicht auf einer Remoteinstanz von SQL Server gestartet werden, und SQL Server-Anmeldungen sind ebenfalls nicht zulässig.</span><span class="sxs-lookup"><span data-stu-id="4cc30-119">A user instance cannot be started on a remote instance of SQL Server, and SQL Server logins are not allowed.</span></span>  
  
## <a name="connecting-to-a-user-instance"></a><span data-ttu-id="4cc30-120">Herstellen einer Verbindung mit einer Benutzerinstanz</span><span class="sxs-lookup"><span data-stu-id="4cc30-120">Connecting to a User Instance</span></span>  
 <span data-ttu-id="4cc30-121">Mit `User Instance` den `AttachDBFilename` Schlüsselwörtern und <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> kann eine eine <xref:System.Data.SqlClient.SqlConnection> Verbindung mit einer Benutzer Instanz herstellen.</span><span class="sxs-lookup"><span data-stu-id="4cc30-121">The `User Instance` and `AttachDBFilename`<xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> keywords allow a <xref:System.Data.SqlClient.SqlConnection> to connect to a user instance.</span></span> <span data-ttu-id="4cc30-122">Benutzerinstanzen werden auch von den <xref:System.Data.SqlClient.SqlConnectionStringBuilder>-Eigenschaften `UserInstance` und `AttachDBFilename` unterstützt.</span><span class="sxs-lookup"><span data-stu-id="4cc30-122">User instances are also supported by the <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` and `AttachDBFilename` properties.</span></span>  
  
 <span data-ttu-id="4cc30-123">Beachten Sie bei der unten genannten Beispielverbindungszeichenfolge Folgendes:</span><span class="sxs-lookup"><span data-stu-id="4cc30-123">Note the following about the sample connection string shown below:</span></span>  
  
- <span data-ttu-id="4cc30-124">Das `Data Source`-Schlüsselwort verweist auf die übergeordnete Instanz von SQL Server Express, die die Benutzerinstanz generiert.</span><span class="sxs-lookup"><span data-stu-id="4cc30-124">The `Data Source` keyword refers to the parent instance of SQL Server Express that is generating the user instance.</span></span> <span data-ttu-id="4cc30-125">Die Standardinstanz ist .\sqlexpress.</span><span class="sxs-lookup"><span data-stu-id="4cc30-125">The default instance is .\sqlexpress.</span></span>  
  
- <span data-ttu-id="4cc30-126">Für `Integrated Security` ist `true` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="4cc30-126">`Integrated Security` is set to `true`.</span></span> <span data-ttu-id="4cc30-127">Zur Herstellung einer Verbindung mit einer Benutzerinstanz ist die Windows-Authentifizierung erforderlich. SQL Server-Anmeldungen werden nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="4cc30-127">To connect to a user instance, Windows Authentication is required; SQL Server logins are not supported.</span></span>  
  
- <span data-ttu-id="4cc30-128">Für `User Instance` ist `true` festgelegt, wodurch eine Benutzerinstanz aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="4cc30-128">The `User Instance` is set to `true`, which invokes a user instance.</span></span> <span data-ttu-id="4cc30-129">(Der Standardwert ist `false`.)</span><span class="sxs-lookup"><span data-stu-id="4cc30-129">(The default is `false`.)</span></span>  
  
- <span data-ttu-id="4cc30-130">Das Schlüsselwort für die `AttachDbFileName`-Verbindungszeichenfolge wird verwendet, um die primäre Datenbankdatei (.mdf) anzufügen. Diese muss den vollständigen Pfadnamen enthalten.</span><span class="sxs-lookup"><span data-stu-id="4cc30-130">The `AttachDbFileName` connection string keyword is used to attach the primary database file (.mdf), which must include the full path name.</span></span> <span data-ttu-id="4cc30-131">`AttachDbFileName` entspricht auch den Schlüsseln "extended properties" und "initial file name" in einer <xref:System.Data.SqlClient.SqlConnection>-Verbindungszeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="4cc30-131">`AttachDbFileName` also corresponds to the "extended properties" and "initial file name" keys within a <xref:System.Data.SqlClient.SqlConnection> connection string.</span></span>  
  
- <span data-ttu-id="4cc30-132">Die `|DataDirectory|`-Ersatzzeichenfolge zwischen den vertikalen Strichen (|) verweist auf das Datenverzeichnis der Anwendung, die die Verbindung öffnet, und gibt den relativen Pfad zum Speicherort der MDF- und LDF-Datenbank- und Protokolldateien an.</span><span class="sxs-lookup"><span data-stu-id="4cc30-132">The `|DataDirectory|` substitution string enclosed in the pipe symbols refers to the data directory of the application opening the connection and provides a relative path indicating the location of the .mdf and .ldf database and log files.</span></span> <span data-ttu-id="4cc30-133">Wenn sich diese Dateien woanders befinden, müssen Sie den vollständigen Pfad zu den Dateien angeben.</span><span class="sxs-lookup"><span data-stu-id="4cc30-133">If you want to locate these files elsewhere, you must provide the full path to the files.</span></span>  
  
```text
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;AttachDBFilename=|DataDirectory|\InstanceDB.mdf;  
Initial Catalog=InstanceDB;  
```  
  
> [!NOTE]
> <span data-ttu-id="4cc30-134">Sie können mit der <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A>-Eigenschaft und der <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A>-Eigenschaft eine Verbindungszeichenfolge zur Laufzeit erstellen.</span><span class="sxs-lookup"><span data-stu-id="4cc30-134">You can also use the <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> and <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> properties to build a connection string at run time.</span></span>  
  
### <a name="using-the-124datadirectory124-substitution-string"></a><span data-ttu-id="4cc30-135">Verwenden der &#124;DataDirectory&#124; -Ersetzungs Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="4cc30-135">Using the &#124;DataDirectory&#124; Substitution String</span></span>  
 <span data-ttu-id="4cc30-136">`AttachDbFileName` wurde in ADO.NET 2.0 mit der Einführung der `|DataDirectory|`-Ersatzzeichenfolge (zwischen Pipesymbolen) erweitert.</span><span class="sxs-lookup"><span data-stu-id="4cc30-136">`AttachDbFileName` was extended in ADO.NET 2.0 with the introduction of the `|DataDirectory|` (enclosed in pipe symbols) substitution string.</span></span> <span data-ttu-id="4cc30-137">`DataDirectory` wird in Verbindung mit `AttachDbFileName` verwendet, um einen relativen Pfad zu einer Datendatei anzugeben. Damit wird es Entwicklern ermöglicht, Verbindungszeichenfolgen zu erstellen, die auf einem relativen Pfad zur Datenquelle basieren. Es muss kein vollständiger Pfad angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="4cc30-137">`DataDirectory` is used in conjunction with `AttachDbFileName` to indicate a relative path to a data file, allowing developers to create connection strings that are based on a relative path to the data source instead of being required to specify a full path.</span></span>  
  
 <span data-ttu-id="4cc30-138">Auf welchen physischen Speicherort `DataDirectory` verweist, hängt von der Art der Anwendung ab.</span><span class="sxs-lookup"><span data-stu-id="4cc30-138">The physical location that `DataDirectory` points to depends on the type of application.</span></span> <span data-ttu-id="4cc30-139">In diesem Beispiel befindet sich die anzufügende Datei Northwind.mdf im Ordner \app_data der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="4cc30-139">In this example, the Northwind.mdf file to be attached is located in the application's \app_data folder.</span></span>  
  
```text
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;  
AttachDBFilename=|DataDirectory|\app_data\Northwind.mdf;  
Initial Catalog=Northwind;  
```  
  
 <span data-ttu-id="4cc30-140">Bei Verwendung von `DataDirectory` darf sich der resultierende Dateipfad in der Verzeichnisstruktur nicht über dem Verzeichnis befinden, auf das in der Ersatzzeichenfolge verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="4cc30-140">When `DataDirectory` is used, the resulting file path cannot be higher in the directory structure than the directory pointed to by the substitution string.</span></span> <span data-ttu-id="4cc30-141">Wenn z. B. das vollständige Datenverzeichnis in C:\AppDirectory\app_data`DataDirectory` lautet, funktioniert die oben genannte Beispielverbindungszeichenfolge, weil sie sich unterhalb von C:\AppDirectory befindet.</span><span class="sxs-lookup"><span data-stu-id="4cc30-141">For example, if the fully expanded `DataDirectory` is C:\AppDirectory\app_data, then the sample connection string shown above works because it is below c:\AppDirectory.</span></span> <span data-ttu-id="4cc30-142">Wenn aber versucht wird, das `DataDirectory` als `|DataDirectory|\..\data` anzugeben, wird ein Fehler ausgelöst, weil &lt;legacyBold&gt;\data&lt;/legacyBold&gt; kein Unterverzeichnis von &lt;legacyBold&gt;\AppDirectory&lt;/legacyBold&gt; ist.</span><span class="sxs-lookup"><span data-stu-id="4cc30-142">However, attempting to specify `DataDirectory` as `|DataDirectory|\..\data` will result in an error because \data is not a subdirectory of \AppDirectory.</span></span>  
  
 <span data-ttu-id="4cc30-143">Wenn die Verbindungszeichenfolge eine nicht ordnungsgemäß formatierte Ersatzzeichenfolge enthält, wird eine <xref:System.ArgumentException> ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="4cc30-143">If the connection string has an improperly formatted substitution string, an <xref:System.ArgumentException> will be thrown.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4cc30-144"><xref:System.Data.SqlClient> löst die Ersatzzeichenfolgen in vollständige Pfade des Dateisystems auf dem lokalen Computer auf.</span><span class="sxs-lookup"><span data-stu-id="4cc30-144"><xref:System.Data.SqlClient> resolves the substitution strings into full paths against the local computer file system.</span></span> <span data-ttu-id="4cc30-145">Deshalb werden Remoteserver-, HTTP- und UNC-Pfadnamen nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="4cc30-145">Therefore, remote server, HTTP, and UNC path names are not supported.</span></span> <span data-ttu-id="4cc30-146">Wenn sich der Server nicht auf dem lokalen Computer befindet und die Verbindung geöffnet wird, wird eine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="4cc30-146">An exception is thrown when the connection is opened if the server is not located on the local computer.</span></span>  
  
 <span data-ttu-id="4cc30-147">Wenn die <xref:System.Data.SqlClient.SqlConnection> geöffnet ist, wird sie von der standardmäßigen SQL Server Express-Instanz an eine Instanz umgeleitet, die zur Laufzeit initiiert und unter dem Konto des Aufrufers ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4cc30-147">When the <xref:System.Data.SqlClient.SqlConnection> is opened, it is redirected from the default SQL Server Express instance to a run-time initiated instance running under the caller's account.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4cc30-148">Eventuell ist es notwendig, den Wert für <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> hoch zu setzen, da die Benutzerinstanzen u. U. mehr Zeit zum Laden benötigen als reguläre Instanzen.</span><span class="sxs-lookup"><span data-stu-id="4cc30-148">It may be necessary to increase the <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> value since user instances may take longer to load than regular instances.</span></span>  
  
 <span data-ttu-id="4cc30-149">Das folgende Codefragment öffnet eine neue `SqlConnection`, zeigt die Verbindungszeichenfolge im Konsolenfenster an und schließt dann beim Beenden des `using`-Codeblocks die Verbindung.</span><span class="sxs-lookup"><span data-stu-id="4cc30-149">The following code fragment opens a new `SqlConnection`, displays the connection string in the console window, and then closes the connection when exiting the `using` code block.</span></span>  
  
```vb  
Private Sub OpenSqlConnection()  
    ' Retrieve the connection string.  
    Dim connectionString As String = GetConnectionString()  
  
    Using connection As New SqlConnection(connectionString)  
        connection.Open()  
        Console.WriteLine("ConnectionString: {0}", _  
           connection.ConnectionString)  
    End Using  
End Sub  
```  
  
```csharp  
private static void OpenSqlConnection()  
{  
    // Retrieve the connection string.  
    string connectionString = GetConnectionString();  
  
    using (SqlConnection connection =   
        new SqlConnection(connectionString))  
    {  
        connection.Open();  
        Console.WriteLine("ConnectionString: {0}",   
             connection.ConnectionString);  
    }  
}  
```  
  
> [!NOTE]
> <span data-ttu-id="4cc30-150">Benutzerinstanzen werden von CLR-Code (Common Language Runtime), der innerhalb von SQL Server ausgeführt wird, nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="4cc30-150">User instances are not supported in common language runtime (CLR) code that is running inside of SQL Server.</span></span> <span data-ttu-id="4cc30-151">Es wird eine <xref:System.InvalidOperationException> ausgelöst, wenn `Open` für eine <xref:System.Data.SqlClient.SqlConnection> aufgerufen wird, deren Verbindungszeichenfolge `User Instance=true` enthält.</span><span class="sxs-lookup"><span data-stu-id="4cc30-151">An <xref:System.InvalidOperationException> is thrown if `Open` is called on a <xref:System.Data.SqlClient.SqlConnection> that has `User Instance=true` in the connection string.</span></span>  
  
## <a name="lifetime-of-a-user-instance-connection"></a><span data-ttu-id="4cc30-152">Lebensdauer einer Verbindung mit einer Benutzerinstanz</span><span class="sxs-lookup"><span data-stu-id="4cc30-152">Lifetime of a User Instance Connection</span></span>  
 <span data-ttu-id="4cc30-153">Im Unterschied zu SQL Server-Versionen, die als Dienst ausgeführt werden, müssen SQL Server Express-Instanzen nicht manuell gestartet und beendet werden.</span><span class="sxs-lookup"><span data-stu-id="4cc30-153">Unlike versions of SQL Server that run as a service, SQL Server Express instances do not need to be manually started and stopped.</span></span> <span data-ttu-id="4cc30-154">Die Benutzerinstanz wird gestartet, sobald sich ein Benutzer anmeldet und eine Verbindung mit einer Benutzerinstanz herstellt, sofern sie nicht bereits ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4cc30-154">Each time a user logs in and connects to a user instance, the user instance is started if it is not already running.</span></span> <span data-ttu-id="4cc30-155">Die `AutoClose`-Option ist bei Benutzerinstanzdatenbanken so eingerichtet, dass die Datenbank nach einer bestimmten Zeit der Inaktivität automatisch geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="4cc30-155">User instance databases have the `AutoClose` option set so that the database is automatically shut down after a period of inactivity.</span></span> <span data-ttu-id="4cc30-156">Der Prozess sqlservr.exe läuft nach dem Schließen der letzten Verbindung mit der Instanz für einen gewissen Zeitraum weiter und muss daher nicht neu gestartet werden, wenn innerhalb dieser Zeit eine andere Verbindung geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="4cc30-156">The sqlservr.exe process that is started is kept running for a limited time-out period after the last connection to the instance is closed, so it does not need to be restarted if another connection is opened before the time-out has expired.</span></span> <span data-ttu-id="4cc30-157">Wird innerhalb dieser Zeit keine neue Verbindung geöffnet wird, wird die Benutzerinstanz automatisch geschlossen.</span><span class="sxs-lookup"><span data-stu-id="4cc30-157">The user instance automatically shuts down if no new connection opens before that time-out period has expired.</span></span> <span data-ttu-id="4cc30-158">Ein Systemadministrator auf der übergeordneten Instanz kann die Dauer des Timeout Zeitraums für eine Benutzer Instanz mithilfe von **sp_configure** festlegen, um die Timeout Option für die **Benutzer Instanz** zu ändern.</span><span class="sxs-lookup"><span data-stu-id="4cc30-158">A system administrator on the parent instance can set the duration of the time-out period for a user instance by using **sp_configure** to change the **user instance timeout** option.</span></span> <span data-ttu-id="4cc30-159">Der Standardwert ist 60 Minuten.</span><span class="sxs-lookup"><span data-stu-id="4cc30-159">The default is 60 minutes.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4cc30-160">Wenn in der Verbindungszeichenfolge `Min Pool Size` mit einem Wert größer als 0 verwendet wird, hält die Verbindungspoolfunktion stets einige geöffnete Verbindungen aufrecht, und die Benutzerinstanz wird nicht automatisch geschlossen.</span><span class="sxs-lookup"><span data-stu-id="4cc30-160">If `Min Pool Size` is used in the connection string with a value greater than zero, the connection pooler will always maintain a few opened connections, and the user instance will not automatically shut down.</span></span>  
  
## <a name="how-user-instances-work"></a><span data-ttu-id="4cc30-161">So funktionieren Benutzerinstanzen</span><span class="sxs-lookup"><span data-stu-id="4cc30-161">How User Instances Work</span></span>  
 <span data-ttu-id="4cc30-162">Wenn eine Benutzer Instanz zum ersten Mal für jeden Benutzer generiert wird, werden die System Datenbanken **Master** und **msdb** aus dem Ordner Vorlagen Daten in einen Pfad im Verzeichnis des lokalen Anwendungsdatenrepository des Benutzers kopiert, um die Benutzer Instanz exklusiv zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="4cc30-162">The first time a user instance is generated for each user, the **master** and **msdb** system databases are copied from the Template Data folder to a path under the user's local application data repository directory for exclusive use by the user instance.</span></span> <span data-ttu-id="4cc30-163">Dieser Pfad lautet in der Regel `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span><span class="sxs-lookup"><span data-stu-id="4cc30-163">This path is typically `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span></span> <span data-ttu-id="4cc30-164">Wenn eine Benutzer Instanz gestartet wird, werden die **tempdb**-, Protokoll-und Ablauf Verfolgungs Dateien ebenfalls in dieses Verzeichnis geschrieben.</span><span class="sxs-lookup"><span data-stu-id="4cc30-164">When a user instance starts up, the **tempdb**, log, and trace files are also written to this directory.</span></span> <span data-ttu-id="4cc30-165">Es wird ein Name für die Instanz generiert, der für jeden Benutzer garantiert eindeutig ist.</span><span class="sxs-lookup"><span data-stu-id="4cc30-165">A name is generated for the instance, which is guaranteed to be unique for each user.</span></span>  
  
 <span data-ttu-id="4cc30-166">Standardmäßig sind alle Member der Gruppe &lt;legacyBold&gt;Windows Builtin\Users&lt;/legacyBold&gt; berechtigt, über die lokale Instanz Verbindungen herzustellen und die SQL Server-Binärdateien zu lesen und auszuführen.</span><span class="sxs-lookup"><span data-stu-id="4cc30-166">By default all members of the Windows Builtin\Users group are granted permissions to connect on the local instance as well as read and execute permissions on the SQL Server binaries.</span></span> <span data-ttu-id="4cc30-167">Nachdem die Anmeldeinformationen des Benutzers verifiziert wurden, der die Benutzerinstanz hostet, wird dieser Benutzer zum `sysadmin` für diese Instanz.</span><span class="sxs-lookup"><span data-stu-id="4cc30-167">Once the credentials of the calling user hosting the user instance have been verified, that user becomes the `sysadmin` on that instance.</span></span> <span data-ttu-id="4cc30-168">Für Benutzerinstanzen ist nur ein gemeinsam genutzter Speicherbereich (Shared Memory) aktiviert, sodass der Benutzer nur Vorgänge auf seinem lokalen Computer ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="4cc30-168">Only shared memory is enabled for user instances, which means that only operations on the local machine are possible.</span></span>  
  
 <span data-ttu-id="4cc30-169">Die Benutzer müssen sowohl Lese- als auch Schreibberechtigungen für die in der Verbindungszeichenfolge angegebenen MDF- und LDF-Dateien erhalten.</span><span class="sxs-lookup"><span data-stu-id="4cc30-169">Users must be granted both read and write permissions on the .mdf and .ldf files specified in the connection string.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4cc30-170">Bei der MDF- und der LDF-Datei handelt es sich um die Datenbank- bzw. um die Protokolldatei.</span><span class="sxs-lookup"><span data-stu-id="4cc30-170">The .mdf and .ldf files represent the database and log files, respectively.</span></span> <span data-ttu-id="4cc30-171">Diese beiden Dateien sind ein zusammengehöriger Satz, daher ist bei Sicherungs- und Wiederherstellungsvorgängen Vorsicht geboten.</span><span class="sxs-lookup"><span data-stu-id="4cc30-171">These two files are a matched set, so care must be taken during backup and restore operations.</span></span> <span data-ttu-id="4cc30-172">Die Datenbankdatei enthält Informationen zur exakten Version der Protokolldatei, und wenn die Datenbankdatei mit der falschen Protokolldatei gekoppelt wird, kann sie nicht geöffnet werden.</span><span class="sxs-lookup"><span data-stu-id="4cc30-172">The database file contains information about the exact version of the log file, and the database will not open if it is coupled with the wrong log file.</span></span>  
  
 <span data-ttu-id="4cc30-173">Um die Beschädigung von Daten zu vermeiden, werden Datenbanken in der Benutzerinstanz mit exklusivem Zugriff geöffnet.</span><span class="sxs-lookup"><span data-stu-id="4cc30-173">To avoid data corruption, a database in the user instance is opened with exclusive access.</span></span> <span data-ttu-id="4cc30-174">Wenn zwei verschiedene Benutzerinstanzen auf dieselbe Datenbank auf demselben Computer zugreifen, muss der Benutzer der ersten Benutzerinstanz die Datenbank schließen, bevor der Benutzer der zweiten Benutzerinstanz die Datenbank öffnen kann.</span><span class="sxs-lookup"><span data-stu-id="4cc30-174">If two different user instances share the same database on the same computer, the user on the first instance must close the database before it can be opened in a second instance.</span></span>  
  
## <a name="user-instance-scenarios"></a><span data-ttu-id="4cc30-175">Benutzerinstanzszenarien</span><span class="sxs-lookup"><span data-stu-id="4cc30-175">User Instance Scenarios</span></span>  
 <span data-ttu-id="4cc30-176">Benutzerinstanzen stellen Entwicklern von Datenbankanwendungen einen SQL Server-Datenspeicher zur Verfügung, der nicht voraussetzt, dass die Entwickler auf ihren Entwicklungscomputern mit Administratorberechtigungen arbeiten.</span><span class="sxs-lookup"><span data-stu-id="4cc30-176">User instances provide developers of database applications with a SQL Server data store that does not depend on developers having administrative accounts on their development computers.</span></span> <span data-ttu-id="4cc30-177">Benutzerinstanzen basieren auf dem Access/Jet-Modell, bei dem die Datenbankanwendung einfach eine Verbindung mit einer Datei herstellt und der Benutzer automatisch volle Berechtigungen für alle Datenbankobjekte erhält, ohne dass ein Systemadministrator eingreifen und diese Berechtigungen gewähren muss.</span><span class="sxs-lookup"><span data-stu-id="4cc30-177">User instances are based on the Access/Jet model, where the database application simply connects to a file, and the user automatically has full permissions on all of the database objects without needing the intervention of a system administrator to grant permissions.</span></span> <span data-ttu-id="4cc30-178">Die Verwendung dieses Modells bietet sich für Situationen an, in denen der Benutzer mit einem Konto der untersten Berechtigungsebene (Least-Priviledged User Account, LUA) arbeitet und keine Administratorberechtigungen für den Server oder den lokalen Computer besitzt, dennoch aber Datenbankobjekte und Anwendungen erstellen können muss.</span><span class="sxs-lookup"><span data-stu-id="4cc30-178">It is intended to work in situations where the user is running under a least-privilege user account (LUA) and does not have administrative privileges on the server or local machine, yet needs to create database objects and applications.</span></span> <span data-ttu-id="4cc30-179">Mit Benutzerinstanzen können Benutzer Laufzeitinstanzen erstellen, die im Sicherheitskontext des Benutzers und nicht im Sicherheitskontext eines Systemdienstes mit umfangreicheren Berechtigungen ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="4cc30-179">User instances allow users to create instances at run time that run under the user's own security context, and not in the security context of a more privileged system service.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="4cc30-180">Benutzerinstanzen sollten nur in Szenarien eingesetzt werden, in denen alle Anwendungen, die die Instanzen verwenden, vollständig vertrauenswürdig sind.</span><span class="sxs-lookup"><span data-stu-id="4cc30-180">User instances should only be used in scenarios where all the applications using it are fully trusted.</span></span>  
  
 <span data-ttu-id="4cc30-181">Zu den Benutzerinstanzszenarien gehören folgende Szenarien:</span><span class="sxs-lookup"><span data-stu-id="4cc30-181">User instance scenarios include:</span></span>  
  
- <span data-ttu-id="4cc30-182">alle Einzelbenutzeranwendungen, in denen keine Datenfreigabe erforderlich ist</span><span class="sxs-lookup"><span data-stu-id="4cc30-182">Any single-user application where sharing data is not required.</span></span>  
  
- <span data-ttu-id="4cc30-183">ClickOnce-Bereitstellung:</span><span class="sxs-lookup"><span data-stu-id="4cc30-183">ClickOnce deployment.</span></span> <span data-ttu-id="4cc30-184">Auf Computern, auf denen .NET Framework 2.0 (oder höher) und SQL Server Express bereits installiert sind, kann das im Rahmen einer ClickOnce-Aktion heruntergeladene Installationspaket installiert und von Benutzern ohne Administratorberechtigung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4cc30-184">If the .NET Framework 2.0 (or later) and SQL Server Express are already installed on the target computer, the installation package downloaded as a result of a ClickOnce action can be installed and used by non-administrator users.</span></span> <span data-ttu-id="4cc30-185">Beachten Sie, dass die Installation von SQL Server Express, sofern diese Teil des Setups ist, von einem Administrator vorgenommen werden muss.</span><span class="sxs-lookup"><span data-stu-id="4cc30-185">Note that an administrator must install SQL Server Express if that is part of the setup.</span></span> <span data-ttu-id="4cc30-186">Weitere Informationen finden Sie unter [ClickOnce-Bereitstellung für Windows Forms](../../../winforms/clickonce-deployment-for-windows-forms.md).</span><span class="sxs-lookup"><span data-stu-id="4cc30-186">For more information, see [ClickOnce Deployment for Windows Forms](../../../winforms/clickonce-deployment-for-windows-forms.md).</span></span>
  
- <span data-ttu-id="4cc30-187">dediziertes ASP.NET-Hosting mit Windows-Authentifizierung:</span><span class="sxs-lookup"><span data-stu-id="4cc30-187">Dedicated ASP.NET hosting using Windows Authentication.</span></span> <span data-ttu-id="4cc30-188">Eine einzelne SQL Server Express-Instanz kann in einem Intranet gehostet werden.</span><span class="sxs-lookup"><span data-stu-id="4cc30-188">A single SQL Server Express instance can be hosted on an intranet.</span></span> <span data-ttu-id="4cc30-189">Die Anwendung stellt die Verbindung über das ASPNET-Windows-Konto und nicht durch einen Identitätswechsel her.</span><span class="sxs-lookup"><span data-stu-id="4cc30-189">The application connects using the ASPNET Windows account, not by using impersonation.</span></span> <span data-ttu-id="4cc30-190">Benutzerinstanzen dürfen nicht in Drittanbieterszenarien oder Szenarien mit gemeinsamem Hosting verwendet werden, in denen alle Anwendungen dieselbe Benutzerinstanz nutzen und damit nicht mehr voneinander isoliert sind.</span><span class="sxs-lookup"><span data-stu-id="4cc30-190">User instances should not be used for third-party or shared hosting scenarios where all applications would share the same user instance and would no longer remain isolated from each other.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4cc30-191">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="4cc30-191">See also</span></span>

- [<span data-ttu-id="4cc30-192">SQL Server und ADO.NET</span><span class="sxs-lookup"><span data-stu-id="4cc30-192">SQL Server and ADO.NET</span></span>](index.md)
- [<span data-ttu-id="4cc30-193">Verbindungszeichenfolgen</span><span class="sxs-lookup"><span data-stu-id="4cc30-193">Connection Strings</span></span>](../connection-strings.md)
- [<span data-ttu-id="4cc30-194">Aufbauen der Verbindung zu einer Datenquelle</span><span class="sxs-lookup"><span data-stu-id="4cc30-194">Connecting to a Data Source</span></span>](../connecting-to-a-data-source.md)
- [<span data-ttu-id="4cc30-195">Übersicht über ADO.NET</span><span class="sxs-lookup"><span data-stu-id="4cc30-195">ADO.NET Overview</span></span>](../ado-net-overview.md)
