---
title: 'Vorgehensweise: Speichern und Wiederverwenden von Abfragen'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a012bd79-1809-45e3-adea-0229532396cc
ms.openlocfilehash: 1aac20c3f9c421d353938a83b9e321d35abd244e
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/18/2019
ms.locfileid: "59084192"
---
# <a name="how-to-store-and-reuse-queries"></a><span data-ttu-id="e3fa7-102">Vorgehensweise: Speichern und Wiederverwenden von Abfragen</span><span class="sxs-lookup"><span data-stu-id="e3fa7-102">How to: Store and Reuse Queries</span></span>
<span data-ttu-id="e3fa7-103">Wenn eine Anwendung häufig strukturell ähnliche Abfragen ausführt, können Sie häufig die Leistung steigern, indem Sie die Abfrage einmal kompilieren und dann mehrmals mit verschiedenen Parametern ausführen.</span><span class="sxs-lookup"><span data-stu-id="e3fa7-103">When you have an application that executes structurally similar queries many times, you can often increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="e3fa7-104">So können beispielsweise mithilfe einer Anwendung alle Kunden in einer bestimmten Stadt abgerufen werden, wobei die Stadt zur Laufzeit vom Benutzer in einem Formular festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="e3fa7-104">For example, an application might have to retrieve all the customers who are in a particular city, where the city is specified at runtime by the user in a form.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="e3fa7-105">unterstützt die Verwendung von *kompilierter Abfragen* für diesen Zweck.</span><span class="sxs-lookup"><span data-stu-id="e3fa7-105">supports the use of *compiled queries* for this purpose.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="e3fa7-106">Dieses Nutzungsmuster stellt die gängigste Verwendung für kompilierte Abfragen dar.</span><span class="sxs-lookup"><span data-stu-id="e3fa7-106">This pattern of usage represents the most common use for compiled queries.</span></span> <span data-ttu-id="e3fa7-107">Andere Ansätze sind möglich.</span><span class="sxs-lookup"><span data-stu-id="e3fa7-107">Other approaches are possible.</span></span> <span data-ttu-id="e3fa7-108">Kompilierte Abfragen können beispielsweise als statische Member einer partiellen Klasse gespeichert werden, die den vom Entwickler erzeugten Code ergänzt.</span><span class="sxs-lookup"><span data-stu-id="e3fa7-108">For example, compiled queries can be stored as static members on a partial class that extends the code generated by the designer.</span></span>  
  
## <a name="example"></a><span data-ttu-id="e3fa7-109">Beispiel</span><span class="sxs-lookup"><span data-stu-id="e3fa7-109">Example</span></span>  
 <span data-ttu-id="e3fa7-110">In vielen Szenarien möchten Sie ggf. die Abfragen über Threadbegrenzungen hinweg wiederverwenden.</span><span class="sxs-lookup"><span data-stu-id="e3fa7-110">In many scenarios you might want to reuse the queries across thread boundaries.</span></span> <span data-ttu-id="e3fa7-111">In solchen Fällen ist die Speicherung kompilierter Abfragen in statischen Variablen besonders effektiv.</span><span class="sxs-lookup"><span data-stu-id="e3fa7-111">In such cases, storing the compiled queries in static variables is especially effective.</span></span> <span data-ttu-id="e3fa7-112">Das folgende Codebeispiel basiert auf einer `Queries`-Klasse zum Speichern kompilierter Abfragen sowie auf einer Northwind-Klasse, die einen stark typisierten <xref:System.Data.Linq.DataContext> darstellt.</span><span class="sxs-lookup"><span data-stu-id="e3fa7-112">The following code example assumes a `Queries` class designed to store compiled queries, and assumes a Northwind class that represents a strongly typed <xref:System.Data.Linq.DataContext>.</span></span>  
  
 [!code-csharp[DLinqQuerying#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#6)]
 [!code-vb[DLinqQuerying#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#6)]  
  
 [!code-csharp[DLinqQuerying#7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#7)]
 [!code-vb[DLinqQuerying#7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#7)]  
  
## <a name="example"></a><span data-ttu-id="e3fa7-113">Beispiel</span><span class="sxs-lookup"><span data-stu-id="e3fa7-113">Example</span></span>  
 <span data-ttu-id="e3fa7-114">Sie können derzeit Filiale (in statischen Variablen) Abfragen, Zurückgeben einer *anonymen Typs*, da der Typ keinen Namen, das als generisches Argument bereitgestellt hat.</span><span class="sxs-lookup"><span data-stu-id="e3fa7-114">You cannot currently store (in static variables) queries that return an *anonymous type*, because type has no name to provide as a generic argument.</span></span> <span data-ttu-id="e3fa7-115">Im folgenden Beispiel wird veranschaulicht, wie sich das Problem durch Erstellen eines Typs umgehen lässt, der das Ergebnis darstellen kann. Anschließend wird dieser Typ als generisches Argument verwendet.</span><span class="sxs-lookup"><span data-stu-id="e3fa7-115">The following example shows how you can work around the issue by creating a type that can represent the result, and then use it as a generic argument.</span></span>  
  
 [!code-csharp[DLinqQuerying#8](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#8)]
 [!code-vb[DLinqQuerying#8](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#8)]  
  
## <a name="see-also"></a><span data-ttu-id="e3fa7-116">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="e3fa7-116">See also</span></span>

- <xref:System.Data.Linq.CompiledQuery>
- [<span data-ttu-id="e3fa7-117">Abfragekonzepte</span><span class="sxs-lookup"><span data-stu-id="e3fa7-117">Query Concepts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/query-concepts.md)
- [<span data-ttu-id="e3fa7-118">Abfragen der Datenbank</span><span class="sxs-lookup"><span data-stu-id="e3fa7-118">Querying the Database</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)
