---
title: Zusammenführen von DataSet-Inhalten
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: e5e9309a-3ebb-4a9c-9d78-21c4e2bafc5b
ms.openlocfilehash: 153c96860005046e4cc16d5a965bd569e3519b52
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "61607929"
---
# <a name="merging-dataset-contents"></a><span data-ttu-id="e3c99-102">Zusammenführen von DataSet-Inhalten</span><span class="sxs-lookup"><span data-stu-id="e3c99-102">Merging DataSet Contents</span></span>

<span data-ttu-id="e3c99-103">Sie können die <xref:System.Data.DataSet.Merge%2A>-Methode verwenden, um den Inhalt eines <xref:System.Data.DataSet>-, <xref:System.Data.DataTable>- oder <xref:System.Data.DataRow>-Arrays in einem vorhandenen `DataSet` zusammenzuführen.</span><span class="sxs-lookup"><span data-stu-id="e3c99-103">You can use the <xref:System.Data.DataSet.Merge%2A> method to merge the contents of a <xref:System.Data.DataSet>, <xref:System.Data.DataTable>, or <xref:System.Data.DataRow> array into an existing `DataSet`.</span></span> <span data-ttu-id="e3c99-104">Wie die neuen Daten in einem vorhandenen `DataSet` zusammengeführt werden, hängt von mehreren Faktoren und Optionen ab.</span><span class="sxs-lookup"><span data-stu-id="e3c99-104">Several factors and options affect how new data is merged into an existing `DataSet`.</span></span>

## <a name="primary-keys"></a><span data-ttu-id="e3c99-105">Primärschlüssel</span><span class="sxs-lookup"><span data-stu-id="e3c99-105">Primary Keys</span></span>

<span data-ttu-id="e3c99-106">Wenn die Tabelle, die neue Daten und Schemas aus einem Merge empfängt, einen Primärschlüssel besitzt, werden die neuen Zeilen aus den empfangenen Daten mit vorhandenen Zeilen verglichen, die dieselben <xref:System.Data.DataRowVersion.Original>-Primärschlüsselwerte besitzen wie die empfangenen Daten.</span><span class="sxs-lookup"><span data-stu-id="e3c99-106">If the table receiving new data and schema from a merge has a primary key, new rows from the incoming data are matched with existing rows that have the same <xref:System.Data.DataRowVersion.Original> primary key values as those in the incoming data.</span></span> <span data-ttu-id="e3c99-107">Wenn die Spalten aus dem empfangenen Schema mit denen des vorhandenen Schemas übereinstimmen, werden die Daten in den vorhandenen Zeilen geändert.</span><span class="sxs-lookup"><span data-stu-id="e3c99-107">If the columns from the incoming schema match those of the existing schema, the data in the existing rows is modified.</span></span> <span data-ttu-id="e3c99-108">Spalten, die nicht mit dem vorhandenen Schema übereinstimmen, werden, abhängig vom Wert des <xref:System.Data.Common.DataAdapter.MissingSchemaAction%2A>-Parameters, entweder ignoriert oder hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-108">Columns that do not match the existing schema are either ignored or added based on the <xref:System.Data.Common.DataAdapter.MissingSchemaAction%2A> parameter.</span></span> <span data-ttu-id="e3c99-109">Neue Zeilen mit Primärschlüsselwerten, die nicht mit vorhandenen Zeilen übereinstimmen, werden an die vorhandene Tabelle angehängt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-109">New rows with primary key values that do not match any existing rows are appended to the existing table.</span></span>

<span data-ttu-id="e3c99-110">Wenn empfangene oder vorhandene Zeilen den Zeilenstatus <xref:System.Data.DataRowState.Added> aufweisen, werden ihre Primärschlüsselwerte mit dem <xref:System.Data.DataRowVersion.Current>-Primärschlüsselwert der `Added`-Zeile verglichen, weil es keine `Original`-Zeilenversion gibt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-110">If incoming or existing rows have a row state of <xref:System.Data.DataRowState.Added>, their primary key values are matched using the <xref:System.Data.DataRowVersion.Current> primary key value of the `Added` row because no `Original` row version exists.</span></span>

<span data-ttu-id="e3c99-111">Wenn eine empfangene Tabelle und eine vorhandene Tabelle eine Spalte mit demselben Namen, aber unterschiedlichen Datentypen enthalten, wird eine Ausnahme generiert, und das <xref:System.Data.DataSet.MergeFailed>-Ereignis des `DataSet` wird ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="e3c99-111">If an incoming table and an existing table contain a column with the same name but different data types, an exception is thrown and the <xref:System.Data.DataSet.MergeFailed> event of the `DataSet` is raised.</span></span> <span data-ttu-id="e3c99-112">Wenn sowohl eine empfangene Tabelle als auch eine vorhandene Tabelle definierte Primärschlüssel besitzen, die Primärschlüssel aber für verschiedene Spalten gelten, wird eine Ausnahme generiert und das `MergeFailed`-Ereignis des `DataSet` ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="e3c99-112">If an incoming table and an existing table both have defined keys, but the primary keys are for different columns, an exception is thrown and the `MergeFailed` event of the `DataSet` is raised.</span></span>

<span data-ttu-id="e3c99-113">Wenn die Tabelle, die neue Daten aus einer Zusammenführung empfängt, keinen Primärschlüssel besitzt, können die neuen Zeilen aus den empfangenen Daten nicht mit vorhandenen Zeilen in der Tabelle verglichen werden. Die Zeilen werden dann stattdessen an die vorhandene Tabelle angehängt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-113">If the table receiving new data from a merge does not have a primary key, new rows from the incoming data cannot be matched to existing rows in the table and are instead appended to the existing table.</span></span>

## <a name="table-names-and-namespaces"></a><span data-ttu-id="e3c99-114">Tabellennamen und Namespaces</span><span class="sxs-lookup"><span data-stu-id="e3c99-114">Table Names and Namespaces</span></span>

<span data-ttu-id="e3c99-115"><xref:System.Data.DataTable>-Objekten kann optional ein <xref:System.Data.DataTable.Namespace%2A>-Eigenschaftswert zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="e3c99-115"><xref:System.Data.DataTable> objects can optionally be assigned a <xref:System.Data.DataTable.Namespace%2A> property value.</span></span> <span data-ttu-id="e3c99-116">Wenn <xref:System.Data.DataTable.Namespace%2A>-Werte zugewiesen werden, kann ein <xref:System.Data.DataSet> mehrere <xref:System.Data.DataTable>-Objekte mit demselben <xref:System.Data.DataTable.TableName%2A>-Wert enthalten.</span><span class="sxs-lookup"><span data-stu-id="e3c99-116">When <xref:System.Data.DataTable.Namespace%2A> values are assigned, a <xref:System.Data.DataSet> can contain multiple <xref:System.Data.DataTable> objects with the same <xref:System.Data.DataTable.TableName%2A> value.</span></span> <span data-ttu-id="e3c99-117">Bei Merges werden sowohl der <xref:System.Data.DataTable.TableName%2A> als auch der <xref:System.Data.DataTable.Namespace%2A> verwendet, um das Ziel des Merge anzugeben.</span><span class="sxs-lookup"><span data-stu-id="e3c99-117">During merge operations, both <xref:System.Data.DataTable.TableName%2A> and <xref:System.Data.DataTable.Namespace%2A> are used to identify the target of a merge.</span></span> <span data-ttu-id="e3c99-118">Wenn kein <xref:System.Data.DataTable.Namespace%2A> zugewiesen wurde, wird zur Angabe des Ziels nur der <xref:System.Data.DataTable.TableName%2A> verwendet.</span><span class="sxs-lookup"><span data-stu-id="e3c99-118">If no <xref:System.Data.DataTable.Namespace%2A> has been assigned, only the <xref:System.Data.DataTable.TableName%2A> is used to identify the target of a merge.</span></span>

> [!NOTE]
> <span data-ttu-id="e3c99-119">Dieses Verhalten ist in .NET Framework 2.0 neu.</span><span class="sxs-lookup"><span data-stu-id="e3c99-119">This behavior changed in version 2.0 of the .NET Framework.</span></span> <span data-ttu-id="e3c99-120">In Version 1.1 wurden Namespaces zwar unterstützt, bei Merges wurden sie aber ignoriert.</span><span class="sxs-lookup"><span data-stu-id="e3c99-120">In version 1.1, namespaces were supported but were ignored during merge operations.</span></span> <span data-ttu-id="e3c99-121">Aus diesem Grund hängt das Verhalten eines <xref:System.Data.DataSet>, das <xref:System.Data.DataTable.Namespace%2A>-Eigenschaftswerte verwendet, von der jeweils verwendeten .NET Framework-Version ab.</span><span class="sxs-lookup"><span data-stu-id="e3c99-121">For this reason, a <xref:System.Data.DataSet> that uses <xref:System.Data.DataTable.Namespace%2A> property values will have different behaviors depending on which version of the .NET Framework you are running.</span></span> <span data-ttu-id="e3c99-122">Nehmen wir z. B. an, es gibt zwei `DataSets`, die `DataTables` mit identischen <xref:System.Data.DataTable.TableName%2A>-Eigenschaftswerten, aber verschiedenen <xref:System.Data.DataTable.Namespace%2A>-Eigenschaftswerten enthalten.</span><span class="sxs-lookup"><span data-stu-id="e3c99-122">For example, suppose you have two `DataSets` containing `DataTables` with the same <xref:System.Data.DataTable.TableName%2A> property values but different <xref:System.Data.DataTable.Namespace%2A> property values.</span></span> <span data-ttu-id="e3c99-123">In .NET Framework 1.1 werden die verschiedenen <xref:System.Data.DataTable.Namespace%2A>-Namen beim Zusammenführen der beiden <xref:System.Data.DataSet>-Objekte ignoriert.</span><span class="sxs-lookup"><span data-stu-id="e3c99-123">In version 1.1 of the .NET Framework, the different <xref:System.Data.DataTable.Namespace%2A> names will be ignored when merging the two <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="e3c99-124">Ab Version 2.0 hingegen werden beim Zusammenführen zwei neue `DataTables` im Ziel-<xref:System.Data.DataSet> erstellt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-124">However, starting with version 2.0, merging causes two new `DataTables` to be created in the target <xref:System.Data.DataSet>.</span></span> <span data-ttu-id="e3c99-125">Auf die ursprünglichen `DataTables` hat die Zusammenführung keine Auswirkung.</span><span class="sxs-lookup"><span data-stu-id="e3c99-125">The original `DataTables` will be unaffected by the merge.</span></span>

## <a name="preservechanges"></a><span data-ttu-id="e3c99-126">PreserveChanges</span><span class="sxs-lookup"><span data-stu-id="e3c99-126">PreserveChanges</span></span>

<span data-ttu-id="e3c99-127">Wenn Sie ein `DataSet`-, ein `DataTable`- oder ein `DataRow`-Array an die `Merge`-Methode übergeben, können Sie mit optionalen Parametern angeben, ob Änderungen im vorhandenen `DataSet` beibehalten werden sollen und wie die neuen Schemaelemente in den empfangenen Daten zu behandeln sind.</span><span class="sxs-lookup"><span data-stu-id="e3c99-127">When you pass a `DataSet`, `DataTable`, or `DataRow` array to the `Merge` method, you can include optional parameters that specify whether or not to preserve changes in the existing `DataSet`, and how to handle new schema elements found in the incoming data.</span></span> <span data-ttu-id="e3c99-128">Der erste dieser Parameter nach den empfangenen Daten ist ein Boolean-Flag, <xref:System.Data.LoadOption.PreserveChanges>, das angibt, ob die Änderungen im vorhandenen `DataSet` beibehalten werden sollen.</span><span class="sxs-lookup"><span data-stu-id="e3c99-128">The first of these parameters after the incoming data is a Boolean flag, <xref:System.Data.LoadOption.PreserveChanges>, which specifies whether or not to preserve the changes in the existing `DataSet`.</span></span> <span data-ttu-id="e3c99-129">Wenn das `PreserveChanges`-Flag auf `true` festgelegt ist, werden vorhandene Werte in der `Current`-Zeilenversion der vorhandenen Zeile nicht durch die empfangenen Werte überschrieben.</span><span class="sxs-lookup"><span data-stu-id="e3c99-129">If the `PreserveChanges` flag is set to `true`, incoming values do not overwrite existing values in the `Current` row version of the existing row.</span></span> <span data-ttu-id="e3c99-130">Wenn das `PreserveChanges`-Flag auf `false` festgelegt ist, werden die vorhandenen Werte in der `Current`-Zeilenversion der vorhandenen Zeile mit den empfangenen Werten überschrieben.</span><span class="sxs-lookup"><span data-stu-id="e3c99-130">If the `PreserveChanges` flag is set to `false`, incoming values do overwrite the existing values in the `Current` row version of the existing row.</span></span> <span data-ttu-id="e3c99-131">Wenn für das `PreserveChanges`-Flag nichts angegeben wird, wird es standardmäßig auf `false` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-131">If the `PreserveChanges` flag is not specified, it is set to `false` by default.</span></span> <span data-ttu-id="e3c99-132">Weitere Informationen zu Zeilenversionen finden Sie unter [Zeilenstatus und Zeilenversionen](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md).</span><span class="sxs-lookup"><span data-stu-id="e3c99-132">For more information about row versions, see [Row States and Row Versions](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md).</span></span>

<span data-ttu-id="e3c99-133">Wenn das `PreserveChanges`-Flag auf `true` festgelegt ist, werden die Daten der vorhandenen Zeile in der <xref:System.Data.DataRowVersion.Current>-Zeilenversion der vorhandenen Zeile beibehalten, während die Daten aus der <xref:System.Data.DataRowVersion.Original>-Zeilenversion der vorhandenen Zeile durch die Daten aus der `Original`-Zeilenversion der empfangenen Zeile überschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="e3c99-133">When `PreserveChanges` is `true`, the data from the existing row is maintained in the <xref:System.Data.DataRowVersion.Current> row version of the existing row, while the data from the <xref:System.Data.DataRowVersion.Original> row version of the existing row is overwritten with the data from the `Original` row version of the incoming row.</span></span> <span data-ttu-id="e3c99-134">Der <xref:System.Data.DataRow.RowState%2A> der vorhandenen Zeile wird auf <xref:System.Data.DataRowState.Modified> festgelegt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-134">The <xref:System.Data.DataRow.RowState%2A> of the existing row is set to <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="e3c99-135">Beachten Sie folgende Ausnahmen:</span><span class="sxs-lookup"><span data-stu-id="e3c99-135">The following exceptions apply:</span></span>

- <span data-ttu-id="e3c99-136">Wenn der `RowState` der vorhandenen Zeile `Deleted` lautet, bleibt dieser `RowState` als `Deleted` erhalten und wird nicht auf `Modified` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-136">If the existing row has a `RowState` of `Deleted`, this `RowState` remains `Deleted` and is not set to `Modified`.</span></span> <span data-ttu-id="e3c99-137">In diesem Fall werden die Daten aus der empfangenen Zeile immer noch in der Zeilenversion `Original` der vorhandenen Zeile gespeichert, wobei die Zeilenversion `Original` der vorhandenen Zeile überschrieben wird (es sei denn, der `RowState` der empfangenen Zeile lautet `Added`).</span><span class="sxs-lookup"><span data-stu-id="e3c99-137">In this case, the data from the incoming row will still be stored in the `Original` row version of the existing row, overwriting the `Original` row version of the existing row (unless the incoming row has a `RowState` of `Added`).</span></span>

- <span data-ttu-id="e3c99-138">Wenn der `RowState` der empfangenen Zeile `Added` lautet, werden die Daten aus der `Original`-Zeilenversion der vorhandenen Zeile nicht mit den Daten der empfangenen Zeile überschrieben, weil die empfangene Zeile keine `Original`-Zeilenversion besitzt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-138">If the incoming row has a `RowState` of `Added`, the data from the `Original` row version of the existing row will not be overwritten with data from the incoming row, because the incoming row does not have an `Original` row version.</span></span>

<span data-ttu-id="e3c99-139">Wenn das `PreserveChanges`-Flag auf `false` festgelegt ist, werden sowohl die `Current`-Zeilenversion als auch die `Original`-Zeilenversion in der vorhandenen Zeile durch die Daten der empfangenen Zeile überschrieben, und der `RowState` der vorhandenen Zeile wird auf den `RowState` der empfangenen Zeile festgelegt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-139">When `PreserveChanges` is `false`, both the `Current` and `Original` row versions in the existing row are overwritten with the data from the incoming row, and the `RowState` of the existing row is set to the `RowState` of the incoming row.</span></span> <span data-ttu-id="e3c99-140">Beachten Sie folgende Ausnahmen:</span><span class="sxs-lookup"><span data-stu-id="e3c99-140">The following exceptions apply:</span></span>

- <span data-ttu-id="e3c99-141">Wenn die empfangene Zeile den `RowState``Unchanged` und die vorhandene Zeile den `RowState``Modified`, `Deleted` oder `Added` besitzt, wird der `RowState` der vorhandenen Zeile auf `Modified` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-141">If the incoming row has a `RowState` of `Unchanged` and the existing row has a `RowState` of `Modified`, `Deleted`, or `Added`, the `RowState` of the existing row is set to `Modified`.</span></span>

- <span data-ttu-id="e3c99-142">Wenn die empfangene Zeile den `RowState``Added` und die vorhandene Zeile den `RowState``Unchanged`, `Modified` oder `Deleted` besitzt, wird der `RowState` der vorhandenen Zeile auf `Modified` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-142">If the incoming row has a `RowState` of `Added`, and the existing row has a `RowState` of `Unchanged`, `Modified`, or `Deleted`, the `RowState` of the existing row is set to `Modified`.</span></span> <span data-ttu-id="e3c99-143">Außerdem werden die Daten der `Original`-Zeilenversion der vorhandenen Zeile nicht durch die Daten der empfangenen Zeile überschrieben, weil die empfangene Zeile keine `Original`-Zeilenversion besitzt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-143">Also, the data from the `Original` row version of the existing row is not overwritten with data from the incoming row, because the incoming row does not have an `Original` row version.</span></span>

## <a name="missingschemaaction"></a><span data-ttu-id="e3c99-144">MissingSchemaAction</span><span class="sxs-lookup"><span data-stu-id="e3c99-144">MissingSchemaAction</span></span>

<span data-ttu-id="e3c99-145">Mit dem optionalen <xref:System.Data.MissingSchemaAction>-Parameter der `Merge`-Methode können Sie angeben, wie die `Merge`-Methode Schemaelemente in den empfangenen Daten behandeln soll, die nicht Teil des bestehenden `DataSet` sind.</span><span class="sxs-lookup"><span data-stu-id="e3c99-145">You can use the optional <xref:System.Data.MissingSchemaAction> parameter of the `Merge` method to specify how `Merge` will handle schema elements in the incoming data that are not part of the existing `DataSet`.</span></span>

<span data-ttu-id="e3c99-146">Eine Beschreibung der Optionen für `MissingSchemaAction` finden Sie in der folgenden Tabelle.</span><span class="sxs-lookup"><span data-stu-id="e3c99-146">The following table describes the options for `MissingSchemaAction`.</span></span>

|<span data-ttu-id="e3c99-147">MissingSchemaAction-Option</span><span class="sxs-lookup"><span data-stu-id="e3c99-147">MissingSchemaAction option</span></span>|<span data-ttu-id="e3c99-148">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="e3c99-148">Description</span></span>|
|--------------------------------|-----------------|
|<xref:System.Data.MissingSchemaAction.Add>|<span data-ttu-id="e3c99-149">Fügt dem `DataSet` die neuen Schemainformationen hinzu und füllt die neuen Spalten mit den empfangenen Werten auf.</span><span class="sxs-lookup"><span data-stu-id="e3c99-149">Add the new schema information to the `DataSet` and populate the new columns with the incoming values.</span></span> <span data-ttu-id="e3c99-150">Dies ist die Standardeinstellung.</span><span class="sxs-lookup"><span data-stu-id="e3c99-150">This is the default.</span></span>|
|<xref:System.Data.MissingSchemaAction.AddWithKey>|<span data-ttu-id="e3c99-151">Fügt dem `DataSet` die neuen Schema- und Primärschlüsselinformationen hinzu und füllt die neuen Spalten mit den empfangenen Werten auf.</span><span class="sxs-lookup"><span data-stu-id="e3c99-151">Add the new schema and primary key information to the `DataSet` and populate the new columns with the incoming values.</span></span>|
|<xref:System.Data.MissingSchemaAction.Error>|<span data-ttu-id="e3c99-152">Auslösen einer Ausnahme, wenn nicht übereinstimmende Schemainformationen gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="e3c99-152">Throw an exception if mismatched schema information is encountered.</span></span>|
|<xref:System.Data.MissingSchemaAction.Ignore>|<span data-ttu-id="e3c99-153">Ignorieren der neuen Schemainformationen.</span><span class="sxs-lookup"><span data-stu-id="e3c99-153">Ignore the new schema information.</span></span>|

## <a name="constraints"></a><span data-ttu-id="e3c99-154">Einschränkungen</span><span class="sxs-lookup"><span data-stu-id="e3c99-154">Constraints</span></span>

<span data-ttu-id="e3c99-155">Bei der `Merge`-Methode werden Einschränkungen erst überprüft, wenn dem vorhandenen `DataSet` alle neuen Daten hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="e3c99-155">With the `Merge` method, constraints are not checked until all new data has been added to the existing `DataSet`.</span></span> <span data-ttu-id="e3c99-156">Sobald die Daten hinzugefügt wurden, werden die Einschränkungen für die aktuellen Werte im `DataSet` erzwungen.</span><span class="sxs-lookup"><span data-stu-id="e3c99-156">Once the data has been added, constraints are enforced on the current values in the `DataSet`.</span></span> <span data-ttu-id="e3c99-157">Sie müssen sicherstellen, dass Ihr Code die Behandlung von Ausnahmen ermöglicht, die aufgrund von Einschränkungsverletzungen ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="e3c99-157">You must ensure that your code handles any exceptions that might be thrown due to constraint violations.</span></span>

<span data-ttu-id="e3c99-158">Nehmen wir einmal an, eine vorhandene Zeile in einem `DataSet` ist eine Zeile mit dem `Unchanged`-Zeilenstatus und dem Primärschlüsselwert 1.</span><span class="sxs-lookup"><span data-stu-id="e3c99-158">Consider a case where an existing row in a `DataSet` is an `Unchanged` row with a primary key value of 1.</span></span> <span data-ttu-id="e3c99-159">Beim Zusammenführen mit einer empfangenen Zeile mit dem `Modified`-Zeilenstatus und dem `Original`-Primärschlüsselwert 2 sowie dem `Current`-Primärschlüsselwert 1 werden die vorhandene Zeile und die empfangene Zeile als nicht übereinstimmend betrachtet, weil die `Original`-Primärschlüsselwerte unterschiedlich sind.</span><span class="sxs-lookup"><span data-stu-id="e3c99-159">During a merge operation with a `Modified` incoming row with an `Original` primary key value of 2 and a `Current` primary key value of 1, the existing row and the incoming row are not considered matching because the `Original` primary key values differ.</span></span> <span data-ttu-id="e3c99-160">Wenn die Zusammenführung abgeschlossen ist und die Einschränkungen überprüft werden, wird allerdings eine Ausnahme ausgelöst, weil die `Current`-Primärschlüsselwerte die &lt;legacyBold&gt;Unique&lt;/legacyBold&gt;-Einschränkung für die Primärschlüsselspalte verletzen.</span><span class="sxs-lookup"><span data-stu-id="e3c99-160">However, when the merge is completed and constraints are checked, an exception will be thrown because the `Current` primary key values violate the unique constraint for the primary key column.</span></span>

> [!NOTE]
> <span data-ttu-id="e3c99-161">Beim Einfügen von Zeilen in Datenbanktabellen mit automatisch inkrementierenden Spalten, z. B. Identitätsspalten, ist es möglich, dass der von der Einfügung zurückgegebene Wert für die Identitätsspalte nicht mit dem Wert im `DataSet` übereinstimmt, sodass die zurückgegebenen Zeilen nicht zusammengeführt, sondern angefügt werden.</span><span class="sxs-lookup"><span data-stu-id="e3c99-161">When rows are inserted into a database table containing an auto incrementing column such as an identity column, the identity column value returned by the insert may not match the value in the `DataSet`, causing the returned rows to be appended instead of merged.</span></span> <span data-ttu-id="e3c99-162">Weitere Informationen finden Sie unter [Abrufen von Identity- oder Autonumber-Werten](../../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span><span class="sxs-lookup"><span data-stu-id="e3c99-162">For more information, see [Retrieving Identity or Autonumber Values](../../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span></span>

<span data-ttu-id="e3c99-163">Das folgende Codebeispiel führt zwei `DataSet` Objekte mit unterschiedlichen Schemas in einer `DataSet` mit den kombinierten Schemas der beiden empfangenen `DataSet` Objekte.</span><span class="sxs-lookup"><span data-stu-id="e3c99-163">The following code example merges two `DataSet` objects with different schemas into one `DataSet` with the combined schemas of the two incoming `DataSet` objects.</span></span>

[!code-csharp[DataWorks DataSet.Merge#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.Merge/CS/source.cs#1)]
[!code-vb[DataWorks DataSet.Merge#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.Merge/VB/source.vb#1)]

<span data-ttu-id="e3c99-164">Im folgenden Codebeispiel gibt es ein vorhandenes `DataSet` mit Updates, die an einen `DataAdapter` übergeben werden, der an der Datenquelle verarbeitet werden soll.</span><span class="sxs-lookup"><span data-stu-id="e3c99-164">The following code example takes an existing `DataSet` with updates and passes those updates to a `DataAdapter` to be processed at the data source.</span></span> <span data-ttu-id="e3c99-165">Die Ergebnisse werden anschließend im ursprünglichen `DataSet` zusammengeführt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-165">The results are then merged into the original `DataSet`.</span></span> <span data-ttu-id="e3c99-166">Nachdem die Änderungen zurückgewiesen wurden, die zu einem Fehler führten, wird mit `AcceptChanges` ein Commit für die zusammengeführten Änderungen ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="e3c99-166">After rejecting changes that resulted in an error, the merged changes are committed with `AcceptChanges`.</span></span>

[!code-csharp[DataWorks DataSet.MergeAcceptChanges#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/CS/source.cs#1)]
[!code-vb[DataWorks DataSet.MergeAcceptChanges#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/VB/source.vb#1)]

[!code-csharp[DataWorks DataSet.MergeAcceptChanges#2](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/CS/source.cs#2)]
[!code-vb[DataWorks DataSet.MergeAcceptChanges#2](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/VB/source.vb#2)]

## <a name="see-also"></a><span data-ttu-id="e3c99-167">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="e3c99-167">See also</span></span>

- [<span data-ttu-id="e3c99-168">DataSets, DataTables und DataViews</span><span class="sxs-lookup"><span data-stu-id="e3c99-168">DataSets, DataTables, and DataViews</span></span>](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)
- [<span data-ttu-id="e3c99-169">Zeilenstatus und Zeilenversionen</span><span class="sxs-lookup"><span data-stu-id="e3c99-169">Row States and Row Versions</span></span>](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)
- [<span data-ttu-id="e3c99-170">DataAdapters und DataReaders</span><span class="sxs-lookup"><span data-stu-id="e3c99-170">DataAdapters and DataReaders</span></span>](../../../../../docs/framework/data/adonet/dataadapters-and-datareaders.md)
- [<span data-ttu-id="e3c99-171">Abrufen und Ändern von Daten in ADO.NET</span><span class="sxs-lookup"><span data-stu-id="e3c99-171">Retrieving and Modifying Data in ADO.NET</span></span>](../../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)
- [<span data-ttu-id="e3c99-172">Abrufen von Identity- oder Autonumber-Werten</span><span class="sxs-lookup"><span data-stu-id="e3c99-172">Retrieving Identity or Autonumber Values</span></span>](../../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md)
- [<span data-ttu-id="e3c99-173">ADO.NET Managed Provider und DataSet Developer Center</span><span class="sxs-lookup"><span data-stu-id="e3c99-173">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)
