---
title: 'Vorgehensweise: Sicheres Umwandeln mit Musterabgleich und den Operatoren „is“ und „as“'
description: Erfahren Sie, wie Sie Techniken für den Musterabgleich anwenden, um Variablen sicher in einen anderen Typ umzuwandeln. Sie können sowohl den Musterabgleich als auch die Operatoren „is“ und „as“ verwenden, um Typen sicher umzuwandeln.
ms.date: 09/05/2018
helpviewer_keywords:
- cast operators [C#], as and is operators
- as operator [C#]
- is operator [C#]
ms.openlocfilehash: 762f8135063f7256ce7a167c65013703d9249039
ms.sourcegitcommit: f348c84443380a1959294cdf12babcb804cfa987
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/12/2019
ms.locfileid: "73973095"
---
# <a name="how-to-safely-cast-by-using-pattern-matching-and-the-is-and-as-operators"></a><span data-ttu-id="10dd6-104">Vorgehensweise: Sicheres Umwandeln mit Musterabgleich und den Operatoren „is“ und „as“</span><span class="sxs-lookup"><span data-stu-id="10dd6-104">How to safely cast by using pattern matching and the is and as operators</span></span>

<span data-ttu-id="10dd6-105">Da Objekte polymorph sind, ist es möglich, dass eine Variable eines Basisklassentyps einen abgeleiteten [Typ](../programming-guide/types/index.md) enthalten kann.</span><span class="sxs-lookup"><span data-stu-id="10dd6-105">Because objects are polymorphic, it's possible for a variable of a base class type to hold a derived [type](../programming-guide/types/index.md).</span></span> <span data-ttu-id="10dd6-106">Für den Zugriff auf die Instanzmember des abgeleiteten Typs ist es erforderlich, dass Sie den Wert wieder in den abgeleiteten Typ [umwandeln](../programming-guide/types/casting-and-type-conversions.md).</span><span class="sxs-lookup"><span data-stu-id="10dd6-106">To access the derived type's instance members, it's necessary to [cast](../programming-guide/types/casting-and-type-conversions.md) the value back to the derived type.</span></span> <span data-ttu-id="10dd6-107">Allerdings entsteht durch eine Umwandlung das Risiko, eine <xref:System.InvalidCastException>-Ausnahme auszulösen.</span><span class="sxs-lookup"><span data-stu-id="10dd6-107">However, a cast creates the risk of throwing an <xref:System.InvalidCastException>.</span></span> <span data-ttu-id="10dd6-108">C# stellt [Musterabgleich](../pattern-matching.md)-Anweisungen bereit, die eine Umwandlung unter der Bedingung ausführen, dass sie erfolgreich sein wird.</span><span class="sxs-lookup"><span data-stu-id="10dd6-108">C# provides [pattern matching](../pattern-matching.md) statements that perform a cast conditionally only when it will succeed.</span></span> <span data-ttu-id="10dd6-109">C# bietet außerdem die Operatoren [is](../language-reference/operators/type-testing-and-cast.md#is-operator) und [as](../language-reference/operators/type-testing-and-cast.md#as-operator), um zu testen, ob ein Wert einen bestimmten Typ aufweist.</span><span class="sxs-lookup"><span data-stu-id="10dd6-109">C# also provides the [is](../language-reference/operators/type-testing-and-cast.md#is-operator) and [as](../language-reference/operators/type-testing-and-cast.md#as-operator) operators to test if a value is of a certain type.</span></span>

<span data-ttu-id="10dd6-110">Im folgenden Code wird der Musterabgleich mit der `is`-Anweisung veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="10dd6-110">The following code demonstrates the pattern matching `is` statement.</span></span> <span data-ttu-id="10dd6-111">Sie enthält Methoden, die ein Methodenargument testen, um zu ermitteln, ob es einer möglichen Gruppe von abgeleiteten Typen angehört:</span><span class="sxs-lookup"><span data-stu-id="10dd6-111">It contains methods that test a method argument to determine if it is one of a possible set of derived types:</span></span>

[!code-csharp[Pattern matching is statement](../../../samples/snippets/csharp/how-to/safelycast/patternmatching/Program.cs#PatternMatchingIs)]

<span data-ttu-id="10dd6-112">Im vorhergehenden Beispiel werden einige Features der Syntax für den Musterabgleich veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="10dd6-112">The preceding sample demonstrates a few features of pattern matching syntax.</span></span> <span data-ttu-id="10dd6-113">Die Anweisungen `if (a is Mammal m)` und `if (o is Mammal m)` kombinieren den Test mit einer Initialisierungszuweisung.</span><span class="sxs-lookup"><span data-stu-id="10dd6-113">The `if (a is Mammal m)` and `if (o is Mammal m)` statements combine the test with an initialization assignment.</span></span> <span data-ttu-id="10dd6-114">Die Zuweisung tritt nur auf, wenn der Test erfolgreich ist.</span><span class="sxs-lookup"><span data-stu-id="10dd6-114">The assignment occurs only when the test succeeds.</span></span> <span data-ttu-id="10dd6-115">Die Variable `m` befindet sich nur im Bereich der eingebetteten `if`-Anweisung, dem sie zugewiesen wurde.</span><span class="sxs-lookup"><span data-stu-id="10dd6-115">The variable `m` is only in scope in the embedded `if` statement where it has been assigned.</span></span> <span data-ttu-id="10dd6-116">Sie können in der gleichen Methode später nicht auf `m` zugreifen.</span><span class="sxs-lookup"><span data-stu-id="10dd6-116">You cannot access `m` later in the same method.</span></span> <span data-ttu-id="10dd6-117">Probieren Sie dies im interaktiven Fenster aus.</span><span class="sxs-lookup"><span data-stu-id="10dd6-117">Try it in the interactive window.</span></span>

<span data-ttu-id="10dd6-118">Sie können die gleiche Syntax zum Testen verwenden, wenn ein [Nullable-Werttyp](../language-reference/builtin-types/nullable-value-types.md) wie im folgenden Beispielcode über einen Wert verfügt:</span><span class="sxs-lookup"><span data-stu-id="10dd6-118">You can also use the same syntax for testing if a [nullable value type](../language-reference/builtin-types/nullable-value-types.md) has a value, as shown in the following sample code:</span></span>

[!code-csharp[Pattern matching with nullable types](../../../samples/snippets/csharp/how-to/safelycast/nullablepatternmatching/Program.cs#PatternMatchingNullable)]

<span data-ttu-id="10dd6-119">Im vorhergehenden Beispiel werden weitere Features des Musterabgleichs veranschaulicht, die mit Konvertierungen verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="10dd6-119">The preceding sample demonstrates other features of pattern matching to use with conversions.</span></span> <span data-ttu-id="10dd6-120">Sie können eine Variable für das NULL-Muster prüfen, indem Sie spezifisch nach dem `null`-Wert sehen.</span><span class="sxs-lookup"><span data-stu-id="10dd6-120">You can test a variable for the null pattern by checking specifically for the `null` value.</span></span> <span data-ttu-id="10dd6-121">Wenn der Laufzeitwert der Variable `null` ist, gibt eine `is`-Anweisung, die nach einem Typ prüft, immer `false` zurück.</span><span class="sxs-lookup"><span data-stu-id="10dd6-121">When the runtime value of the variable is `null`, an `is` statement checking for a type always returns `false`.</span></span> <span data-ttu-id="10dd6-122">Die `is`-Anweisung für den Musterabgleich lässt keinen Nullable-Typ für den Wert zu, z.B. `int?` oder `Nullable<int>`, jedoch können Sie nach jedem anderen Werttyp prüfen.</span><span class="sxs-lookup"><span data-stu-id="10dd6-122">The pattern matching `is` statement doesn't allow a nullable value type, such as `int?` or `Nullable<int>`, but you can test for any other value type.</span></span> <span data-ttu-id="10dd6-123">Die `is`-Muster aus dem vorherigen Beispiel sind nicht auf die Nullable-Werttypen beschränkt.</span><span class="sxs-lookup"><span data-stu-id="10dd6-123">The `is` patterns from the preceding example are not limited to the nullable value types.</span></span> <span data-ttu-id="10dd6-124">Sie können diese Muster auch verwenden, um zu testen, ob eine Variable eines Verweistyps über einen Wert oder verfügt oder `null` ist.</span><span class="sxs-lookup"><span data-stu-id="10dd6-124">You also can use those patterns to test if a variable of a reference type has a value or it's `null`.</span></span>

<span data-ttu-id="10dd6-125">Im vorhergehenden Beispiel wird auch veranschaulicht, wie Sie den `is`-Ausdruck für den Musterabgleich in einer `switch`-Anweisung verwenden, in der die Variable einen von vielen verschiedenen Typen aufweisen kann.</span><span class="sxs-lookup"><span data-stu-id="10dd6-125">The preceding sample also shows how you use the pattern matching `is` expression in a `switch` statement where the variable may be one of many different types.</span></span>

<span data-ttu-id="10dd6-126">Wenn Sie testen möchten, ob eine Variable einen bestimmten Typ aufweist, Sie aber keine neue Variable zuweisen möchten, können Sie die Operatoren `is` und `as` für Verweistypen und Nullable-Typen verwenden.</span><span class="sxs-lookup"><span data-stu-id="10dd6-126">If you want to test if a variable is a given type, but not assign it to a new variable, you can use the `is` and `as` operators for reference types and nullable types.</span></span> <span data-ttu-id="10dd6-127">Im folgenden Code wird veranschaulicht, wie Sie die Anweisungen `is` und `as` verwenden, die Teil der C#-Sprache waren, bevor der Musterabgleich eingeführt wurde, um zu überprüfen, ob eine Variable einen bestimmten Typ aufweist:</span><span class="sxs-lookup"><span data-stu-id="10dd6-127">The following code shows how to use the `is` and `as` statements that were part of the C# language before pattern matching was introduced to test if a variable is of a given type:</span></span>

[!code-csharp[testing variable types with the is and as statements](../../../samples/snippets/csharp/how-to/safelycast/asandis/Program.cs#IsAndAs)]

<span data-ttu-id="10dd6-128">Wie Sie durch Vergleichen dieses Codes mit dem Code für den Musterabgleich sehen können, stellt die Syntax für den Musterabgleich robustere Features bereit, indem der Test und die Zuweisung in einer einzelnen Anweisung kombiniert werden.</span><span class="sxs-lookup"><span data-stu-id="10dd6-128">As you can see by comparing this code with the pattern matching code, the pattern matching syntax provides more robust features by combining the test and the assignment in a single statement.</span></span> <span data-ttu-id="10dd6-129">Verwenden Sie nach Möglichkeit die Syntax für den Musterabgleich.</span><span class="sxs-lookup"><span data-stu-id="10dd6-129">Use the pattern matching syntax whenever possible.</span></span>

<span data-ttu-id="10dd6-130">Sie können diese Beispiele ausprobieren, indem Sie sich den Code in unserem [GitHub-Repository](https://github.com/dotnet/samples/tree/master/snippets/csharp/how-to/safelycast) ansehen.</span><span class="sxs-lookup"><span data-stu-id="10dd6-130">You can try these samples by looking at the code in our [GitHub repository](https://github.com/dotnet/samples/tree/master/snippets/csharp/how-to/safelycast).</span></span> <span data-ttu-id="10dd6-131">Alternativ dazu können Sie die Beispiele [als ZIP-Datei](https://github.com/dotnet/samples/raw/master/snippets/csharp/how-to/safelycast.zip) herunterladen.</span><span class="sxs-lookup"><span data-stu-id="10dd6-131">Or you can download the samples [as a zip file](https://github.com/dotnet/samples/raw/master/snippets/csharp/how-to/safelycast.zip).</span></span>
