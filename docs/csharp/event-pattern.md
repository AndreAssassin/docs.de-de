---
title: Standardereignismuster in .NET
description: Erfahren Sie etwas über Ereignismuster in .NET und wie Sie standardmäßige Ereignisquellen erstellen und Standardereignisse in Ihrem Code abonnieren und verarbeiten können.
ms.date: 06/20/2016
ms.technology: csharp-fundamentals
ms.assetid: 8a3133d6-4ef2-46f9-9c8d-a8ea8898e4c9
ms.openlocfilehash: dec516767e43a6bf4edfa555e34f3adcc21a46e3
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 03/14/2020
ms.locfileid: "79146140"
---
# <a name="standard-net-event-patterns"></a><span data-ttu-id="ee5d0-103">Standardereignismuster in .NET</span><span class="sxs-lookup"><span data-stu-id="ee5d0-103">Standard .NET event patterns</span></span>

[<span data-ttu-id="ee5d0-104">Vorherige</span><span class="sxs-lookup"><span data-stu-id="ee5d0-104">Previous</span></span>](events-overview.md)

<span data-ttu-id="ee5d0-105">.NET-Ereignisse folgen in der Regel einigen bekannten Mustern.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-105">.NET events generally follow a few known patterns.</span></span> <span data-ttu-id="ee5d0-106">Standardisierung auf diese Muster bedeutet, dass Entwickler Kenntnisse über diese Standardmuster nutzen können, die auf ein beliebiges .NET Ereignisprogramm angewendet werden können.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-106">Standardizing on these patterns means that developers can leverage knowledge of those standard patterns, which can be applied to any .NET event program.</span></span>

<span data-ttu-id="ee5d0-107">Schauen wir uns diese Standardmuster an, sodass Sie über alle Kenntnisse verfügen, die Sie benötigen, um Standardereignisquellen zu erstellen und Standardereignisse in Ihrem Code zu abonnieren und zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-107">Let's go through these standard patterns so you will have all the knowledge you need to create standard event sources, and subscribe and process standard events in your code.</span></span>

## <a name="event-delegate-signatures"></a><span data-ttu-id="ee5d0-108">Ereignisdelegatsignaturen</span><span class="sxs-lookup"><span data-stu-id="ee5d0-108">Event Delegate Signatures</span></span>

<span data-ttu-id="ee5d0-109">Die Standardsignatur für ein .NET-Ereignisdelegat lautet:</span><span class="sxs-lookup"><span data-stu-id="ee5d0-109">The standard signature for a .NET event delegate is:</span></span>

```csharp
void OnEventRaised(object sender, EventArgs args);
```

<span data-ttu-id="ee5d0-110">Der Rückgabetyp ist void.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-110">The return type is void.</span></span> <span data-ttu-id="ee5d0-111">Ereignisse basieren auf Delegaten und sind Multicastdelegaten.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-111">Events are based on delegates and are multicast delegates.</span></span> <span data-ttu-id="ee5d0-112">Dies unterstützt mehrere Abonnenten für jede Ereignisquelle.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-112">That supports multiple subscribers for any event source.</span></span> <span data-ttu-id="ee5d0-113">Der einzelne Rückgabewert einer Methode wird nicht auf mehrere Ereignisabonnenten skaliert.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-113">The single return value from a method doesn't scale to multiple event subscribers.</span></span> <span data-ttu-id="ee5d0-114">Welchen Rückgabewert findet die Ereignisquelle nach dem Auslösen eines Ereignisses vor?</span><span class="sxs-lookup"><span data-stu-id="ee5d0-114">Which return value does the event source see after raising an event?</span></span> <span data-ttu-id="ee5d0-115">In diesem Artikel sehen Sie später, wie Sie Ereignisprotokolle zur Unterstützung der Ereignisabonnenten, die Informationen an die Ereignisquelle senden, erstellen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-115">Later in this article you'll see how to create event protocols that support event subscribers that report information to the event source.</span></span>

<span data-ttu-id="ee5d0-116">Die Argumentliste enthält zwei Argumente: Den Absender und die Ereignisargumente.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-116">The argument list contains two arguments: the sender, and the event arguments.</span></span> <span data-ttu-id="ee5d0-117">Der Kompilierzeittyp von `sender` ist `System.Object`, obwohl Sie wahrscheinlich einen stärker abgeleiteten Typ kennen, die immer korrekt wäre.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-117">The compile time type of `sender` is `System.Object`, even though you likely know a more derived type that would always be correct.</span></span> <span data-ttu-id="ee5d0-118">Verwenden Sie gemäß der Konvention `object`.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-118">By convention, use `object`.</span></span>

<span data-ttu-id="ee5d0-119">Das zweite Argument ist in der Regel ein Typ, der von `System.EventArgs` abgeleitet ist.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-119">The second argument has typically been a type that is derived from `System.EventArgs`.</span></span> <span data-ttu-id="ee5d0-120">(Im [nächsten Abschnitt](modern-events.md) werden Sie sehen, dass diese Konvention nicht mehr erzwungen wird.) Wenn der Ereignistyp keine zusätzlichen Argumente benötigt, werden Sie dennoch beide Argumente bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-120">(You'll see in the [next section](modern-events.md) that this convention is no longer enforced.) If your event type does not need any additional arguments, you will still provide both arguments.</span></span>
<span data-ttu-id="ee5d0-121">Es gibt einen speziellen Wert, `EventArgs.Empty`, den Sie verwenden sollten, um anzugeben, dass Ihr Ereignis keine weiteren Informationen enthält.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-121">There is a special value, `EventArgs.Empty` that you should use to denote that your event does not contain any additional information.</span></span>

<span data-ttu-id="ee5d0-122">Erstellen Sie eine Klasse, die Dateien in einem Verzeichnis oder einem seiner Unterverzeichnisse, die einem Muster folgen, auflistet.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-122">Let's build a class that lists files in a directory, or any of its subdirectories that follow a pattern.</span></span> <span data-ttu-id="ee5d0-123">Diese Komponente löst ein Ereignis für jede gefundene Datei aus, die mit dem Muster übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-123">This component raises an event for each file found that matches the pattern.</span></span>

<span data-ttu-id="ee5d0-124">Ein Ereignismodell bietet einige Vorteile beim Entwurf.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-124">Using an event model provides some design advantages.</span></span> <span data-ttu-id="ee5d0-125">Sie können mehrere Ereignislistener erstellen, die verschiedene Aktionen ausführen, wenn eine gesuchte Datei gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-125">You can create multiple event listeners that perform different actions when a sought file is found.</span></span> <span data-ttu-id="ee5d0-126">Das Kombinieren der verschiedenen Listener kann robustere Algorithmen erstellen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-126">Combining the different listeners can create more robust algorithms.</span></span>

<span data-ttu-id="ee5d0-127">Hier ist die erste Ereignisargumentdeklaration für die Suche nach einer gesuchten Datei:</span><span class="sxs-lookup"><span data-stu-id="ee5d0-127">Here is the initial event argument declaration for finding a sought file:</span></span>

[!code-csharp[EventArgs](../../samples/snippets/csharp/events/Program.cs#EventArgsV1 "Define event arguments")]

<span data-ttu-id="ee5d0-128">Obwohl dieser Typ wie ein kleiner, Nur-Daten-Typ aussieht, sollten Sie die Konvention einhalten und ihm einen Verweis (`class`)-Typ geben.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-128">Even though this type looks like a small, data-only type, you should follow the convention and make it a reference (`class`) type.</span></span> <span data-ttu-id="ee5d0-129">Dies bedeutet, dass das Argumentobjekt als Verweis übergeben wird, und alle Updates der Daten von allen Abonnenten gesehen werden.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-129">That means the argument object will be passed by reference, and any updates to the data will be viewed by all subscribers.</span></span> <span data-ttu-id="ee5d0-130">Die erste Version ist ein unveränderliches Objekt.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-130">The first version is an immutable object.</span></span> <span data-ttu-id="ee5d0-131">Sie sollten die Eigenschaften im Ereignisargumenttyp auf unveränderlich einstellen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-131">You should prefer to make the properties in your event argument type immutable.</span></span> <span data-ttu-id="ee5d0-132">Auf diese Weise kann ein Abonnent die Werte nicht ändern, bevor ein anderer Abonnent sie sieht.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-132">That way, one subscriber cannot change the values before another subscriber sees them.</span></span> <span data-ttu-id="ee5d0-133">(Es gibt Ausnahmen dafür, wie Sie unten sehen werden.)</span><span class="sxs-lookup"><span data-stu-id="ee5d0-133">(There are exceptions to this, as you'll see below.)</span></span>  

<span data-ttu-id="ee5d0-134">Als Nächstes müssen wir die Ereignisdeklaration in der FileSearcher-Klasse erstellen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-134">Next, we need to create the event declaration in the FileSearcher class.</span></span> <span data-ttu-id="ee5d0-135">Die Nutzung des `EventHandler<T>`-Typ bedeutet, dass Sie nicht noch eine Typdefinition erstellen müssen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-135">Leveraging the `EventHandler<T>` type means that you don't need to create yet another type definition.</span></span> <span data-ttu-id="ee5d0-136">Sie verwenden einfach eine generische Spezialisierung.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-136">You simply use a generic specialization.</span></span>

<span data-ttu-id="ee5d0-137">Füllen wir die FileSearcher-Klasse aus, um nach Dateien mit dem Muster zu suchen und das richtige Ereignis auszulösen, wenn eine Übereinstimmung gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-137">Let's fill out the FileSearcher class to search for files that match a pattern, and raise the correct event when a match is discovered.</span></span>

[!code-csharp[FileSearcher](../../samples/snippets/csharp/events/Program.cs#FileSearcherV1 "Create the initial file searcher")]

## <a name="defining-and-raising-field-like-events"></a><span data-ttu-id="ee5d0-138">Definieren und Auslösen von feldähnlichen Ereignissen</span><span class="sxs-lookup"><span data-stu-id="ee5d0-138">Defining and Raising Field-Like Events</span></span>

<span data-ttu-id="ee5d0-139">Die einfachste Möglichkeit, Ihrer Klasse ein Ereignis hinzuzufügen, ist das Deklarieren des Ereignisses als öffentliches Feld, wie im vorherigen Beispiel:</span><span class="sxs-lookup"><span data-stu-id="ee5d0-139">The simplest way to add an event to your class is to declare that event as a public field, as in the preceding example:</span></span>

[!code-csharp[DeclareEvent](../../samples/snippets/csharp/events/Program.cs#DeclareEvent "Declare the file found event")]

<span data-ttu-id="ee5d0-140">Dies scheint ein öffentliches Feld zu deklarieren, was als schlechte objektorientierte Vorgehensweise erscheinen würde.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-140">This looks like it's declaring a public field, which would appear to be bad object-oriented practice.</span></span> <span data-ttu-id="ee5d0-141">Sie möchten den Datenzugriff über Eigenschaften oder Methoden schützen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-141">You want to protect data access through properties, or methods.</span></span> <span data-ttu-id="ee5d0-142">Während dies anscheinend kein empfehlenswertes Verfahren ist, erstellt der vom Compiler generierte Code Wrapper, damit auf die Ereignisobjekte nur auf sichere Weise zugegriffen werden kann.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-142">While this may look like a bad practice, the code generated by the compiler does create wrappers so that the event objects can only be accessed in safe ways.</span></span> <span data-ttu-id="ee5d0-143">Die einzig verfügbaren Vorgänge für ein feldähnliches Ereignis sind das Hinzufügen von Handlern:</span><span class="sxs-lookup"><span data-stu-id="ee5d0-143">The only operations available on a field-like event are add handler:</span></span>

[!code-csharp[DeclareEventHandler](../../samples/snippets/csharp/events/Program.cs#DeclareEventHandler "Declare the file found event handler")]

<span data-ttu-id="ee5d0-144">und das Entfernen von Handlern:</span><span class="sxs-lookup"><span data-stu-id="ee5d0-144">and remove handler:</span></span>

[!code-csharp[RemoveEventHandler](../../samples/snippets/csharp/events/Program.cs#RemoveHandler "Remove the event handler")]

<span data-ttu-id="ee5d0-145">Beachten Sie, dass eine lokale Variable für den Handler vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-145">Note that there's a local variable for the handler.</span></span> <span data-ttu-id="ee5d0-146">Wenn Sie den Text des Lambda-Ausdrucks verwenden, würde das Entfernen nicht ordnungsgemäß funktionieren.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-146">If you used the body of the lambda, the remove would not work correctly.</span></span> <span data-ttu-id="ee5d0-147">Es wäre eine andere Instanz des Delegaten, und es würde stillschweigend nichts geschehen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-147">It would be a different instance of the delegate, and silently do nothing.</span></span>

<span data-ttu-id="ee5d0-148">Code außerhalb der Klasse kann das Ereignis nicht auslösen, noch kann er andere Vorgänge ausführen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-148">Code outside the class cannot raise the event, nor can it perform any other operations.</span></span>

## <a name="returning-values-from-event-subscribers"></a><span data-ttu-id="ee5d0-149">Rückgabe von Werten aus Ereignisabonnenten</span><span class="sxs-lookup"><span data-stu-id="ee5d0-149">Returning Values from Event Subscribers</span></span>

<span data-ttu-id="ee5d0-150">Ihre einfache Version funktioniert einwandfrei.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-150">Your simple version is working fine.</span></span> <span data-ttu-id="ee5d0-151">Fügen wir eine weitere Funktion hinzu: Abbruch.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-151">Let's add another feature: Cancellation.</span></span>

<span data-ttu-id="ee5d0-152">Beim Auslösen des gefunden Ereignisses sollten Listener die weitere Verarbeitung beenden können, wenn diese Datei die letzte gesuchte Datei ist.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-152">When you raise the found event, listeners should be able to stop further processing, if this file is that last one sought.</span></span>

<span data-ttu-id="ee5d0-153">Die Ereignishandler geben keinen Wert zurück. Daher müssen Sie dies auf andere Weise kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-153">The event handlers do not return a value, so you need to communicate that in another way.</span></span> <span data-ttu-id="ee5d0-154">Das Standardereignismuster verwendet das EventArgs-Objekt, um Felder einzuschließen, die Ereignisabonnenten zum Kommunizieren von „Abbrechen“ verwenden.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-154">The standard event pattern uses the EventArgs object to include fields that event subscribers can use to communicate cancel.</span></span>

<span data-ttu-id="ee5d0-155">Es gibt zwei unterschiedliche Muster, die verwendet werden können, auf der Grundlage der Semantik des Vertrags „Abbrechen“.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-155">There are two different patterns that could be used, based on the semantics of the Cancel contract.</span></span> <span data-ttu-id="ee5d0-156">In beiden Fällen werden Sie ein boolesches Feld zum EventArguments für das gefundene Dateiereignis hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-156">In both cases, you'll add a boolean field to the EventArguments for the found file event.</span></span>

<span data-ttu-id="ee5d0-157">Ein Muster ermöglicht jedem Abonnenten, den Vorgang abzubrechen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-157">One pattern would allow any one subscriber to cancel the operation.</span></span>
<span data-ttu-id="ee5d0-158">Für dieses Muster wird ein neues Feld mit `false` initialisiert.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-158">For this pattern, the new field is initialized to `false`.</span></span> <span data-ttu-id="ee5d0-159">Jeder Abonnent kann es in `true` ändern.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-159">Any subscriber can change it to `true`.</span></span> <span data-ttu-id="ee5d0-160">Nachdem alle Abonnenten das ausgelöste Ereignis gesehen haben, untersucht die Komponente FileSearcher den booleschen Wert und ergreift Maßnahmen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-160">After all subscribers have seen the event raised, the FileSearcher component examines the boolean value and takes action.</span></span>

<span data-ttu-id="ee5d0-161">Das zweite Muster würde nur den Vorgang abbrechen, wenn alle Abonnenten den Vorgang abgebrochen haben möchten.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-161">The second pattern would only cancel the operation if all subscribers wanted the operation cancelled.</span></span> <span data-ttu-id="ee5d0-162">In diesem Muster wird das neue Feld initialisiert, um anzugeben, dass der Vorgang abgebrochen werden soll, und jeder Abonnent kann dies ändern, um anzugeben, dass der Vorgang fortgesetzt werden soll.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-162">In this pattern, the new field is initialized to indicate the operation should cancel, and any subscriber could change it to indicate the operation should continue.</span></span>
<span data-ttu-id="ee5d0-163">Nachdem alle Abonnenten das ausgelöste Ereignis gesehen haben, untersucht die Komponente FileSearcher den booleschen Wert und ergreift Maßnahmen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-163">After all subscribers have seen the event raised, the FileSearcher component examines the boolean and takes action.</span></span> <span data-ttu-id="ee5d0-164">Es gibt einen zusätzlichen Schritt in diesem Muster: Die Komponente muss wissen, ob jeder Abonnent das Ereignis gesehen hat.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-164">There is one extra step in this pattern: the component needs to know if any subscribers have seen the event.</span></span> <span data-ttu-id="ee5d0-165">Wenn keine Abonnenten vorhanden sind, würde das Feld fälschlicherweise einen Abbruch angeben.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-165">If there are no subscribers, the field would indicate a cancel incorrectly.</span></span>

<span data-ttu-id="ee5d0-166">Implementieren wir die erste Version für dieses Beispiel.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-166">Let's implement the first version for this sample.</span></span> <span data-ttu-id="ee5d0-167">Sie müssen ein boolesches Feld mit dem Namen `CancelRequested` dem `FileFoundArgs`-Typ hinzufügen:</span><span class="sxs-lookup"><span data-stu-id="ee5d0-167">You need to add a boolean field named `CancelRequested` to the `FileFoundArgs` type:</span></span>

[!code-csharp[EventArgs](../../samples/snippets/csharp/events/Program.cs#EventArgs "Update event arguments")]

<span data-ttu-id="ee5d0-168">Dieses neue Feld wird automatisch mit `false` initialisiert, dem Standardwert für ein boolesches Feld, damit Sie nicht versehentlich abbrechen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-168">This new Field is automatically initialized to `false`, the default value for a Boolean field, so you don't cancel accidentally.</span></span> <span data-ttu-id="ee5d0-169">Die einzige andere Änderung der Komponente ist das Überprüfen des Flag nach dem Auslösen des Ereignisses, um festzustellen, ob einer der Abonnenten einen Abbruch angefordert hat:</span><span class="sxs-lookup"><span data-stu-id="ee5d0-169">The only other change to the component is to check the flag after raising the event to see if any of the subscribers have requested a cancellation:</span></span>

```csharp
public void List(string directory, string searchPattern)
{
    foreach (var file in Directory.EnumerateFiles(directory, searchPattern))
    {
        var args = new FileFoundArgs(file);
        FileFound?.Invoke(this, args);
        if (args.CancelRequested)
            break;
    }
}
```

<span data-ttu-id="ee5d0-170">Ein Vorteil dieses Musters ist, dass es keine unterbrechende Änderung ist.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-170">One advantage of this pattern is that it isn't a breaking change.</span></span>
<span data-ttu-id="ee5d0-171">Keiner der Abonnenten hat vorher einen Abbruch angefordert und macht es noch immer nicht.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-171">None of the subscribers requested a cancellation before, and they still are not.</span></span> <span data-ttu-id="ee5d0-172">Kein Teil des Abonnentencodes benötigt eine Aktualisierung, sofern sie das neue Abbrechen-Protokoll nicht unterstützen möchten.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-172">None of the subscriber code needs updating unless they want to support the new cancel protocol.</span></span> <span data-ttu-id="ee5d0-173">Es ist sehr lose gekoppelt.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-173">It's very loosely coupled.</span></span>

<span data-ttu-id="ee5d0-174">Aktualisieren wir den Abonnenten, damit ein Abbruch angefordert wird, sobald die erste ausführbare Datei gefunden wird:</span><span class="sxs-lookup"><span data-stu-id="ee5d0-174">Let's update the subscriber so that it requests a cancellation once it finds the first executable:</span></span>

```csharp
EventHandler<FileFoundArgs> onFileFound = (sender, eventArgs) =>
{
    Console.WriteLine(eventArgs.FoundFile);
    eventArgs.CancelRequested = true;
};
```

## <a name="adding-another-event-declaration"></a><span data-ttu-id="ee5d0-175">Hinzufügen einer anderen Ereignisdeklaration</span><span class="sxs-lookup"><span data-stu-id="ee5d0-175">Adding Another Event Declaration</span></span>

<span data-ttu-id="ee5d0-176">Fügen wir eine weitere Funktion hinzu, und zeigen andere Sprachausdrücke für Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-176">Let's add one more feature, and demonstrate other language idioms for events.</span></span> <span data-ttu-id="ee5d0-177">Fügen wir eine Überladung der `Search`-Methode, die alle Unterverzeichnisse auf der Suche nach Dateien durchsucht.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-177">Let's add an overload of the `Search` method that traverses all subdirectories in search of files.</span></span>

<span data-ttu-id="ee5d0-178">In einem Verzeichnis mit vielen Unterverzeichnisse könnte dies ein längerer Vorgang werden.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-178">This could get to be a lengthy operation in a directory with many sub-directories.</span></span> <span data-ttu-id="ee5d0-179">Fügen wir ein Ereignis hinzu, das zu Beginn jeder neuen Verzeichnissuche ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-179">Let's add an event that gets raised when each new directory search begins.</span></span> <span data-ttu-id="ee5d0-180">Dies ermöglicht es Abonnenten, den Fortschritt zu verfolgen und den Benutzer während des Fortschritts zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-180">This enables subscribers to track progress, and update the user as to progress.</span></span> <span data-ttu-id="ee5d0-181">Die Beispiele, die Sie bisher erstellt haben, sind öffentlich.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-181">All the samples you've created so far are public.</span></span> <span data-ttu-id="ee5d0-182">Dieses erstellen wir als internes Ereignis.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-182">Let's make this one an internal event.</span></span> <span data-ttu-id="ee5d0-183">Das bedeutet, dass Sie auch die Typen für die Argumente intern erstellen können.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-183">That means you can also make the types used for the arguments internal as well.</span></span>

<span data-ttu-id="ee5d0-184">Sie beginnen mit dem Erstellen der neuen abgeleiteten EventArgs-Klasse für die Berichte des neuen Verzeichnisses und Status.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-184">You'll start by creating the new EventArgs derived class for reporting the new directory and progress.</span></span>

[!code-csharp[DirEventArgs](../../samples/snippets/csharp/events/Program.cs#SearchDirEventArgs "Define search directory event arguments")]

<span data-ttu-id="ee5d0-185">In diesem Fall können Sie erneut der Empfehlung für das Erstellen eines nicht änderbaren Verweistyps für die Ereignisargumente folgen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-185">Again, you can follow the recommendations to make an immutable reference type for the event arguments.</span></span>

<span data-ttu-id="ee5d0-186">Definieren Sie als Nächstes das Ereignis.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-186">Next, define the event.</span></span> <span data-ttu-id="ee5d0-187">Dieses Mal werden Sie eine andere Syntax verwenden.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-187">This time, you'll use a different syntax.</span></span> <span data-ttu-id="ee5d0-188">Zusätzlich zur Verwendung der Feldsyntax, können Sie die Eigenschaft explizit erstellen, mit dem Hinzufügen- und Entfernen-Handler.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-188">In addition to using the field syntax, you can explicitly create the property, with add and remove handlers.</span></span> <span data-ttu-id="ee5d0-189">In diesem Beispiel werden Sie für diese Handler keinen zusätzlichen Code benötigen, aber dies zeigt, wie Sie sie erstellen würden.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-189">In this sample, you won't need extra code in those handlers, but this shows how you would create them.</span></span>

[!code-csharp[Declare event with add and remove handlers](../../samples/snippets/csharp/events/Program.cs#DeclareSearchEvent "Declare the event with add and remove handlers")]

<span data-ttu-id="ee5d0-190">In vielerlei Hinsicht spiegelt der Code, den Sie hier schreiben, den vom Compiler generierten Code für die Feldereignisdefinitionen wider, die Sie zuvor gesehen haben.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-190">In many ways, the code you write here mirrors the code the compiler generates for the field event definitions you've seen earlier.</span></span> <span data-ttu-id="ee5d0-191">Sie erstellen das Ereignis mithilfe der Syntax ähnlich der für [Eigenschaften](properties.md).</span><span class="sxs-lookup"><span data-stu-id="ee5d0-191">You create the event using syntax very similar to that used for [properties](properties.md).</span></span> <span data-ttu-id="ee5d0-192">Beachten Sie, dass die Handler unterschiedliche Namen haben: `add` und `remove`.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-192">Notice that the handlers have different names: `add` and `remove`.</span></span> <span data-ttu-id="ee5d0-193">Diese werden aufgerufen, um das Ereignis zu abonnieren oder sich vom Ereignis abzumelden.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-193">These are called to subscribe to the event, or unsubscribe from the event.</span></span> <span data-ttu-id="ee5d0-194">Beachten Sie, dass Sie auch ein privates Unterstützungsfeld zum Speichern der Ereignisvariable deklarieren müssen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-194">Notice that you also must declare a private backing field to store the event variable.</span></span> <span data-ttu-id="ee5d0-195">Es wird mit NULL initialisiert.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-195">It is initialized to null.</span></span>

<span data-ttu-id="ee5d0-196">Als Nächstes fügen wir die Überladung der `Search`-Methode hinzu, die Unterverzeichnisse durchsucht und beide Ereignisse auslöst.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-196">Next, let's add the overload of the `Search` method that traverses subdirectories and raises both events.</span></span> <span data-ttu-id="ee5d0-197">Die einfachste Möglichkeit besteht darin, ein Standardargument zu verwenden, um anzugeben, dass alle Verzeichnisse durchsucht werden sollen:</span><span class="sxs-lookup"><span data-stu-id="ee5d0-197">The easiest way to accomplish this is to use a default argument to specify that you want to search all directories:</span></span>

[!code-csharp[SearchImplementation](../../samples/snippets/csharp/events/Program.cs#FinalImplementation "Implementation to search directories")]

<span data-ttu-id="ee5d0-198">An diesem Punkt können Sie die Anwendung durch das Aufrufen der Überladung für die Suche aller Unterverzeichnisse ausführen.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-198">At this point, you can run the application calling the overload for searching all sub-directories.</span></span> <span data-ttu-id="ee5d0-199">Es sind keine Abonnenten auf dem neuen `ChangeDirectory`-Ereignis vorhanden, aber mit den `?.Invoke()`-Ausdruck wird sichergestellt, dass es ordnungsgemäß funktioniert.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-199">There are no subscribers on the new `ChangeDirectory` event, but using the `?.Invoke()` idiom ensures that this works correctly.</span></span>

 <span data-ttu-id="ee5d0-200">Fügen wir einen Handler hinzu, um eine Zeile zu schreiben, die den Status im Konsolenfenster anzeigt.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-200">Let's add a handler to write a line that shows the progress in the console window.</span></span>

[!code-csharp[Search](../../samples/snippets/csharp/events/Program.cs#Search "Declare event handler")]

<span data-ttu-id="ee5d0-201">Sie haben Muster gesehen, die im .NET-Ökosystem eingehalten werden.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-201">You've seen patterns that are followed throughout the .NET ecosystem.</span></span>
<span data-ttu-id="ee5d0-202">Indem Sie diese Muster und Konventionen erlernen, werden Sie schnell idiomatische C# und .NET schreiben können.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-202">By learning these patterns and conventions, you'll be writing idiomatic C# and .NET quickly.</span></span>

<span data-ttu-id="ee5d0-203">Als Nächstes sehen Sie einige Änderungen in diesen Mustern in der neuesten Version von .NET.</span><span class="sxs-lookup"><span data-stu-id="ee5d0-203">Next, you'll see some changes in these patterns in the most recent release of .NET.</span></span>

[<span data-ttu-id="ee5d0-204">Nächste</span><span class="sxs-lookup"><span data-stu-id="ee5d0-204">Next</span></span>](modern-events.md)
