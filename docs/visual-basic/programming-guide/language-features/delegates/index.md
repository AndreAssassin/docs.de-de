---
title: Delegaten
ms.date: 07/20/2015
helpviewer_keywords:
- delegates [Visual Basic]
- Visual Basic code, delegates
ms.assetid: 410b60dc-5e60-4ec0-bfae-426755a2ee28
ms.openlocfilehash: 15b4cb0a038429c5fe67d3e013818a7a2170abcc
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/22/2019
ms.locfileid: "74345238"
---
# <a name="delegates-visual-basic"></a><span data-ttu-id="a0011-102">Delegaten (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="a0011-102">Delegates (Visual Basic)</span></span>

<span data-ttu-id="a0011-103">Delegaten sind Objekte, die auf Methoden verweisen.</span><span class="sxs-lookup"><span data-stu-id="a0011-103">Delegates are objects that refer to methods.</span></span> <span data-ttu-id="a0011-104">Sie werden zuweilen als *typsichere Funktionszeiger* beschrieben, da sie in anderen Programmiersprachen verwendeten Funktionszeigern ähneln.</span><span class="sxs-lookup"><span data-stu-id="a0011-104">They are sometimes described as *type-safe function pointers* because they are similar to function pointers used in other programming languages.</span></span> <span data-ttu-id="a0011-105">But unlike function pointers, Visual Basic delegates are a reference type based on the class <xref:System.Delegate?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="a0011-105">But unlike function pointers, Visual Basic delegates are a reference type based on the class <xref:System.Delegate?displayProperty=nameWithType>.</span></span> <span data-ttu-id="a0011-106">Delegaten können sowohl auf freigegebene Methoden – Methoden, die ohne eine bestimmte Instanz einer Klasse aufgerufen werden können – als auch Instanzmethoden verweisen.</span><span class="sxs-lookup"><span data-stu-id="a0011-106">Delegates can reference both shared methods — methods that can be called without a specific instance of a class — and instance methods.</span></span>

## <a name="delegates-and-events"></a><span data-ttu-id="a0011-107">Delegaten und Ereignisse</span><span class="sxs-lookup"><span data-stu-id="a0011-107">Delegates and Events</span></span>

<span data-ttu-id="a0011-108">Delegaten sind in Situationen hilfreich, in denen Sie einen Mittler zwischen einer aufrufenden Prozedur und der aufgerufenen Prozedur benötigen.</span><span class="sxs-lookup"><span data-stu-id="a0011-108">Delegates are useful in situations where you need an intermediary between a calling procedure and the procedure being called.</span></span> <span data-ttu-id="a0011-109">Ein Beispiel: Sie möchten, dass ein Objekt, das Ereignisse auslöst, unter verschiedenen Bedingungen verschiedene Ereignishandler aufrufen kann.</span><span class="sxs-lookup"><span data-stu-id="a0011-109">For example, you might want an object that raises events to be able to call different event handlers under different circumstances.</span></span> <span data-ttu-id="a0011-110">Leider ist dem Objekt, das die Ereignisse auslöst, nicht im Voraus bekannt, welcher Ereignishandler ein bestimmtes Ereignis verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="a0011-110">Unfortunately, the object raising the events cannot know ahead of time which event handler is handling a specific event.</span></span> <span data-ttu-id="a0011-111">Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the `AddHandler` statement.</span><span class="sxs-lookup"><span data-stu-id="a0011-111">Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the `AddHandler` statement.</span></span> <span data-ttu-id="a0011-112">Zur Laufzeit leitet der Delegat dann Aufrufe an den entsprechenden Ereignishandler weiter.</span><span class="sxs-lookup"><span data-stu-id="a0011-112">At run time, the delegate forwards calls to the appropriate event handler.</span></span>

<span data-ttu-id="a0011-113">Although you can create your own delegates, in most cases Visual Basic creates the delegate and takes care of the details for you.</span><span class="sxs-lookup"><span data-stu-id="a0011-113">Although you can create your own delegates, in most cases Visual Basic creates the delegate and takes care of the details for you.</span></span> <span data-ttu-id="a0011-114">Eine `Event`-Anweisung definiert z.B. implizit eine Delegatklasse mit dem Namen `<EventName>EventHandler` als geschachtelte Klasse der Klasse, die die `Event`-Anweisung enthält, und mit der gleichen Signatur wie das Ereignis.</span><span class="sxs-lookup"><span data-stu-id="a0011-114">For example, an `Event` statement implicitly defines a delegate class named `<EventName>EventHandler` as a nested class of the class containing the `Event` statement, and with the same signature as the event.</span></span> <span data-ttu-id="a0011-115">Die `AddressOf`-Anweisung erstellt implizit eine Instanz eines Delegaten, die auf eine bestimmte Prozedur verweist.</span><span class="sxs-lookup"><span data-stu-id="a0011-115">The `AddressOf` statement implicitly creates an instance of a delegate that refers to a specific procedure.</span></span> <span data-ttu-id="a0011-116">Die folgenden beiden Codezeilen sind gleichwertig.</span><span class="sxs-lookup"><span data-stu-id="a0011-116">The following two lines of code are equivalent.</span></span> <span data-ttu-id="a0011-117">In der ersten Zeile sehen Sie die explizite Erstellung einer Instanz von `EventHandler` mit einem Verweis auf die `Button1_Click`-Methode, die als Argument gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="a0011-117">In the first line, you see the explicit creation of an instance of `EventHandler`, with a reference to method `Button1_Click` sent as the argument.</span></span> <span data-ttu-id="a0011-118">Die zweite Zeile ist eine praktischere Möglichkeit, das Gleiche auszuführen.</span><span class="sxs-lookup"><span data-stu-id="a0011-118">The second line is a more convenient way to do the same thing.</span></span>

[!code-vb[VbVbalrDelegates#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#6)]

<span data-ttu-id="a0011-119">Die schnelle Methode zum Erstellen von Delegaten können Sie immer dort verwenden, wo der Compiler den Delegattyp anhand des Kontexts bestimmen kann.</span><span class="sxs-lookup"><span data-stu-id="a0011-119">You can use the shorthand way of creating delegates anywhere the compiler can determine the delegate's type by the context.</span></span>

## <a name="declaring-events-that-use-an-existing-delegate-type"></a><span data-ttu-id="a0011-120">Deklarieren von Ereignissen, die einen vorhandenen Delegattyp verwenden</span><span class="sxs-lookup"><span data-stu-id="a0011-120">Declaring Events that Use an Existing Delegate Type</span></span>

<span data-ttu-id="a0011-121">In manchen Situationen empfiehlt es sich, ein Ereignis so zu deklarieren, dass es einen vorhandenen Delegattyp als zugrunde liegenden Delegaten verwendet.</span><span class="sxs-lookup"><span data-stu-id="a0011-121">In some situations, you may want to declare an event to use an existing delegate type as its underlying delegate.</span></span> <span data-ttu-id="a0011-122">Die folgende Syntax veranschaulicht dies:</span><span class="sxs-lookup"><span data-stu-id="a0011-122">The following syntax demonstrates how:</span></span>

[!code-vb[VbVbalrDelegates#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#7)]

<span data-ttu-id="a0011-123">Dies ist nützlich, wenn mehrere Ereignisse an den gleichen Handler weitergeleitet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="a0011-123">This is useful when you want to route multiple events to the same handler.</span></span>

## <a name="delegate-variables-and-parameters"></a><span data-ttu-id="a0011-124">Delegatvariablen und -parameter</span><span class="sxs-lookup"><span data-stu-id="a0011-124">Delegate Variables and Parameters</span></span>

<span data-ttu-id="a0011-125">Sie können Delegaten für andere, nicht auf Ereignisse bezogene Tasks (z.B. freies Threading) oder für Prozeduren verwenden, die zur Laufzeit verschiedene Versionen von Funktionen aufrufen müssen.</span><span class="sxs-lookup"><span data-stu-id="a0011-125">You can use delegates for other, non-event related tasks, such as free threading or with procedures that need to call different versions of functions at run time.</span></span>

<span data-ttu-id="a0011-126">Ein Beispiel: Eine Anwendung für Gebrauchtwagen-Kleinanzeigen enthält ein Listenfeld mit den Namen von Fahrzeugen.</span><span class="sxs-lookup"><span data-stu-id="a0011-126">For example, suppose you have a classified-ad application that includes a list box with the names of cars.</span></span> <span data-ttu-id="a0011-127">Die Anzeigen sind nach Titel sortiert, wobei es sich in der Regel um die Marke handelt.</span><span class="sxs-lookup"><span data-stu-id="a0011-127">The ads are sorted by title, which is normally the make of the car.</span></span> <span data-ttu-id="a0011-128">Ein Problem kann dann auftreten, wenn bei einigen Autos das Baujahr vor der Marke steht.</span><span class="sxs-lookup"><span data-stu-id="a0011-128">A problem you may face occurs when some cars include the year of the car before the make.</span></span> <span data-ttu-id="a0011-129">Das Problem besteht darin, dass die integrierte Suchfunktion des Listenfelds nur nach Zeichencodes sortiert. Daher werden alle Anzeigen, die mit dem Jahr beginnen, an den Beginn der Liste sortiert, erst dann folgen die Anzeigen, die mit der Marke beginnen.</span><span class="sxs-lookup"><span data-stu-id="a0011-129">The problem is that the built-in sort functionality of the list box sorts only by character codes; it places all the ads starting with dates first, followed by the ads starting with the make.</span></span>

<span data-ttu-id="a0011-130">Um dies zu beheben, können Sie eine Sortierprozedur in einer Klasse erstellen, die in den meisten Listenfeldern die standardmäßige alphabetische Sortierung verwendet, jedoch zur Laufzeit auf die benutzerdefinierte Sortierung für Gebrauchtwagenanzeigen umgestellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="a0011-130">To fix this, you can create a sort procedure in a class that uses the standard alphabetic sort on most list boxes, but is able to switch at run time to the custom sort procedure for car ads.</span></span> <span data-ttu-id="a0011-131">Dafür übergeben Sie die benutzerdefinierte Sortierprozedur mithilfe von Delegaten zur Laufzeit an die Sortierklasse.</span><span class="sxs-lookup"><span data-stu-id="a0011-131">To do this, you pass the custom sort procedure to the sort class at run time, using delegates.</span></span>

## <a name="addressof-and-lambda-expressions"></a><span data-ttu-id="a0011-132">AddressOf- und Lambda-Ausdrücke</span><span class="sxs-lookup"><span data-stu-id="a0011-132">AddressOf and Lambda Expressions</span></span>

<span data-ttu-id="a0011-133">Jede Delegatklasse definiert einen Konstruktor, dem die Spezifikation einer Objektmethode übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="a0011-133">Each delegate class defines a constructor that is passed the specification of an object method.</span></span> <span data-ttu-id="a0011-134">Ein Argument für einen Delegatkonstruktor muss ein Verweis auf eine Methode oder ein Lambda-Ausdruck sein.</span><span class="sxs-lookup"><span data-stu-id="a0011-134">An argument to a delegate constructor must be a reference to a method, or a lambda expression.</span></span>

<span data-ttu-id="a0011-135">Verwenden Sie die folgende Syntax, um einen Verweis auf eine Methode festzulegen:</span><span class="sxs-lookup"><span data-stu-id="a0011-135">To specify a reference to a method, use the following syntax:</span></span>

<span data-ttu-id="a0011-136">`AddressOf` [`expression`.]`methodName`</span><span class="sxs-lookup"><span data-stu-id="a0011-136">`AddressOf` [`expression`.]`methodName`</span></span>

<span data-ttu-id="a0011-137">Der Typ von `expression` muss zur Kompilierungszeit der Name einer Klasse oder Schnittstelle sein, die eine Methode des angegebenen Namens enthält, deren Signatur mit der Signatur der Delegatklasse übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="a0011-137">The compile-time type of the `expression` must be the name of a class or an interface that contains a method of the specified name whose signature matches the signature of the delegate class.</span></span> <span data-ttu-id="a0011-138">Bei `methodName` kann es sich um eine freigegebene Methode oder um eine Instanzmethode handeln.</span><span class="sxs-lookup"><span data-stu-id="a0011-138">The `methodName` can be either a shared method or an instance method.</span></span> <span data-ttu-id="a0011-139">Der `methodName` ist nicht optional, selbst dann nicht, wenn Sie einen Delegaten für die Standardmethode der Klasse erstellen.</span><span class="sxs-lookup"><span data-stu-id="a0011-139">The `methodName` is not optional, even if you create a delegate for the default method of the class.</span></span>

<span data-ttu-id="a0011-140">Verwenden Sie die folgende Syntax, um einen Lambda-Ausdruck festzulegen:</span><span class="sxs-lookup"><span data-stu-id="a0011-140">To specify a lambda expression, use the following syntax:</span></span>

<span data-ttu-id="a0011-141">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span><span class="sxs-lookup"><span data-stu-id="a0011-141">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span></span>

<span data-ttu-id="a0011-142">Das folgende Beispiel zeigt sowohl `AddressOf`- als auch Lambda-Ausdrücke, mit denen der Verweis für einen Delegaten angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="a0011-142">The following example shows both `AddressOf` and lambda expressions used to specify the reference for a delegate.</span></span>

[!code-vb[VbVbalrDelegates#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class2.vb#15)]

<span data-ttu-id="a0011-143">Die Signatur der Funktion muss mit der des Delegattyps übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="a0011-143">The signature of the function must match that of the delegate type.</span></span> <span data-ttu-id="a0011-144">Weitere Informationen zu Lambdaausdrücken finden Sie unter [Lambda Expressions (Lambdaausdrücke)](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="a0011-144">For more information about lambda expressions, see [Lambda Expressions](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md).</span></span> <span data-ttu-id="a0011-145">Beispiele für Lambda-Ausdrücke und `AddressOf`-Zuweisungen zu Delegaten finden Sie unter [Gelockerte Delegatenkonvertierung](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md).</span><span class="sxs-lookup"><span data-stu-id="a0011-145">For more examples of lambda expression and `AddressOf` assignments to delegates, see [Relaxed Delegate Conversion](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="a0011-146">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="a0011-146">Related Topics</span></span>

|<span data-ttu-id="a0011-147">Titel</span><span class="sxs-lookup"><span data-stu-id="a0011-147">Title</span></span>|<span data-ttu-id="a0011-148">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="a0011-148">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="a0011-149">Gewusst wie: Aufrufen einer Delegatenmethode</span><span class="sxs-lookup"><span data-stu-id="a0011-149">How to: Invoke a Delegate Method</span></span>](../../../../visual-basic/programming-guide/language-features/delegates/how-to-invoke-a-delegate-method.md)|<span data-ttu-id="a0011-150">Zeigt anhand eines Beispiels, wie Sie eine Methode einem Delegaten zuweisen und diese Methode anschließend über den Delegaten aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a0011-150">Provides an example that shows how to associate a method with a delegate and then invoke that method through the delegate.</span></span>|
|[<span data-ttu-id="a0011-151">Gewusst wie: Übergeben von Prozeduren an eine andere Prozedur in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="a0011-151">How to: Pass Procedures to Another Procedure in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md)|<span data-ttu-id="a0011-152">Veranschaulicht, wie Delegaten verwendet werden, um eine Prozedur an eine andere Prozedur zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="a0011-152">Demonstrates how to use delegates to pass one procedure to another procedure.</span></span>|
|[<span data-ttu-id="a0011-153">Gelockerte Delegatenkonvertierung</span><span class="sxs-lookup"><span data-stu-id="a0011-153">Relaxed Delegate Conversion</span></span>](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)|<span data-ttu-id="a0011-154">Beschreibt, wie Subs und Funktionen Delegaten oder Handlern zugewiesen werden können, auch wenn deren Signaturen nicht identisch sind.</span><span class="sxs-lookup"><span data-stu-id="a0011-154">Describes how you can assign subs and functions to delegates or handlers even when their signatures are not identical</span></span>|
|[<span data-ttu-id="a0011-155">Ereignisse</span><span class="sxs-lookup"><span data-stu-id="a0011-155">Events</span></span>](../../../../visual-basic/programming-guide/language-features/events/index.md)|<span data-ttu-id="a0011-156">Stellt eine Übersicht über Ereignisse in Visual Basic bereit.</span><span class="sxs-lookup"><span data-stu-id="a0011-156">Provides an overview of events in Visual Basic.</span></span>|
