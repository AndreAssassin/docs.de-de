---
title: Ref-Rückgabewerte
ms.date: 04/28/2017
helpviewer_keywords:
- variables [Visual Basic]
- ref return values [Visual Basic]
- ref returns [Visual Basic]
ms.assetid: 5ef0cc69-eb3a-4a67-92a2-78585f223cb5
ms.openlocfilehash: f2a92c584dbb12a322e28435d797fa4d7c2f6dbb
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/12/2020
ms.locfileid: "79186937"
---
# <a name="support-for-reference-return-values-visual-basic"></a><span data-ttu-id="0c219-102">Unterstützung für Referenzrückgabewerte (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="0c219-102">Support for reference return values (Visual Basic)</span></span>

<span data-ttu-id="0c219-103">Beginnend mit C-7.0 unterstützt die Sprache *C-Sprache Referenzrückgabewerte*.</span><span class="sxs-lookup"><span data-stu-id="0c219-103">Starting with C# 7.0, the C# language supports *reference return values*.</span></span> <span data-ttu-id="0c219-104">Eine Möglichkeit, Referenzrückgabewerte zu verstehen, besteht darin, dass sie das Gegenteil von Argumenten sind, die durch Verweis auf eine Methode übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="0c219-104">One way to understand reference return values is that they are the opposite of arguments that are passed by reference to a method.</span></span> <span data-ttu-id="0c219-105">Wenn ein argument, das durch Verweis übergeben wird, geändert wird, werden die Änderungen im Wert der Variablen auf dem Aufrufer widergespiegelt.</span><span class="sxs-lookup"><span data-stu-id="0c219-105">When an argument passed by reference is modified, the changes are reflected in value of the variable on the caller.</span></span> <span data-ttu-id="0c219-106">Wenn eine Methode einen Verweisrückgabewert für einen Aufrufer bereitstellt, werden Änderungen, die vom Aufrufer am Verweisrückgabewert vorgenommen wurden, in den Daten der aufgerufenen Methode widergespiegelt.</span><span class="sxs-lookup"><span data-stu-id="0c219-106">When an method provides a reference return value to a caller, modifications made to the reference return value by the caller are reflected in the called method's data.</span></span>

<span data-ttu-id="0c219-107">Visual Basic ermöglicht es Ihnen nicht, Methoden mit Verweisrückgabewerten zu erstellen, aber es erlaubt Ihnen, Referenzrückgabewerte zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="0c219-107">Visual Basic does not allow you to author methods with reference return values, but it does allow you to consume reference return values.</span></span> <span data-ttu-id="0c219-108">Mit anderen Worten, Sie können eine Methode mit einem Referenzrückgabewert aufrufen und diesen Rückgabewert ändern, und Änderungen am Referenzrückgabewert werden in den Daten der aufgerufenen Methode widergespiegelt.</span><span class="sxs-lookup"><span data-stu-id="0c219-108">In other words, you can call a method with a reference return value and modify that return value, and changes to the reference return value are reflected in the called method's data.</span></span>

## <a name="modifying-the-ref-return-value-directly"></a><span data-ttu-id="0c219-109">Direktes Ändern des Ref-Rückgabewerts</span><span class="sxs-lookup"><span data-stu-id="0c219-109">Modifying the ref return value directly</span></span>

<span data-ttu-id="0c219-110">Bei Methoden, die immer `ByRef` erfolgreich sind und keine Parameter haben, können Sie den Referenzrückgabewert direkt ändern.</span><span class="sxs-lookup"><span data-stu-id="0c219-110">For methods that always succeed and have no `ByRef` parameters, you can modify the reference return value directly.</span></span> <span data-ttu-id="0c219-111">Dazu weisen Sie den neuen Wert den Ausdrücken zu, die den Referenzrückgabewert zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="0c219-111">You do this by assigning the new value to the expressions that returns the reference return value.</span></span>

<span data-ttu-id="0c219-112">Im folgenden Beispiel definiert `NumericValue.IncrementValue` das Beispiel "C" eine Methode, die einen internen Wert erhöht und als Referenzrückgabewert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="0c219-112">The following C# example defines a `NumericValue.IncrementValue` method that increments an internal value and returns it as a reference return value.</span></span>

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]

<span data-ttu-id="0c219-113">Der Referenzrückgabewert wird dann vom Aufrufer im folgenden Visual Basic-Beispiel geändert.</span><span class="sxs-lookup"><span data-stu-id="0c219-113">The reference return value is then modified by the caller in the following Visual Basic example.</span></span> <span data-ttu-id="0c219-114">Beachten Sie, dass `NumericValue.IncrementValue` die Zeile mit dem Methodenaufruf der Methode keinen Wert zuweist.</span><span class="sxs-lookup"><span data-stu-id="0c219-114">Note that the line with the `NumericValue.IncrementValue` method call does not assign a value to the method.</span></span> <span data-ttu-id="0c219-115">Stattdessen wird dem von der Methode zurückgegebenen Referenzrückgabewert ein Wert zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="0c219-115">Instead, it assigns a value to the reference return value returned by the method.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]

## <a name="using-a-helper-method"></a><span data-ttu-id="0c219-116">Verwenden einer Hilfsmethode</span><span class="sxs-lookup"><span data-stu-id="0c219-116">Using a helper method</span></span>

<span data-ttu-id="0c219-117">In anderen Fällen ist es möglicherweise nicht immer wünschenswert, den Referenzrückgabewert eines Methodenaufrufs direkt zu ändern.</span><span class="sxs-lookup"><span data-stu-id="0c219-117">In other cases, modifying the reference return value of a method call directly may not always be desirable.</span></span> <span data-ttu-id="0c219-118">Beispielsweise findet eine Suchmethode, die eine Zeichenfolge zurückgibt, möglicherweise nicht immer eine Übereinstimmung.</span><span class="sxs-lookup"><span data-stu-id="0c219-118">For example, a search method that returns a string may not always find a match.</span></span> <span data-ttu-id="0c219-119">In diesem Fall möchten Sie den Referenzrückgabewert nur ändern, wenn die Suche erfolgreich ist.</span><span class="sxs-lookup"><span data-stu-id="0c219-119">In that case, you want to modify the reference return value only if the search is successful.</span></span>

<span data-ttu-id="0c219-120">Dieses Szenario wird im folgenden Beispiel veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="0c219-120">The following C# example illustrates this scenario.</span></span> <span data-ttu-id="0c219-121">Es definiert `Sentence` eine Klasse, die `FindNext` in C- geschrieben ist, enthält eine Methode, die das nächste Wort in einem Satz findet, der mit einer angegebenen Teilzeichenfolge beginnt.</span><span class="sxs-lookup"><span data-stu-id="0c219-121">It defines a `Sentence` class written in C# includes a `FindNext` method that finds the next word in a sentence that begins with a specified substring.</span></span> <span data-ttu-id="0c219-122">Die Zeichenfolge wird als Verweisrückgabewert zurückgegeben, und eine vom Verweis an die Methode übergebene `Boolean`-Variable gibt an, ob die Suche Erfolg hatte.</span><span class="sxs-lookup"><span data-stu-id="0c219-122">The string is returned as a reference return value, and a `Boolean` variable passed by reference to the method indicates whether the search was successful.</span></span> <span data-ttu-id="0c219-123">Der Referenzrückgabewert gibt an, dass der Aufrufer ihn nicht nur lesen kann, sondern auch ändern `Sentence` kann, und dass diese Änderung in den intern in der Klasse enthaltenen Daten widergespiegelt wird.</span><span class="sxs-lookup"><span data-stu-id="0c219-123">The reference return value indicates that in addition to reading the returned value, the caller can also modify it, and that modification is reflected in the data contained internally in the `Sentence` class.</span></span>

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]

<span data-ttu-id="0c219-124">Das direkte Ändern des Referenzrückgabewerts ist in diesem Fall nicht zuverlässig, da der Methodenaufruf möglicherweise keine Übereinstimmung findet und das erste Wort im Satz zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="0c219-124">Directly modifying the reference return value in this case is not reliable, since the method call may fail to find a match and return the first word in the sentence.</span></span> <span data-ttu-id="0c219-125">In diesem Fall ändert der Aufrufer versehentlich das erste Wort des Satzes.</span><span class="sxs-lookup"><span data-stu-id="0c219-125">In that case, the caller will inadvertently modify the first word of the sentence.</span></span> <span data-ttu-id="0c219-126">Dies kann verhindert werden, `null` indem `Nothing` der Aufrufer eine (oder in Visual Basic) zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="0c219-126">This could be prevented by the caller returning a `null` (or `Nothing` in Visual Basic).</span></span> <span data-ttu-id="0c219-127">In diesem Fall wird jedoch versucht, eine `Nothing` Zeichenfolge <xref:System.NullReferenceException>zu ändern, deren Wert eine .</span><span class="sxs-lookup"><span data-stu-id="0c219-127">But in that case, attempting to modify a string whose value is `Nothing` throws a <xref:System.NullReferenceException>.</span></span> <span data-ttu-id="0c219-128">Wenn auch durch die Rückgabe <xref:System.String.Empty?displayProperty=nameWithType>des Aufrufers verhindert werden könnte, erfordert <xref:System.String.Empty?displayProperty=nameWithType>dies jedoch, dass der Aufrufer eine Zeichenfolgenvariable definiert, deren Wert .</span><span class="sxs-lookup"><span data-stu-id="0c219-128">If could also be prevented by the caller returning <xref:System.String.Empty?displayProperty=nameWithType>, but this requires that the caller define a string variable whose value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0c219-129">Während der Aufrufer diese Zeichenfolge ändern kann, hat die Änderung selbst keinen Zweck, da die `Sentence` geänderte Zeichenfolge keine Beziehung zu den Wörtern in dem von der Klasse gespeicherten Satz hat.</span><span class="sxs-lookup"><span data-stu-id="0c219-129">While the caller can modify that string, the modification itself serves no purpose, since the modified string has no relationship to the words in the sentence stored by the `Sentence` class.</span></span>

<span data-ttu-id="0c219-130">Die beste Methode, dieses Szenario zu behandeln, besteht darin, den Referenzrückgabewert als Verweis auf eine Hilfsmethode zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="0c219-130">The best way to handle this scenario is to pass the reference return value by reference to a helper method.</span></span> <span data-ttu-id="0c219-131">Die Hilfsmethode enthält dann die Logik, um zu bestimmen, ob der Methodenaufruf erfolgreich war, und, falls dies der Derentumso, den Verweisrückgabewert zu ändern.</span><span class="sxs-lookup"><span data-stu-id="0c219-131">The helper method then contains the logic to determine whether the method call succeeded and, if it did, to modify the reference return value.</span></span> <span data-ttu-id="0c219-132">Im folgenden Beispiel wird eine mögliche Implementierung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="0c219-132">The following example provides a possible implementation.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]

## <a name="see-also"></a><span data-ttu-id="0c219-133">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="0c219-133">See also</span></span>

- [<span data-ttu-id="0c219-134">Übergeben von Argumenten nach Wert und Verweis</span><span class="sxs-lookup"><span data-stu-id="0c219-134">Passing arguments by value and by reference</span></span>](passing-arguments-by-value-and-by-reference.md)
- [<span data-ttu-id="0c219-135">Prozeduren in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="0c219-135">Procedures in Visual Basic</span></span>](index.md)
