---
title: Typerweiterung
ms.date: 07/20/2015
helpviewer_keywords:
- declared elements [Visual Basic], scope
- visibility [Visual Basic], declared elements
- Partial keyword [Visual Basic], unexpected results with type promotion
- scope [Visual Basic], declared elements
- scope [Visual Basic], Visual Basic
- type promotion
- declared elements [Visual Basic], visibility
ms.assetid: 035eeb15-e4c5-4288-ab3c-6bd5d22f7051
ms.openlocfilehash: aa05bd7dc87510aedb0facadf4b7590c8ec57d1f
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/22/2019
ms.locfileid: "74345276"
---
# <a name="type-promotion-visual-basic"></a><span data-ttu-id="35b76-102">Typerweiterung (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="35b76-102">Type Promotion (Visual Basic)</span></span>
<span data-ttu-id="35b76-103">Wenn Sie ein Programmier Element in einem Modul deklarieren, Visual Basic den Bereich auf den Namespace herauf Stufen, der das Modul enthält.</span><span class="sxs-lookup"><span data-stu-id="35b76-103">When you declare a programming element in a module, Visual Basic promotes its scope to the namespace containing the module.</span></span> <span data-ttu-id="35b76-104">Dies wird als *Typerweiterung*bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="35b76-104">This is known as *type promotion*.</span></span>  
  
 <span data-ttu-id="35b76-105">Das folgende Beispiel zeigt eine Skelett Definition eines Moduls und zwei Member dieses Moduls.</span><span class="sxs-lookup"><span data-stu-id="35b76-105">The following example shows a skeleton definition of a module and two members of that module.</span></span>  
  
 [!code-vb[VbVbalrDeclaredElements#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDeclaredElements/VB/Class1.vb#1)]  
  
 <span data-ttu-id="35b76-106">Innerhalb `projModule`werden Programmier Elemente, die auf Modulebene deklariert werden, zu `projNamespace`herauf gestuft.</span><span class="sxs-lookup"><span data-stu-id="35b76-106">Within `projModule`, programming elements declared at module level are promoted to `projNamespace`.</span></span> <span data-ttu-id="35b76-107">Im vorherigen Beispiel werden `basicEnum` und `innerClass` herauf gestuft, aber `numberSub` ist nicht, da es nicht auf Modulebene deklariert ist.</span><span class="sxs-lookup"><span data-stu-id="35b76-107">In the preceding example, `basicEnum` and `innerClass` are promoted, but `numberSub` is not, because it is not declared at module level.</span></span>  
  
## <a name="effect-of-type-promotion"></a><span data-ttu-id="35b76-108">Auswirkung der Typerweiterung</span><span class="sxs-lookup"><span data-stu-id="35b76-108">Effect of Type Promotion</span></span>  
 <span data-ttu-id="35b76-109">Die Auswirkung der Typerweiterung besteht darin, dass eine Qualifizierungs Zeichenfolge nicht den Modulnamen enthalten muss.</span><span class="sxs-lookup"><span data-stu-id="35b76-109">The effect of type promotion is that a qualification string does not need to include the module name.</span></span> <span data-ttu-id="35b76-110">Im folgenden Beispiel werden zwei Aufrufe der Prozedur im vorherigen Beispiel durchführt.</span><span class="sxs-lookup"><span data-stu-id="35b76-110">The following example makes two calls to the procedure in the preceding example.</span></span>  
  
 [!code-vb[VbVbalrDeclaredElements#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDeclaredElements/VB/Class1.vb#2)]  
  
 <span data-ttu-id="35b76-111">Im vorherigen Beispiel verwendet der erste-Befehl komplette Qualifizierungs Zeichenfolgen.</span><span class="sxs-lookup"><span data-stu-id="35b76-111">In the preceding example, the first call uses complete qualification strings.</span></span> <span data-ttu-id="35b76-112">Dies ist jedoch aufgrund der typherauf Stufung nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="35b76-112">However, this is not necessary because of type promotion.</span></span> <span data-ttu-id="35b76-113">Der zweite-Befehl greift auch auf die Member des Moduls zu, ohne `projModule` in die Qualifizierungs Zeichenfolgen einzubeziehen.</span><span class="sxs-lookup"><span data-stu-id="35b76-113">The second call also accesses the module's members without including `projModule` in the qualification strings.</span></span>  
  
## <a name="defeat-of-type-promotion"></a><span data-ttu-id="35b76-114">Bekämpfung der herauf Stufung von Typen</span><span class="sxs-lookup"><span data-stu-id="35b76-114">Defeat of Type Promotion</span></span>  
 <span data-ttu-id="35b76-115">Wenn der Namespace bereits einen Member mit demselben Namen wie ein Modulmember hat, wird die Typerweiterung für dieses Modulmember unterstrichen.</span><span class="sxs-lookup"><span data-stu-id="35b76-115">If the namespace already has a member with the same name as a module member, type promotion is defeated for that module member.</span></span> <span data-ttu-id="35b76-116">Das folgende Beispiel zeigt eine Gerüst Definition einer Enumeration und eines Moduls innerhalb desselben Namespace.</span><span class="sxs-lookup"><span data-stu-id="35b76-116">The following example shows a skeleton definition of an enumeration and a module within the same namespace.</span></span>  
  
 [!code-vb[VbVbalrDeclaredElements#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDeclaredElements/VB/Class1.vb#3)]  
  
 <span data-ttu-id="35b76-117">Im vorherigen Beispiel können Visual Basic die Klasse `abc` nicht auf `thisNameSpace` herauf Stufen, weil bereits eine Enumeration mit dem gleichen Namen auf der Namespace Ebene vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="35b76-117">In the preceding example, Visual Basic cannot promote class `abc` to `thisNameSpace` because there is already an enumeration with the same name at namespace level.</span></span> <span data-ttu-id="35b76-118">Um auf `abcSub`zuzugreifen, müssen Sie die vollständige Qualifizierungs Zeichenfolge `thisNamespace.thisModule.abc.abcSub`verwenden.</span><span class="sxs-lookup"><span data-stu-id="35b76-118">To access `abcSub`, you must use the full qualification string `thisNamespace.thisModule.abc.abcSub`.</span></span> <span data-ttu-id="35b76-119">Klassen `xyz` werden jedoch immer noch herauf gestuft, und Sie können mit der kürzeren Qualifizierungs Zeichenfolge `thisNamespace.xyz.xyzSub`auf `xyzSub` zugreifen.</span><span class="sxs-lookup"><span data-stu-id="35b76-119">However, class `xyz` is still promoted, and you can access `xyzSub` with the shorter qualification string `thisNamespace.xyz.xyzSub`.</span></span>  
  
### <a name="defeat-of-type-promotion-for-partial-types"></a><span data-ttu-id="35b76-120">Die unter Stufung der herauf Stufung von Typen für partielle Typen</span><span class="sxs-lookup"><span data-stu-id="35b76-120">Defeat of Type Promotion for Partial Types</span></span>  
 <span data-ttu-id="35b76-121">Wenn eine Klasse oder Struktur innerhalb eines Moduls das [partielle](../../../../visual-basic/language-reference/modifiers/partial.md) Schlüsselwort verwendet, wird die Typerweiterung für diese Klasse oder Struktur automatisch unterstrichen, unabhängig davon, ob der Namespace über einen Member mit demselben Namen verfügt.</span><span class="sxs-lookup"><span data-stu-id="35b76-121">If a class or structure inside a module uses the [Partial](../../../../visual-basic/language-reference/modifiers/partial.md) keyword, type promotion is automatically defeated for that class or structure, whether or not the namespace has a member with the same name.</span></span> <span data-ttu-id="35b76-122">Andere Elemente im Modul sind immer noch für die Typerweiterung geeignet.</span><span class="sxs-lookup"><span data-stu-id="35b76-122">Other elements in the module are still eligible for type promotion.</span></span>  
  
 <span data-ttu-id="35b76-123">**Konsequenzen.**</span><span class="sxs-lookup"><span data-stu-id="35b76-123">**Consequences.**</span></span> <span data-ttu-id="35b76-124">Die unter Folge einer typherauf Stufung einer partiellen Definition kann unerwartete Ergebnisse und sogar Compilerfehler verursachen.</span><span class="sxs-lookup"><span data-stu-id="35b76-124">Defeat of type promotion of a partial definition can cause unexpected results and even compiler errors.</span></span> <span data-ttu-id="35b76-125">Im folgenden Beispiel werden Skeleton partielle Definitionen einer-Klasse veranschaulicht, von denen eine innerhalb eines Moduls ist.</span><span class="sxs-lookup"><span data-stu-id="35b76-125">The following example shows skeleton partial definitions of a class, one of which is inside a module.</span></span>  
  
 [!code-vb[VbVbalrDeclaredElements#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDeclaredElements/VB/Class1.vb#4)]  
  
 <span data-ttu-id="35b76-126">Im vorherigen Beispiel erwartet der Entwickler möglicherweise, dass der Compiler die beiden partiellen Definitionen von `sampleClass`zusammenführen kann.</span><span class="sxs-lookup"><span data-stu-id="35b76-126">In the preceding example, the developer might expect the compiler to merge the two partial definitions of `sampleClass`.</span></span> <span data-ttu-id="35b76-127">Der Compiler kann jedoch die herauf Stufung der partiellen Definition nicht innerhalb `sampleModule`in Erwägung gezogen.</span><span class="sxs-lookup"><span data-stu-id="35b76-127">However, the compiler does not consider promotion for the partial definition inside `sampleModule`.</span></span> <span data-ttu-id="35b76-128">Daher wird versucht, zwei separate und unterschiedliche Klassen zu kompilieren, beide mit dem Namen `sampleClass`, aber mit unterschiedlichen Qualifizierungs Pfaden.</span><span class="sxs-lookup"><span data-stu-id="35b76-128">As a result, it attempts to compile two separate and distinct classes, both named `sampleClass` but with different qualification paths.</span></span>  
  
 <span data-ttu-id="35b76-129">Der Compiler führt partielle Definitionen nur zusammen, wenn ihre voll qualifizierten Pfade identisch sind.</span><span class="sxs-lookup"><span data-stu-id="35b76-129">The compiler merges partial definitions only when their fully qualified paths are identical.</span></span>  
  
## <a name="recommendations"></a><span data-ttu-id="35b76-130">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="35b76-130">Recommendations</span></span>  
 <span data-ttu-id="35b76-131">Die folgenden Empfehlungen stellen eine gute Programmierpraxis dar.</span><span class="sxs-lookup"><span data-stu-id="35b76-131">The following recommendations represent good programming practice.</span></span>  
  
- <span data-ttu-id="35b76-132">**Eindeutige Namen.**</span><span class="sxs-lookup"><span data-stu-id="35b76-132">**Unique Names.**</span></span> <span data-ttu-id="35b76-133">Wenn Sie die vollständige Kontrolle über die Benennung von Programmier Elementen haben, empfiehlt es sich immer, eindeutige Namen überall zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="35b76-133">When you have full control over the naming of programming elements, it is always a good idea to use unique names everywhere.</span></span> <span data-ttu-id="35b76-134">Identische Namen erfordern eine zusätzliche Qualifizierung und können dazu führen, dass Ihr Code schwieriger zu lesen ist.</span><span class="sxs-lookup"><span data-stu-id="35b76-134">Identical names require extra qualification and can make your code harder to read.</span></span> <span data-ttu-id="35b76-135">Sie können auch zu geringfügigen Fehlern und unerwarteten Ergebnissen führen.</span><span class="sxs-lookup"><span data-stu-id="35b76-135">They can also lead to subtle errors and unexpected results.</span></span>  
  
- <span data-ttu-id="35b76-136">**Vollständige Qualifizierung.**</span><span class="sxs-lookup"><span data-stu-id="35b76-136">**Full Qualification.**</span></span> <span data-ttu-id="35b76-137">Wenn Sie mit Modulen und anderen Elementen im gleichen Namespace arbeiten, besteht der sicherste Ansatz darin, stets die vollständige Qualifikation für alle Programmier Elemente zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="35b76-137">When you are working with modules and other elements in the same namespace, the safest approach is to always use full qualification for all programming elements.</span></span> <span data-ttu-id="35b76-138">Wenn die Typerweiterung für ein Modulmember besiegt wird und Sie diesen Member nicht vollständig qualifizieren, können Sie versehentlich auf ein anderes Programmier Element zugreifen.</span><span class="sxs-lookup"><span data-stu-id="35b76-138">If type promotion is defeated for a module member and you do not fully qualify that member, you could inadvertently access a different programming element.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="35b76-139">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="35b76-139">See also</span></span>

- [<span data-ttu-id="35b76-140">Module-Anweisung</span><span class="sxs-lookup"><span data-stu-id="35b76-140">Module Statement</span></span>](../../../../visual-basic/language-reference/statements/module-statement.md)
- [<span data-ttu-id="35b76-141">Namespace-Anweisung</span><span class="sxs-lookup"><span data-stu-id="35b76-141">Namespace Statement</span></span>](../../../../visual-basic/language-reference/statements/namespace-statement.md)
- [<span data-ttu-id="35b76-142">Partial</span><span class="sxs-lookup"><span data-stu-id="35b76-142">Partial</span></span>](../../../../visual-basic/language-reference/modifiers/partial.md)
- [<span data-ttu-id="35b76-143">Bereich in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="35b76-143">Scope in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)
- [<span data-ttu-id="35b76-144">Gewusst wie: Steuern des Gültigkeitsbereichs einer Variablen</span><span class="sxs-lookup"><span data-stu-id="35b76-144">How to: Control the Scope of a Variable</span></span>](../../../../visual-basic/programming-guide/language-features/declared-elements/how-to-control-the-scope-of-a-variable.md)
- [<span data-ttu-id="35b76-145">Verweise auf deklarierte Elemente</span><span class="sxs-lookup"><span data-stu-id="35b76-145">References to Declared Elements</span></span>](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)
