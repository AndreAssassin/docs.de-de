---
title: Resiliente Kommunikation
description: Architektur von Cloud Native .net-apps für Azure | Robuste Kommunikation
ms.date: 06/30/2019
ms.openlocfilehash: 324f5426af1c892db73aa6fc2336a19b7a8e499e
ms.sourcegitcommit: 628e8147ca10187488e6407dab4c4e6ebe0cac47
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/15/2019
ms.locfileid: "73841222"
---
# <a name="resilient-communications"></a><span data-ttu-id="33297-103">Robuste Kommunikation</span><span class="sxs-lookup"><span data-stu-id="33297-103">Resilient communications</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="33297-104">In diesem Buch haben wir die Vorzüge der Umstellung auf den herkömmlichen monolithischen Anwendungs Entwurf und die Umsetzung einer auf microservices basierenden Architektur, in der ein Satz verteilter, eigenständiger Dienste unabhängig ausgeführt wird, und die Kommunikation mit jedem andere verwendet Standard Kommunikationsprotokolle wie http und HTTPS.</span><span class="sxs-lookup"><span data-stu-id="33297-104">Throughout this book, we've evangelized the merits of moving beyond traditional monolithic application design and embracing a microservice-based architecture where a set of distributed, self-contained services run independently and communicate with each other using standard communication protocols such as HTTP and HTTPS.</span></span> <span data-ttu-id="33297-105">Obwohl eine solche Architektur Ihnen viele wichtige Vorteile bietet, stellt Sie auch viele Herausforderungen dar.</span><span class="sxs-lookup"><span data-stu-id="33297-105">While such an architecture buys you many important benefits, it also presents many challenges.</span></span> <span data-ttu-id="33297-106">Beachten Sie z. b. die folgenden Probleme:</span><span class="sxs-lookup"><span data-stu-id="33297-106">Consider, for example, the following concerns:</span></span>

- <span data-ttu-id="33297-107">*Out-of-Process-Netzwerkkommunikation.*</span><span class="sxs-lookup"><span data-stu-id="33297-107">*Out-of-process network communication.*</span></span> <span data-ttu-id="33297-108">Jeder Dienst kommuniziert über ein Netzwerkprotokoll, in dem Netzwerk Überlastung, Latenz und vorübergehende Fehler eingeführt werden.</span><span class="sxs-lookup"><span data-stu-id="33297-108">Each service communicates over a network protocol that introduces network congestion, latency, and transient faults.</span></span>
- <span data-ttu-id="33297-109">*Dienst Ermittlung.*</span><span class="sxs-lookup"><span data-stu-id="33297-109">*Service discovery.*</span></span> <span data-ttu-id="33297-110">Wenn jeder Dienst in einem Cluster von Computern mit einer eigenen IP-Adresse und einem eigenen Port ausgeführt wird, wie werden Dienste erkannt und miteinander kommunizieren?</span><span class="sxs-lookup"><span data-stu-id="33297-110">With each service running across a cluster of machines with its own IP address and port, how do services discover and communicate with each other?</span></span>
- <span data-ttu-id="33297-111">*Resilienz.*</span><span class="sxs-lookup"><span data-stu-id="33297-111">*Resiliency.*</span></span> <span data-ttu-id="33297-112">Wie verwalten Sie kurzlebige Ausfälle, und halten Sie das System stabil?</span><span class="sxs-lookup"><span data-stu-id="33297-112">How do you manage short-lived failures and keep the system stable?</span></span>
- <span data-ttu-id="33297-113">*Lastenausgleich.*</span><span class="sxs-lookup"><span data-stu-id="33297-113">*Load balancing.*</span></span> <span data-ttu-id="33297-114">Wie erfolgt der eingehende Datenverkehr auf mehrere Instanzen eines Dienstanbieter?</span><span class="sxs-lookup"><span data-stu-id="33297-114">How does inbound traffic get distributed across multiple instances of a service?</span></span>
- <span data-ttu-id="33297-115">*Sicherheit.*</span><span class="sxs-lookup"><span data-stu-id="33297-115">*Security.*</span></span> <span data-ttu-id="33297-116">Wie werden Sicherheitsprobleme wie die Verschlüsselung auf Transport Ebene und die Zertifikat Verwaltung erzwungen?</span><span class="sxs-lookup"><span data-stu-id="33297-116">How are security concerns such as transport-level encryption and certificate management enforced?</span></span>
- <span data-ttu-id="33297-117">*Verteilte Überwachung.*</span><span class="sxs-lookup"><span data-stu-id="33297-117">*Distributed Monitoring.*</span></span> <span data-ttu-id="33297-118">-Wie korrelieren und erfassen Sie die Rückverfolgbarkeit und Überwachung für eine einzelne Anforderung über mehrere verarbeitende Dienste?</span><span class="sxs-lookup"><span data-stu-id="33297-118">- How do you correlate and capture traceability and monitoring for a single request across multiple consuming services?</span></span>

<span data-ttu-id="33297-119">Obwohl diese Probleme mit verschiedenen Bibliotheken und Frameworks angegangen werden können, kann die Implementierung in Ihre Codebasis teuer, komplex und zeitaufwändig sein.</span><span class="sxs-lookup"><span data-stu-id="33297-119">While these concerns can be addressed with various libraries and frameworks, implementing them inside your codebase can be expensive, complex, and time-consuming.</span></span> <span data-ttu-id="33297-120">Außerdem verfügen Sie am Ende über eine Lösung, bei der Infrastrukturprobleme an die Geschäftslogik gekoppelt sind.</span><span class="sxs-lookup"><span data-stu-id="33297-120">Moreover, you end up with a solution where infrastructure concerns are coupled to business logic.</span></span>

## <a name="service-mesh"></a><span data-ttu-id="33297-121">Dienst Gitter</span><span class="sxs-lookup"><span data-stu-id="33297-121">Service mesh</span></span>

<span data-ttu-id="33297-122">Ein besserer Ansatz besteht darin, eine neue und schnell entwickelnde Technologie mit dem *Service Mesh*zu betrachten.</span><span class="sxs-lookup"><span data-stu-id="33297-122">A better approach is to consider a new and rapidly evolving technology entitled *Service Mesh*.</span></span> <span data-ttu-id="33297-123">Ein [Dienst Netz](https://www.nginx.com/blog/what-is-a-service-mesh/) ist eine konfigurierbare Infrastruktur Schicht mit integrierten Funktionen zum Verarbeiten der Dienst Kommunikation und vielen der oben genannten Herausforderungen.</span><span class="sxs-lookup"><span data-stu-id="33297-123">A [service mesh](https://www.nginx.com/blog/what-is-a-service-mesh/) is a configurable infrastructure layer with built-in capabilities to handle service communication and many of the challenges mentioned above.</span></span> <span data-ttu-id="33297-124">Sie entkoppelt diese Probleme von Ihrem Geschäfts Code und verschiebt Sie in einen Dienst Proxy, eine Instanz von, die die einzelnen Dienste begleitet.</span><span class="sxs-lookup"><span data-stu-id="33297-124">It decouples these concerns from your business code and moves them into a service proxy, an instance of which accompanies each of your services.</span></span> <span data-ttu-id="33297-125">Der Service Mesh-Proxy wird häufig als [Sidecar-Muster](https://docs.microsoft.com/azure/architecture/patterns/sidecar)bezeichnet und wird in einem separaten Prozess bereitgestellt, um Isolation und Kapselung von Ihrem Geschäfts Code bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="33297-125">Often referred to as the [Sidecar pattern](https://docs.microsoft.com/azure/architecture/patterns/sidecar), the service mesh proxy is deployed into a separate process to provide isolation and encapsulation from your business code.</span></span> <span data-ttu-id="33297-126">Der Proxy ist jedoch eng mit dem Dienst verknüpft, der zusammen mit dem Dienst erstellt und dessen Lebenszyklus gemeinsam genutzt wird.</span><span class="sxs-lookup"><span data-stu-id="33297-126">However, the proxy is closely linked to the service being created along with it and sharing its lifecycle.</span></span> <span data-ttu-id="33297-127">In Abbildung 6-9 wird dieses Szenario veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="33297-127">Figure 6-9 shows this scenario.</span></span>

![Dienst Netz mit einem seitigen Fahrzeug](./media/service-mesh-with-side-car.png)

<span data-ttu-id="33297-129">**Abbildung 6-9**.</span><span class="sxs-lookup"><span data-stu-id="33297-129">**Figure 6-9**.</span></span> <span data-ttu-id="33297-130">Dienst Netz mit einem seitigen Fahrzeug</span><span class="sxs-lookup"><span data-stu-id="33297-130">Service mesh with a side car</span></span>

<span data-ttu-id="33297-131">Beachten Sie in der obigen Abbildung, wie der Proxy die Kommunikation zwischen den-und dem-Cluster abfängt und verwaltet.</span><span class="sxs-lookup"><span data-stu-id="33297-131">In the previous figure, note how the proxy intercepts and manages communication among the microservices and the cluster.</span></span>

<span data-ttu-id="33297-132">Ein Dienst Netz wird logisch in zwei unterschiedliche Komponenten aufgeteilt: eine [Datenebene](https://blog.envoyproxy.io/service-mesh-data-plane-vs-control-plane-2774e720f7fc) und eine [Steuerungsebene](https://blog.envoyproxy.io/service-mesh-data-plane-vs-control-plane-2774e720f7fc).</span><span class="sxs-lookup"><span data-stu-id="33297-132">A service mesh is logically split into two disparate components: A [data plane](https://blog.envoyproxy.io/service-mesh-data-plane-vs-control-plane-2774e720f7fc) and [control plane](https://blog.envoyproxy.io/service-mesh-data-plane-vs-control-plane-2774e720f7fc).</span></span> <span data-ttu-id="33297-133">In Abbildung 6-10 werden diese Komponenten und ihre Zuständigkeiten veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="33297-133">Figure 6-10 shows these components and their responsibilities.</span></span>

![Dienstmesh-Steuerung und Datenebene](./media/istio-control-and-data-plane.png)

<span data-ttu-id="33297-135">**Abbildung 6-10.**</span><span class="sxs-lookup"><span data-stu-id="33297-135">**Figure 6-10.**</span></span> <span data-ttu-id="33297-136">Dienstmesh-Steuerung und Datenebene</span><span class="sxs-lookup"><span data-stu-id="33297-136">Service mesh control and data plane</span></span>

<span data-ttu-id="33297-137">Nach der Konfiguration ist ein Dienst Mesh hoch funktionsfähig.</span><span class="sxs-lookup"><span data-stu-id="33297-137">Once configured, a service mesh is highly functional.</span></span> <span data-ttu-id="33297-138">Es kann einen entsprechenden Pool von Instanzen von einem Dienst Ermittlungs Endpunkt abrufen.</span><span class="sxs-lookup"><span data-stu-id="33297-138">It can retrieve a corresponding pool of instances from a service discovery endpoint.</span></span> <span data-ttu-id="33297-139">Anschließend kann eine Anforderung an eine bestimmte Instanz gesendet werden, wobei die Latenz und der Antworttyp des Ergebnisses aufgezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="33297-139">It can then send a request to a specific instance, recording the latency and response type of the result.</span></span> <span data-ttu-id="33297-140">Ein Mesh kann die Instanz auswählen, die höchstwahrscheinlich eine schnelle Antwort auf der Grundlage vieler Faktoren zurückgibt, einschließlich der beobachteten Latenzzeit für aktuelle Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="33297-140">A mesh can choose the instance most likely to return a fast response based on many factors, including its observed latency for recent requests.</span></span>

<span data-ttu-id="33297-141">Wenn eine Instanz nicht reagiert oder fehlschlägt, kann das Mesh die Anforderung auf einer anderen Instanz wiederholen.</span><span class="sxs-lookup"><span data-stu-id="33297-141">If an instance is unresponsive or fails, the mesh can retry the request on another instance.</span></span> <span data-ttu-id="33297-142">Wenn ein Pool konsistent Fehler zurückgibt, kann ein Mesh ihn aus dem Lasten Ausgleichs Pool entfernen, damit er in regelmäßigen Abständen später wiederholt wird.</span><span class="sxs-lookup"><span data-stu-id="33297-142">If a pool consistently returns errors, a mesh can evict it from the load-balancing pool to be retried periodically later after it heals.</span></span> <span data-ttu-id="33297-143">Wenn für eine Anforderung ein Timeout auftritt, kann ein Mesh fehlschlagen und dann die Anforderung wiederholen.</span><span class="sxs-lookup"><span data-stu-id="33297-143">If a request times out, a mesh can fail and then retry the request.</span></span> <span data-ttu-id="33297-144">Ein Mesh erfasst Verhalten in Form von Metriken und verteilten Ablauf Verfolgungs Daten, die dann an ein zentralisiertes metriksystem ausgegeben werden können.</span><span class="sxs-lookup"><span data-stu-id="33297-144">A mesh captures behavior in the form of metrics and distributed tracing, which then can be emitted to a centralized metrics system.</span></span>

## <a name="istio-and-envoy"></a><span data-ttu-id="33297-145">Istio und Gesandter</span><span class="sxs-lookup"><span data-stu-id="33297-145">Istio and Envoy</span></span>

<span data-ttu-id="33297-146">Obwohl zurzeit einige wenige Dienst Gitter Optionen vorhanden sind, ist [istio](https://istio.io/docs/concepts/what-is-istio/) zum Zeitpunkt der Erstellung dieses Artikels am beliebtesten.</span><span class="sxs-lookup"><span data-stu-id="33297-146">While a few service mesh options currently exist, [Istio](https://istio.io/docs/concepts/what-is-istio/) is the most popular as of the time of this writing.</span></span> <span data-ttu-id="33297-147">Ein Joint Venture von IBM, Google und lyft ist ein Open Source-Angebot, das in eine neue oder vorhandene verteilte Anwendung integriert werden kann.</span><span class="sxs-lookup"><span data-stu-id="33297-147">A joint venture from IBM, Google, and Lyft, it's an open-source offering that can be integrated into a new or existing distributed application.</span></span> <span data-ttu-id="33297-148">Er bietet eine konsistente und umfassende Lösung für das sichern, verbinden und Überwachen von-Diensten.</span><span class="sxs-lookup"><span data-stu-id="33297-148">It provides a consistent and complete solution to secure, connect, and monitor microservices.</span></span> <span data-ttu-id="33297-149">Zu den Features gehören:</span><span class="sxs-lookup"><span data-stu-id="33297-149">Its features include:</span></span>

- <span data-ttu-id="33297-150">Sichere Dienst-zu-Dienst-Kommunikation in einem Cluster mit starker Identitäts basierter Authentifizierung und Autorisierung.</span><span class="sxs-lookup"><span data-stu-id="33297-150">Secure service-to-service communication in a cluster with strong identity-based authentication and authorization.</span></span>
- <span data-ttu-id="33297-151">Automatischer Lastenausgleich für http-, [GrpC](https://grpc.io/)-, WebSocket-und TCP-Datenverkehr.</span><span class="sxs-lookup"><span data-stu-id="33297-151">Automatic load balancing for HTTP, [gRPC](https://grpc.io/), WebSocket, and TCP traffic.</span></span>
- <span data-ttu-id="33297-152">Differenzierte Kontrolle über das Datenverkehrs Verhalten durch umfangreiche Routing Regeln, Wiederholungen, Failover und Fehler Injektion.</span><span class="sxs-lookup"><span data-stu-id="33297-152">Fine-grained control of traffic behavior with rich routing rules, retries, failovers, and fault injection.</span></span>
- <span data-ttu-id="33297-153">Eine austauschbare Richtlinien Schicht und Konfigurations-API, die Zugriffs Steuerungen, Begrenzung der Datenübertragungsrate und Kontingente unterstützt.</span><span class="sxs-lookup"><span data-stu-id="33297-153">A pluggable policy layer and configuration API supporting access controls, rate limits, and quotas.</span></span>
- <span data-ttu-id="33297-154">Automatische Metriken, Protokolle und Ablauf Verfolgungen für den gesamten Datenverkehr in einem Cluster, einschließlich Cluster Einzug und-Ausgang.</span><span class="sxs-lookup"><span data-stu-id="33297-154">Automatic metrics, logs, and traces for all traffic within a cluster, including cluster ingress and egress.</span></span>

<span data-ttu-id="33297-155">Eine Schlüsselkomponente für eine istio-Implementierung ist ein Proxy Dienst, der den [Proxy](https://www.envoyproxy.io/docs/envoy/latest/intro/what_is_envoy)Dienst als Anspruch hat.</span><span class="sxs-lookup"><span data-stu-id="33297-155">A key component for an Istio implementation is a proxy service entitled the [Envoy proxy](https://www.envoyproxy.io/docs/envoy/latest/intro/what_is_envoy).</span></span> <span data-ttu-id="33297-156">Aus lyft und anschließenden Beitrag zur [Cloud Native Computing Foundation](https://www.cncf.io/) (erläutert in Kapitel 1) wird der Proxy Proxy neben den einzelnen Diensten ausgeführt und stellt eine plattformunabhängige Grundlage für die folgenden Features bereit:</span><span class="sxs-lookup"><span data-stu-id="33297-156">Originating from Lyft and subsequently contributed to the [Cloud Native Computing Foundation](https://www.cncf.io/) (discussed in chapter 1), the Envoy proxy runs alongside each service and provides a platform-agnostic foundation for the following features:</span></span>

- <span data-ttu-id="33297-157">Dynamische Dienst Ermittlung.</span><span class="sxs-lookup"><span data-stu-id="33297-157">Dynamic service discovery.</span></span>
- <span data-ttu-id="33297-158">Lastenausgleich.</span><span class="sxs-lookup"><span data-stu-id="33297-158">Load balancing.</span></span>
- <span data-ttu-id="33297-159">TLS-Beendigung.</span><span class="sxs-lookup"><span data-stu-id="33297-159">TLS termination.</span></span>
- <span data-ttu-id="33297-160">HTTP-und GrpC-Proxys.</span><span class="sxs-lookup"><span data-stu-id="33297-160">HTTP and gRPC proxies.</span></span>
- <span data-ttu-id="33297-161">Resilienz der Schutzschalter.</span><span class="sxs-lookup"><span data-stu-id="33297-161">Circuit breaker resiliency.</span></span>
- <span data-ttu-id="33297-162">Integritätsprüfungen.</span><span class="sxs-lookup"><span data-stu-id="33297-162">Health checks.</span></span>
- <span data-ttu-id="33297-163">Parallele Aktualisierungen mit [Canary](https://martinfowler.com/bliki/CanaryRelease.html) -bereit Stellungen.</span><span class="sxs-lookup"><span data-stu-id="33297-163">Rolling updates with [canary](https://martinfowler.com/bliki/CanaryRelease.html) deployments.</span></span>

<span data-ttu-id="33297-164">Wie bereits erwähnt, wird der Gesandte als Sidecar für jeden der einzelnen mikrodienste im Cluster bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="33297-164">As previously discussed, Envoy is deployed as a sidecar to each microservice in the cluster.</span></span>

## <a name="integration-with-azure-kubernetes-services"></a><span data-ttu-id="33297-165">Integration in Azure Kubernetes Services</span><span class="sxs-lookup"><span data-stu-id="33297-165">Integration with Azure Kubernetes Services</span></span>

<span data-ttu-id="33297-166">Die Azure-Cloud bietet istio an und bietet direkten Support für Sie in Azure Kubernetes Services.</span><span class="sxs-lookup"><span data-stu-id="33297-166">The Azure cloud embraces Istio and provides direct support for it within Azure Kubernetes Services.</span></span> <span data-ttu-id="33297-167">Die folgenden Links helfen Ihnen beim Einstieg:</span><span class="sxs-lookup"><span data-stu-id="33297-167">The following links can help you get started:</span></span>

- [<span data-ttu-id="33297-168">Installieren von istio in AKS</span><span class="sxs-lookup"><span data-stu-id="33297-168">Installing Istio in AKS</span></span>](https://docs.microsoft.com/azure/aks/istio-install)
- [<span data-ttu-id="33297-169">Verwenden von AKS und istio</span><span class="sxs-lookup"><span data-stu-id="33297-169">Using AKS and Istio</span></span>](https://docs.microsoft.com/azure/aks/istio-scenario-routing)

>[!div class="step-by-step"]
><span data-ttu-id="33297-170">[Zurück](infrastructure-resiliency-azure.md)
>[Weiter](monitoring-health.md)</span><span class="sxs-lookup"><span data-stu-id="33297-170">[Previous](infrastructure-resiliency-azure.md)
[Next](monitoring-health.md)</span></span>
